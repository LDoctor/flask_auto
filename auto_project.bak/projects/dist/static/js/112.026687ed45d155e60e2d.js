webpackJsonp([112],{"4eEI":function(t,a){},"XuX+":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o={components:{"pana-breadcrumb":e("1JPr").a},data:function(){return{acquisitionCycle:300,time:15e5,date:"",enddate:{disabledDate:function(t){return t.getTime()>Date.now()-864e5}},receiveData:"",sendData:"",totalQuota:"",storageQuota:""}},methods:{getStorageQuota:function(){var t=this;this.checkError(this.$http({url:this.api.storage.getPoolQuota,method:"get"}),function(a){t.totalQuota=a.data})},getsizeInfo:function(){var t=this;this.checkError(this.$http({url:this.api.storage.getStorageQuota,method:"get"}),function(a){t.storageQuota=a.data,t.initEcharts("filechart",t.storageQuota.file.allocated,t.storageQuota.file.unallocated,t.storageQuota.file.redundancy,t.storageQuota.file.total),t.initEcharts("objectchart",t.storageQuota.object.allocated,t.storageQuota.object.unallocated,t.storageQuota.object.redundancy,t.storageQuota.object.total),t.initEcharts("blockchart",t.storageQuota.block.allocated,t.storageQuota.block.unallocated,t.storageQuota.block.redundancy,t.storageQuota.block.total)})},setChartParam:function(){var t=Date.parse(new Date),a="",e={precision:this.acquisitionCycle};return""===this.time?(t=Date.parse(this.date[1])+864e5,a=Date.parse(this.date[0])):a=t-this.time,e.end_time=t,e.start_time=a,e.chart="",e},getReceiveRate:function(){var t=this,a=t.setChartParam();a.start_time=this.moment(this.moment(a.start_time-3e5).format("YYYY-MM-DD HH:mm:ss")).utc().format(),a.end_time=this.moment(this.moment(a.end_time).format("YYYY-MM-DD HH:mm:ss")).utc().format(),a.chart="receive",a=this.common.formatGetUrl(a),this.checkError(this.$http({url:this.api.storage.getStoragePoolrate+a,method:"get"}),function(a){t.receiveData=a.data.data,setTimeout(function(){t.siglelinechart({elementId:"inflow-rate",yAxisLabel:"B/s",data:t.receiveData})},0)})},getSendrate:function(){var t=this,a=t.setChartParam();a.start_time=this.moment(this.moment(a.start_time-3e5).format("YYYY-MM-DD HH:mm:ss")).utc().format(),a.end_time=this.moment(this.moment(a.end_time).format("YYYY-MM-DD HH:mm:ss")).utc().format(),a.chart="send",a=this.common.formatGetUrl(a),this.checkError(this.$http({url:this.api.storage.getStoragePoolrate+a,method:"get"}),function(a){t.sendData=a.data.data,setTimeout(function(){t.siglelinechart({elementId:"outflow-rate",yAxisLabel:"B/s",data:t.sendData})},0)})},siglelinechart:function(t){var a=this.$echarts.init(document.getElementById(t.elementId)),e="",o=[],i=[],s="",r=this;"inflow-rate"===t.elementId?(e="#3EC1A6",i=t.data.ceph_write):"outflow-rate"===t.elementId&&(e="#60ABFC",i=t.data.ceph_read),t.data.time.forEach(function(t){s=15e5===r.time?r.moment(t).tz("Asia/Shanghai").format("HH:mm"):r.moment(t).tz("Asia/Shanghai").format("MM-DD HH:mm"),o.push(s)});var l={tooltip:{trigger:"axis",formatter:function(t){var a=r.common.formatCapacity(t[0].value,"B");return t[0].axisValue+"<br>"+a.value+a.unit+"/s"}},grid:{left:"10%",top:"10%"},xAxis:{type:"category",boundaryGap:!1,data:o},yAxis:{type:"value",axisLabel:{formatter:function(t){if(0==t)return t="0B/s";if(t<1024)t+=" B/s";else{if(t>1024&&t<1048576)return t=Math.round(t/1024)+"KB/s";if(t>1048576&&t<1073741824)return t=Math.round(t/1048576)+"MB/s";if(t>1073741824&&t<1099511627776)return t=Math.round(t/1073741824)+"GB/s"}}}},series:[{data:i,type:"line",smooth:!0,symbol:"none",itemStyle:{normal:{lineStyle:{color:e}}},areaStyle:{normal:{color:new this.$echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:e},{offset:1,color:"#fff"}],!1),shadowColor:"rgba(0, 0, 0, 0.1)",shadowBlur:10}}}]};a.setOption(l)},initEcharts:function(t,a,e,o,i){var s=this.$echarts.init(document.getElementById(t)),r=this;s.clear();var l={color:["#30c9ae","#ced7e5","#60abfc"],tooltip:{trigger:"item",confine:!0,formatter:function(t){var a=r.common.formatCapacity(t.data.value,"B",2);return t.data.name+"<br>"+a.value+a.unit}},title:{text:this.lang.storageSurvey.totalQuota+"\n"+this.common.formatCapacity(i,"B",1).value+this.common.formatCapacity(i,"B",1).unit,left:"center",top:"40%",textStyle:{color:"#3c3c3c",align:"center",fontSize:"14"}},series:[{type:"pie",radius:["50%","65%"],avoidLabelOverlap:!1,label:{normal:{show:!1,position:"center"},emphasis:{show:!1,textStyle:{fontSize:"30",fontWeight:"bold"}}},labelLine:{normal:{show:!1}},data:[{value:a,name:this.lang.storageSurvey.allocated},{value:e,name:this.lang.storageSurvey.unallocated},{value:o,name:this.lang.storageSurvey.totalredundancy}]}]};s.setOption(l,!0)},lineChart:function(t){var a=this.$echarts.init(document.getElementById(t)),e={tooltip:{trigger:"axis"},color:["#60ABFC"],grid:{left:"6%",top:"10%"},xAxis:{type:"category",boundaryGap:!1,data:["10:00","10:05","10:10","10:15","10:20"]},yAxis:{type:"value"},series:[{data:[60,30,100,40,90],type:"line",smooth:!0,symbol:"none",areaStyle:{normal:{color:new this.$echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#60ABFC"},{offset:1,color:"#fff"}],!1),shadowColor:"rgba(0, 0, 0, 0.1)",shadowBlur:10}}}]};a.setOption(e)},onSubmit:function(){this.getReceiveRate(),this.getSendrate()},refresh:function(){this.getsizeInfo(),this.onSubmit()},init:function(){var t=this;["inflow-rate","outflow-rate","filechart","objectchart","blockchart"].forEach(function(a){t.$echarts.init(t.$refs[a]).resize()})}},mounted:function(){var t=this;this.getStorageQuota(),this.getsizeInfo(),this.onSubmit(),this.interval=setInterval(function(){t.refresh()},6e4),window.addEventListener("resize",this.init,20)},destroyed:function(){window.removeEventListener("resize",this.init,20),clearInterval(this.interval)}},i={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-container",{staticClass:"storagediv",attrs:{type:"flex",direction:"vertical"}},[e("pana-breadcrumb"),t._v(" "),e("el-main",{staticClass:"el-main"},[e("el-row",{staticClass:"spacedetail",attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("div",{staticClass:"distribution-details total-space"},[e("div",{staticClass:"echartstitle"},[e("span",[t._v(t._s(t.lang.storageSurvey.storageTotal))])]),t._v(" "),e("div",{staticClass:"left"},[e("div",{staticClass:"total-size"},[e("span",[t._v(t._s(this.common.formatCapacity(t.totalQuota.total_storage,"GB",2).value)+t._s(this.common.formatCapacity(t.totalQuota.total_storage,"GB",2).unit))]),t._v(" "),e("span",[t._v(t._s(t.lang.storageSurvey.totalQuota))])])]),t._v(" "),e("div",{staticClass:"right pie-legend"},[e("ul",[e("li",{staticClass:"li-horizontal"},[e("div",{staticStyle:{color:"#fff","font-weight":"400"}},[t._v(t._s(t.lang.storageSurvey.allocated)+t._s(this.common.formatCapacity(t.totalQuota.allocated_storage,"GB",2).value)+t._s(this.common.formatCapacity(t.totalQuota.allocated_storage,"GB",2).unit))])]),t._v(" "),e("li",{staticClass:"li-horizontal"},[e("div",{staticStyle:{color:"#fff","font-weight":"400"}},[t._v(t._s(t.lang.storageSurvey.unallocated)+t._s(this.common.formatCapacity(t.totalQuota.unallocated_storage,"GB",2).value)+t._s(this.common.formatCapacity(t.totalQuota.unallocated_storage,"GB",2).unit))])]),t._v(" "),e("li",{staticClass:"li-horizontal"},[e("div",{staticStyle:{color:"#fff","font-weight":"400"}},[t._v(t._s(t.lang.storageSurvey.useRate)+":"+t._s((t.totalQuota.allocated_storage/t.totalQuota.total_storage*100).toFixed(2))+"%")])])])])])]),t._v(" "),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"distribution-details"},[e("div",{staticClass:"echartstitle"},[e("span",[t._v(t._s(t.lang.storageSurvey.fileStorage))])]),t._v(" "),e("div",{staticClass:"left"},[e("div",{ref:"filechart",attrs:{id:"filechart"}})]),t._v(" "),e("div",{staticClass:"right pie-legend"},[t.storageQuota?e("ul",[e("li",{staticClass:"li-horizontal"},[e("div",[e("i"),t._v(t._s(t.lang.storageSurvey.allocated)),e("span",[t._v(t._s(this.common.formatCapacity(t.storageQuota.file.allocated,"B",2).value)+t._s(this.common.formatCapacity(t.storageQuota.file.allocated,"B",2).unit))])])]),t._v(" "),e("li",{staticClass:"li-horizontal"},[e("div",[e("i"),t._v(t._s(t.lang.storageSurvey.unallocated)),e("span",[t._v(t._s(this.common.formatCapacity(t.storageQuota.file.unallocated,"B",2).value)+t._s(this.common.formatCapacity(t.storageQuota.file.unallocated,"B",2).unit))])])]),t._v(" "),e("li",{staticClass:"li-horizontal"},[e("div",[e("i"),t._v(t._s(t.lang.storageSurvey.totalredundancy)),e("span",[t._v(t._s(this.common.formatCapacity(t.storageQuota.file.redundancy,"B",2).value)+t._s(this.common.formatCapacity(t.storageQuota.file.redundancy,"B",2).unit))])])])]):t._e()])])]),t._v(" "),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"distribution-details"},[e("div",{staticClass:"echartstitle"},[e("span",[t._v(t._s(t.lang.storageSurvey.objectStorage))])]),t._v(" "),e("div",{staticClass:"left"},[e("div",{ref:"objectchart",attrs:{id:"objectchart"}})]),t._v(" "),e("div",{staticClass:"right pie-legend"},[t.storageQuota?e("ul",[e("li",{staticClass:"li-horizontal"},[e("div",[e("i"),t._v(t._s(t.lang.storageSurvey.allocated)),e("span",[t._v(t._s(this.common.formatCapacity(t.storageQuota.object.allocated,"B",2).value)+t._s(this.common.formatCapacity(t.storageQuota.object.allocated,"B",2).unit))])])]),t._v(" "),e("li",{staticClass:"li-horizontal"},[e("div",[e("i"),t._v(t._s(t.lang.storageSurvey.unallocated)),e("span",[t._v(t._s(this.common.formatCapacity(t.storageQuota.object.unallocated,"B",2).value)+t._s(this.common.formatCapacity(t.storageQuota.object.unallocated,"B",2).unit))])])]),t._v(" "),e("li",{staticClass:"li-horizontal"},[e("div",[e("i"),t._v(t._s(t.lang.storageSurvey.totalredundancy)),e("span",[t._v(t._s(this.common.formatCapacity(t.storageQuota.object.redundancy,"B",2).value)+t._s(this.common.formatCapacity(t.storageQuota.object.redundancy,"B",2).unit))])])])]):t._e()])])]),t._v(" "),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"distribution-details"},[e("div",{staticClass:"echartstitle"},[e("span",[t._v(t._s(t.lang.storageSurvey.blockStorage))])]),t._v(" "),e("div",{staticClass:"left"},[e("div",{ref:"blockchart",attrs:{id:"blockchart"}})]),t._v(" "),e("div",{staticClass:"right pie-legend"},[t.storageQuota?e("ul",[e("li",{staticClass:"li-horizontal"},[e("div",[e("i"),t._v(t._s(t.lang.storageSurvey.allocated)),e("span",[t._v(t._s(this.common.formatCapacity(t.storageQuota.block.allocated,"B",2).value)+t._s(this.common.formatCapacity(t.storageQuota.block.allocated,"B",2).unit))])])]),t._v(" "),e("li",{staticClass:"li-horizontal"},[e("div",[e("i"),t._v(t._s(t.lang.storageSurvey.unallocated)),e("span",[t._v(t._s(this.common.formatCapacity(t.storageQuota.block.unallocated,"B",2).value)+t._s(this.common.formatCapacity(t.storageQuota.block.unallocated,"B",2).unit))])])]),t._v(" "),e("li",{staticClass:"li-horizontal"},[e("div",[e("i"),t._v(t._s(t.lang.storageSurvey.totalredundancy)),e("span",[t._v(t._s(this.common.formatCapacity(t.storageQuota.block.redundancy,"B",2).value)+t._s(this.common.formatCapacity(t.storageQuota.block.redundancy,"B",2).unit))])])])]):t._e()])])])],1),t._v(" "),e("el-row",{staticClass:"acquisition-cycle"},[e("el-col",{staticStyle:{"min-width":"268px"},attrs:{span:4}},[e("span",[t._v(t._s(t.lang.storageSurvey.acquisitionCycle)+":")]),t._v(" "),e("el-select",{attrs:{filterable:""},model:{value:t.acquisitionCycle,callback:function(a){t.acquisitionCycle=a},expression:"acquisitionCycle"}},t._l(t.lang.componentMonitor.acquisitionCycleOptions,function(t){return e("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})}),1)],1),t._v(" "),e("el-col",{staticClass:"timeselect",staticStyle:{"min-width":"812px"},attrs:{span:13}},[e("el-radio-group",{staticStyle:{"margin-top":"-4px"},on:{change:function(a){t.date=""}},model:{value:t.time,callback:function(a){t.time=a},expression:"time"}},t._l(t.lang.componentMonitor.timeOptions,function(a){return e("el-radio-button",{key:a.value,attrs:{label:a.value}},[t._v("\n\t\t\t\t\t\t"+t._s(a.text)+"\n\t\t\t\t\t")])}),1),t._v(" "),e("el-date-picker",{class:{active:!t.time&&t.date},attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.enddate},on:{input:function(a){t.time=""}},model:{value:t.date,callback:function(a){t.date=a},expression:"date"}}),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v(t._s(t.lang.storageSurvey.search))])],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"top5-div"},[e("div",{staticClass:"linechart-title"},[t._v(t._s(t.lang.storageSurvey.storagePoolInflow))]),t._v(" "),e("div",{ref:"inflow-rate",attrs:{id:"inflow-rate"}})])]),t._v(" "),e("el-col",{attrs:{span:12}},[e("div",{staticClass:"top5-div"},[e("div",{staticClass:"linechart-title"},[t._v(t._s(t.lang.storageSurvey.storagePoolOutflow))]),t._v(" "),e("div",{ref:"outflow-rate",attrs:{id:"outflow-rate"}})])])],1)],1)],1)},staticRenderFns:[]};var s=e("C7Lr")(o,i,!1,function(t){e("4eEI")},"data-v-0a937c27",null);a.default=s.exports}});