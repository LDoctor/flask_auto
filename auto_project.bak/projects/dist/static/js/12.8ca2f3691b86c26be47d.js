webpackJsonp([12],{"2P8r":function(e,t){},Xgsw:function(e,t){},ctwa:function(e,t){},nKIX:function(e,t){},ozqk:function(e,t,a){"use strict";var l=a("aA9S"),s=a.n(l),n={name:"pana-edit-router",props:{show:Boolean,network:Object,netIndex:String},methods:{closeModal:function(e){s()(this.$data,this.$options.data.call(this)),e=e||!1,this.$emit("closeModal",e)},initForm:function(){null!=this.$refs.form&&this.$refs.form.clearValidate(),this.form.name=this.network.name},editNetwork:function(){this.disable=!0;var e=this;this.$refs.form.validate(function(t){t?e.checkError(e.$http({url:e.common.formatMsg(e.api.cloud.put_networks_detail,{network_id:e.network.id}),method:"put",data:e.form}),function(){e.$notify({title:e.lang.common.success,type:"success",message:"pool"===e.netIndex?e.lang.pool.editPoolSuccess:e.lang.outside.editNetworkSuccess}),e.closeModal(!0)},function(){e.disable=!1}):e.disable=!1})}},computed:{titleFlag:function(){return"outside"==this.netIndex}},data:function(){return{labelWidth:"120px",form:{name:null},rules:{name:[{required:!0,message:this.lang.router.nameRequiredRule,trigger:"blur"},{min:1,max:32,message:this.lang.router.nameLengthRule,trigger:"blur"},{validator:this.common.validateNetworkName,message:this.lang.outside.nameFormatRule,trigger:"blur"}]},disable:!1}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.titleFlag?e.lang.outside.editOutNetwork:e.lang.pool.outsideEditNetwork,width:"45%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{ref:"form",attrs:{"label-position":"right",model:e.form,rules:e.rules}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.networkName,"label-width":e.labelWidth,prop:"name"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.outside.networkNamePlaceholder,required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.editNetwork}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var r=a("C7Lr")(n,o,!1,function(e){a("ctwa")},"data-v-0c1f03c5",null);t.a=r.exports},qb6d:function(e,t){},uy44:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("3cXf"),s=a.n(l),n=a("1JPr"),o=a("yRx0"),r={name:"pana-delete-group",props:{show:Boolean},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},deleteQos:function(){this.closeModal(!0)}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.common.info,visible:e.show,width:"30%",modal:!0},on:{close:e.closeModal}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:10}},[e._v(e._s(e.lang.outside.deleteExternalInfo))])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteQos}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]},c=a("C7Lr")(r,i,!1,null,null,null).exports,u=a("aA9S"),d=a.n(u),p=a("Cj+A"),m={components:{"pana-ip-input":p.a},props:{show:Boolean},methods:{closeModal:function(e){e=e||!1,d()(this.$data,this.$options.data.call(this)),this.$emit("closeModal",e)},initForm:function(){null!=this.$refs.form&&this.$refs.form.clearValidate(),this.getPhysicsNetwork()},validateMaskFn:function(){this.$refs.form.validateField("subnetMask")},validateIpFn:function(){this.$refs.form.validateField("subnetIp")},getPhysicsNetwork:function(){var e=this;this.loading=!0,e.checkError(this.$http({url:this.api.cloud.get_networks_availableExternalNetwork,method:"get"}),function(t){e.loading=!1,e.originPhysics=t.data,e.physics=e.originPhysics.filter(function(t){return t.networkType.toLowerCase()===e.currentNetworkType}),e.physics.length>0&&(e.physicNetwork=0,e.checkPhysicNetwork(),e.hasPhysics=!1)},function(){e.loading=!1})},newAddress:function(){this.form.subnet.allocation_pools.push({start:"",end:""})},deleteAddress:function(e){this.form.subnet.allocation_pools.splice(e,1)},validateGatewayIp:function(e,t,a){var l=this.common.getRangeInCidr(this.form.subnetIp+"/"+this.common.switchToNumberCount(this.form.subnetMask)).start;null==t||""===t?a():this.enableGateway&&this.form.subnet.gateway_ip==t?a(new Error(this.lang.outside.gatewayIpUsed)):l==t?a(new Error(this.lang.outside.gatewayIpUsed)):a()},validateGatewayIpArr:function(e,t,a){var l=this,s=this.form.subnet.allocation_pools;null==t||""===t?a():s.map(function(e,s){e.start&&e.end&&(l.common.getLargerIp(e.start,t)===t&&l.common.getLargerIp(t,e.end)===e.end?a(new Error(l.lang.outside.gatewayOccupancy)):a())})},createExternal:function(){var e=this;this.disable=!0,this.$refs.form.validate(function(t){t?(e.form.subnet.cidr=e.form.subnetIp+"/"+e.common.switchToNumberCount(e.form.subnetMask),""!==e.form.subnet.dnsNameservers&&null!=e.form.dnsNameservers&&(e.form.subnet.dns_nameservers=e.form.dnsNameservers.split(/\n/g)),""!==e.form.hostRoutes&&null!=e.form.hostRoutes&&(e.form.subnet.host_routes=e.formatRouters(e.form.hostRoutes)),e.form.subnet.allocation_pools=e.availableAddress?e.validateAllocation(e.form.subnet.allocation_pools):[],e.form=e.common.dropEmptyParameter(e.form),!1===e.enableGateway&&(e.form.subnet.gateway_ip=null),delete e.form.subnetIp,delete e.form.subnetMask,delete e.form.hostRoutes,delete e.form.dnsNameservers,e.checkError(e.$http({url:e.api.cloud.post_networks,method:"post",data:e.form}),function(){e.$notify({title:e.lang.common.success,type:"success",message:e.lang.outside.createExternalSuccess}),e.closeModal(!0)},function(){e.disable=!1})):e.disable=!1})},formatRouters:function(e){for(var t=e.split(/\n/g),a=[],l=0;l<t.length;l++){var s={},n=t[l].split(",");s.destination=n[0].replace(/(^\s*)|(\s*$)/g,""),s.nexthop=n[1].replace(/(^\s*)|(\s*$)/g,""),a.push(s)}return a},validateIpCross:function(e,t,a){var l=this,s=!0;this.form.subnet.allocation_pools.forEach(function(n,o){e.key!==o&&(n.start===t||n.end===t||l.common.getLargerIp(n.start,t)===t&&l.common.getLargerIp(n.end,t)===n.end)&&(a(Error(e.message)),s=!1)}),s&&a()},validateIpCIDRRange:function(e,t,a){var l=this.form.subnetIp+"/"+this.common.switchToNumberCount(this.form.subnetMask),s=this.common.getRangeInCidr(l),n=s.start.replace(/\./g,"")-1,o=s.end.replace(/\./g,"")-0+1;t!==s.start&&t!==s.end?t.replace(/\./g,"")==n?a(Error(this.lang.pool.noNetworkWrite)):t.replace(/\./g,"")==o?a(Error(this.lang.pool.noTelWrite)):this.common.getLargerIp(t,s.end)===t||this.common.getLargerIp(t,s.start)===s.start?a(Error(this.lang.pool.noCIDR)):a():a()},validateAllocation:function(e){for(var t=[],a=0;a<e.length;a++)null!=e[a].start&&null!=e[a].end&&t.push(e[a]);return t.length>0?t:null},checkPhysicNetwork:function(){var e=this.physics[this.physicNetwork];this.form.network.physical_network=e.networkName.split(":")[0];var t=e.networkName.split(":");this.min=t[1],this.max=t[2]},checkStep:function(e){var t=this;e>0?this.$refs.form.validate(function(a){a&&(t.stepIndex+=e)}):(t.stepIndex+=e,null!=this.$refs.form&&this.$refs.form.clearValidate())},validateIpEndRange:function(e,t,a){null!=e.start&&""!==e.start&&null!=t&&""!==t||a(),this.common.getLargerIp(e.start,t)===e.start?a(Error(e.message)):a()},validateNetmaskRange:function(e,t,a){var l=null==e.min?"255.128.0.0":e.min,s=null==e.max?"255.255.255.248":e.max;this.common.getLargerIp(l,t)===t&&this.common.getLargerIp(t,s)===s?a():a(new Error(e.message))},validateGatewayRange:function(e,t,a){null==t||""===t||this.common.getLargerIp(t,e.range.start)===t&&this.common.getLargerIp(t,e.range.end)===e.range.end?a():a(new Error(e.message))},setGatewayRange:function(){var e=/^(?=(\b|\D))(((\d{1,2})|(1\d{1,2})|(2[0-4]\d)|(25[0-5]))\.){3}((\d{1,2})|(1\d{1,2})|(2[0-4]\d)|(25[0-5]))(?=(\b|\D))$/;return e.test(this.form.subnetIp)&&e.test(this.form.subnetMask)?(this.enableIpRange=!0,this.common.getRangeInCidr(this.form.subnetIp+"/"+this.common.switchToNumberCount(this.form.subnetMask))):(this.enableIpRange=!1,this.availableAddress=!1,{start:null,end:null})},validateDuplicate:function(e,t,a){if(null==t||""===t)a();else{var l=t.split("\n");this.common.hasDuplicate(l)?"dns"===e.type?a(new Error(this.lang.pool.validateDnsDuplicateRule)):a(new Error(this.lang.pool.validateRoutesDuplicateRule)):"dns"===e.type?(e.message=this.lang.pool.dnsFormatRule,this.common.validateDnsServers(e,t,a)):(e.message=this.lang.pool.hostRoutesFormatRule,this.common.validateHostRoutes(e,t,a))}}},watch:{currentNetworkType:function(){var e=this;this.physicNetwork=null,this.physics=this.originPhysics.filter(function(t){return t.networkType.toLowerCase()===e.currentNetworkType})},"form.subnetIp":function(){this.gatewayRange=this.setGatewayRange(),this.$refs.form.validateField("subnet.gateway_ip")},"form.subnetMask":function(){this.gatewayRange=this.setGatewayRange(),this.$refs.form.validateField("subnet.gateway_ip")}},data:function(){return{labelWidth:"120px",loading:!1,form:{is_external:!0,network:{name:null,network_type:"vlan",physical_network:null,segmentation_id:null,shared:!1},subnet:{name:null,cidr:"",ip_version:4,gateway_ip:"",enable_dhcp:!0,dns_nameservers:[],host_routes:[],allocation_pools:[{start:null,end:null}]},subnetIp:"",subnetMask:"",dnsNameservers:"",hostRoutes:""},rules:{"network.name":[{required:!0,message:this.lang.outside.nameRequiredRule,trigger:"blur"},{min:1,max:32,message:this.lang.outside.nameLengthRule,trigger:"blur"},{validator:this.common.validateNetworkName,message:this.lang.outside.nameFormatRule,trigger:"blur"}],"network.network_type":[{required:!0,message:this.lang.outside.typeRequiredRule,trigger:"blur"}],"network.physical_network":[{required:!0,message:this.lang.outside.typeRequiredRule,trigger:"blur"}],"subnet.name":[{required:!0,message:this.lang.outside.nameRequiredRule,trigger:"blur"},{min:1,max:32,message:this.lang.outside.nameLengthRule,trigger:"blur"},{validator:this.common.validateNetworkName,message:this.lang.outside.nameFormatRule,trigger:"blur"}],subnetIp:[{required:!0,message:this.lang.outside.subnetRequiredRule,trigger:"blur"},{validator:this.common.validateIpAddress,message:this.lang.outside.ipFormatRule,trigger:"blur"}],subnetMask:[{required:!0,message:this.lang.outside.netmaskRequiredRule,trigger:"blur"},{validator:this.common.validateNetMask,message:this.lang.outside.netmaskFormatRule,trigger:"blur"},{validator:this.validateNetmaskRange,message:this.lang.outside.netmaskRangeRule,trigger:"blur"}],dnsNameservers:[{validator:this.validateDuplicate,type:"dns",trigger:"blur"}],hostRoutes:[{validator:this.validateDuplicate,type:"routes",trigger:"blur"}]},originPhysics:[],hasPhysics:!0,physicsNoData:"没有可选的物理网格",physics:[],physicNetwork:null,stepIndex:0,currentNetworkType:"vlan",disable:!1,networkType:[{name:this.lang.outside.vlan,value:"vlan"},{name:this.lang.outside.flat,value:"flat"}],langStepConfig:[this.lang.outside.stepNetwork,this.lang.outside.stepSubnet,this.lang.outside.stepSubnetDetail],subnetMask:"",availableAddress:!1,enableGateway:!0,gatewayRange:{start:null,end:null},enableIpRange:!1,min:0,max:255}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.outside.newOutNetwork,width:"40%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{"label-position":"right",model:e.form,rules:e.rules,"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)"}},[a("el-steps",{attrs:{active:e.stepIndex,"align-center":!0}},e._l(e.langStepConfig,function(t,l){return a("el-step",{key:l,attrs:{title:t},on:{click:function(t){return e.nextStep(l)}}})}),1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.stepIndex,expression:"stepIndex === 0"}],staticClass:"step-padding-top"},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.networkName,"label-width":e.labelWidth,prop:"network.name"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.outside.networkNamePlaceholder,required:""},model:{value:e.form.network.name,callback:function(t){e.$set(e.form.network,"name",t)},expression:"form.network.name"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.networkType,"label-width":e.labelWidth,prop:"network.network_type"}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.router.attachPlaceholder,width:"100%"},on:{change:function(t){e.currentNetworkType=e.form.network.network_type}},model:{value:e.form.network.network_type,callback:function(t){e.$set(e.form.network,"network_type",t)},expression:"form.network.network_type"}},e._l(e.networkType,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.physicalNetwork,"label-width":e.labelWidth,prop:"network.physical_network"}},[a("el-select",{attrs:{filterable:"",disabled:e.hasPhysics,placeholder:e.hasPhysics?e.physicsNoData:e.lang.router.attachPlaceholder,width:"100%"},on:{change:e.checkPhysicNetwork},model:{value:e.physicNetwork,callback:function(t){e.physicNetwork=t},expression:"physicNetwork"}},e._l(e.physics,function(e,t){return a("el-option",{key:t,attrs:{label:e.networkName,value:t}})}),1)],1)],1)],1),e._v(" "),"vlan"===e.currentNetworkType?a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.vlanId,"label-width":e.labelWidth,prop:"network.segmentation_id",rules:[{validator:this.common.validateNumberType,message:this.lang.outside.segmentationNumberRule,trigger:"blur"},{validator:this.common.validateNumberRange,min:this.min,max:this.max,message:this.common.formatMsg(this.lang.outside.vlanIdRangeRule,{min:this.min,max:this.max}),trigger:"blur"}]}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.pool.vlanIdPlaceholder},model:{value:e.form.network.segmentation_id,callback:function(t){e.$set(e.form.network,"segmentation_id",t)},expression:"form.network.segmentation_id"}})],1)],1)],1)],1):e._e(),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.share,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.form.network.shared,callback:function(t){e.$set(e.form.network,"shared",t)},expression:"form.network.shared"}})],1)],1)],1)],1)],1),e._v(" "),1===e.stepIndex?a("div",{staticClass:"step-padding-top"},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.subnetName,"label-width":e.labelWidth,prop:"subnet.name"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.outside.subnetPlaceholder,required:""},model:{value:e.form.subnet.name,callback:function(t){e.$set(e.form.subnet,"name",t)},expression:"form.subnet.name"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.subnet,"label-width":e.labelWidth,prop:"subnetIp"}},[a("el-col",{attrs:{span:16}},[a("pana-ip-input",{on:{blur:e.validateIpFn},model:{value:e.form.subnetIp,callback:function(t){e.$set(e.form,"subnetIp",t)},expression:"form.subnetIp"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.common.netmask,"label-width":e.labelWidth,prop:"subnetMask"}},[a("el-col",{attrs:{span:16}},[a("pana-ip-input",{on:{blur:e.validateMaskFn},model:{value:e.form.subnetMask,callback:function(t){e.$set(e.form,"subnetMask",t)},expression:"form.subnetMask"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.availableAddress,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{attrs:{disabled:!e.enableIpRange},model:{value:e.availableAddress,callback:function(t){e.availableAddress=t},expression:"availableAddress"}})],1)],1)],1)],1),e._v(" "),e.availableAddress?a("div",[e._l(e.form.subnet.allocation_pools,function(t,l){return a("el-row",{key:l,attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.start,"label-width":"50px",prop:"subnet.allocation_pools."+l+".start",rules:[{required:!0,message:e.lang.outside.startRequiredRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.outside.ipFormatRule,trigger:"blur"},{validator:e.validateIpCIDRRange,trigger:"blur"},{validator:e.validateGatewayIp,trigger:"blur"},{validator:e.validateIpCross,message:"不能与已有范围交叉",key:l,trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.end,"label-width":"50px",prop:"subnet.allocation_pools."+l+".end",rules:[{required:!0,message:e.lang.outside.endRequiredRule,trigger:"blur"},{validator:e.validateIpEndRange,start:t.start,message:e.lang.outside.endRangeRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.outside.ipFormatRule,trigger:"blur"},{validator:e.validateIpCIDRRange,trigger:"blur"},{validator:e.validateGatewayIp,trigger:"blur"},{validator:e.validateIpCross,message:"不能与已有范围交叉",key:l,trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range-button",attrs:{label:""}},[a("el-button",{attrs:{type:"danger",disabled:1===e.form.subnet.allocation_pools.length},on:{click:function(t){return e.deleteAddress(l)}}},[e._v("\n                                "+e._s(e.lang.common.delete)+"\n                            ")])],1)],1)],1)}),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.availableAddress,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"primary"},on:{click:e.newAddress}},[e._v("\n                                    "+e._s(e.lang.common.new)+"\n                                ")])],1)],1)],1)],1)],2):e._e(),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.enableGateway,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.enableGateway,callback:function(t){e.enableGateway=t},expression:"enableGateway"}})],1)],1)],1)],1),e._v(" "),e.enableGateway?a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.gatewayIp,"label-width":e.labelWidth,prop:"subnet.gateway_ip",rules:[{validator:this.common.validateIpAddress,message:this.lang.pool.ipFormatRule,trigger:"blur"},{validator:this.validateGatewayRange,range:this.gatewayRange,message:this.common.formatMsg(this.lang.pool.gatewayRangeRule,this.gatewayRange),trigger:"blur"},{validator:this.validateGatewayIpArr,trigger:"blur"}]}},[a("el-col",{attrs:{span:16}},[a("el-tooltip",{attrs:{effect:"dark",content:e.lang.outside.gatewayPlaceholder,placement:"top"}},[a("el-input",{attrs:{placeholder:e.lang.outside.gatewayPlaceholder},model:{value:e.form.subnet.gateway_ip,callback:function(t){e.$set(e.form.subnet,"gateway_ip",t)},expression:"form.subnet.gateway_ip"}})],1)],1)],1)],1)],1):e._e(),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.enableDhcp,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.form.subnet.enable_dhcp,callback:function(t){e.$set(e.form.subnet,"enable_dhcp",t)},expression:"form.subnet.enable_dhcp"}})],1)],1)],1)],1)],1):e._e(),e._v(" "),2===e.stepIndex?a("div",{staticClass:"step-padding-top"},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.dnsServer,"label-width":e.labelWidth,prop:"dnsNameservers"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:e.lang.outside.dnsServerPlaceholder},model:{value:e.form.dnsNameservers,callback:function(t){e.$set(e.form,"dnsNameservers",t)},expression:"form.dnsNameservers"}})],1)],1)],1)],1),e._v(" "),!0===e.form.subnet.enable_dhcp?a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.addRouter,"label-width":e.labelWidth,prop:"hostRoutes"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:e.lang.outside.addRouterPlaceholder},model:{value:e.form.hostRoutes,callback:function(t){e.$set(e.form,"hostRoutes",t)},expression:"form.hostRoutes"}})],1)],1)],1)],1):e._e()],1):e._e()],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),e.stepIndex>0?a("el-button",{on:{click:function(t){return e.checkStep(-1)}}},[e._v(e._s(e.lang.common.prevStep))]):e._e(),e._v(" "),e.stepIndex<2?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.checkStep(1)}}},[e._v(e._s(e.lang.common.nextStep))]):a("el-button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.createExternal}},[e._v(e._s(e.lang.common.complete))])],1)],1)},staticRenderFns:[]};var h=a("C7Lr")(m,g,!1,function(e){a("qb6d")},"data-v-62276369",null).exports,b=a("ozqk"),f={name:"pana-apply-public",components:{"pana-ip-input":p.a},props:{show:Boolean},filters:{ellipsis:function(e){return e?e.length>40?e.slice(0,40)+"...":e:""}},methods:{closeModal:function(e){e=e||!1,d()(this.$data,this.$options.data.call(this)),this.$emit("closeModal",e)},initForm:function(){null!=this.$refs.form&&this.$refs.form.clearValidate(),this.getExternal()},getExternal:function(){var e=this;e.loading=!0,this.checkError(this.$http({url:this.api.cloud.get_external_networks,method:"get"}),function(t){e.pubNets=t.data,e.pubNets.length>0&&(e.currentPub=0,e.changePubNet()),e.loading=!1},function(){e.loading=!1})},getUsedIp:function(){var e=this;this.checkError(this.$http({url:e.common.formatMsg(e.api.cloud.get_networks_detail_used_ips,{network_id:e.form.floating_network_id}),method:"get"}),function(t){var a=[];t.data.map(function(e){a=a.concat(e.ip)}),e.usedIp=a},function(){})},changePubNet:function(){var e=this.pubNets[this.currentPub];this.form.floating_network_id=e.id,this.outsideSubnets=e.subnets,this.getUsedIp(),this.outsideSubnets.length>0&&(this.currentOutSubnet=0,this.changeOutsideSubnet())},changeOutsideSubnet:function(){var e=this.outsideSubnets[this.currentOutSubnet];this.form.subnet_id=e.id;for(var t=e.name,a=e.allocation_pools,l=0;l<a.length;l++)a[l].name=t+" : "+a[l].start+" ~ "+a[l].end;this.subnetSegments=a,this.subnetSegments.length>0&&(this.outsideGateway=0,this.changeSegment())},changeSegment:function(){var e=this,t=this.subnetSegments[this.outsideGateway],a=t.start,l=t.end,s=a.split("."),n=l.split("."),o=[],r=!0;this.min=a,this.max=l,this.disabledArr=[],this.placeholderArr=[],s.map(function(t,a){t===n[a]&&!0===r?(o.push(t),e.disabledArr.push(a),e.placeholderArr.push(t)):(r=!1,t===n[a]?e.placeholderArr.push("0~255"):e.placeholderArr.push(t+"~"+n[a]))}),this.form.floating_ip_address=o.join(".")},applyPublicIp:function(){var e=this;this.disable=!0,this.$refs.form.validate(function(t){t?(e.appOutsideNet?e.showOutsideGateway?e.form.subnet_id=null:e.form.floating_ip_address=null:(e.form.floating_ip_address=null,e.form.subnet_id=null),e.form=e.common.dropEmptyParameter(e.form),e.checkError(e.$http({url:e.api.cloud.post_floatingips,method:"post",data:e.form}),function(){e.$notify({title:e.lang.common.success,type:"success",message:e.lang.outside.applyPublicIpSuccess}),e.closeModal(!0)},function(){e.disable=!1})):e.disable=!1})},validateIpRange:function(e,t,a){this.common.getLargerIp(this.min,t)===t&&this.common.getLargerIp(t,this.max)===this.max?a():a(Error(this.common.formatMsg(this.lang.outside.ipRangeRule,{min:this.min,max:this.max})))},validateIpUsed:function(e,t,a){this.usedIp.join(",").indexOf(t)>-1?a(Error(this.lang.outside.ipUsed)):a()}},data:function(){return{labelWidth:"120px",usedIp:[],form:{floating_network_id:null,subnet_id:null,floating_ip_address:""},rules:{floating_network_id:[{required:!0,message:this.lang.outside.extrenalRequireRule,trigger:"blur"}],subnet_id:[{required:!0,message:this.lang.outside.extrenalRequireRule,trigger:"blur"}],floating_ip_address:[{required:!0,message:this.lang.outside.extrenalRequireRule,trigger:"blur"},{validator:this.common.validateIpAddress,message:this.lang.outside.ipFormatRule,trigger:"change"},{validator:this.validateIpRange,trigger:"change"},{validator:this.validateIpUsed,trigger:"change"}]},pubNets:[],currentPub:null,subnets:[],appOutsideNet:!1,currentOutSubnet:null,outsideSubnets:[],showOutsideGateway:!1,subnetSegments:[],outsideGateway:null,disabledArr:[],placeholderArr:[],min:"",max:"",disable:!1,loading:!1}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.outside.applyPublicIp,width:"40%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{"label-position":"right",model:e.form,rules:e.rules,"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255,255,255)"}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.routerPubNet,"label-width":e.labelWidth,prop:"floating_network_id"}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.outside.attachPlaceholder,width:"100%"},on:{change:e.changePubNet},model:{value:e.currentPub,callback:function(t){e.currentPub=t},expression:"currentPub"}},e._l(e.pubNets,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:t}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.appointOutsideSubnet,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.appOutsideNet,callback:function(t){e.appOutsideNet=t},expression:"appOutsideNet"}})],1)],1)],1)],1),e._v(" "),e.appOutsideNet?a("div",[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.selectSubnet,"label-width":e.labelWidth,prop:"subnet_id"}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.outside.selectSubnetPlaceholder,width:"100%"},on:{change:e.changeOutsideSubnet},model:{value:e.currentOutSubnet,callback:function(t){e.currentOutSubnet=t},expression:"currentOutSubnet"}},e._l(e.outsideSubnets,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:t}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.appointOutsideGateIp,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.showOutsideGateway,callback:function(t){e.showOutsideGateway=t},expression:"showOutsideGateway"}})],1)],1)],1)],1),e._v(" "),e.showOutsideGateway?a("div",[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.subnetSegment,"label-width":e.labelWidth}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.outside.selectSegmentPlaceholder,width:"100%"},on:{change:e.changeSegment},model:{value:e.outsideGateway,callback:function(t){e.outsideGateway=t},expression:"outsideGateway"}},e._l(e.subnetSegments,function(t,l){return a("el-option",{key:l,attrs:{label:t.name,value:l}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:t.name.length<=40,content:t.name,placement:"top"}},[a("span",[e._v(e._s(e._f("ellipsis")(t.name)))])])],1)}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.routerGateWayIP,"label-width":e.labelWidth,prop:"floating_ip_address"}},[a("el-col",{attrs:{span:16}},[a("pana-ip-input",{attrs:{disable:e.disabledArr,placeholder:e.placeholderArr},model:{value:e.form.floating_ip_address,callback:function(t){e.$set(e.form,"floating_ip_address",t)},expression:"form.floating_ip_address"}})],1)],1)],1)],1)],1):e._e()],1):e._e()],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.applyPublicIp}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var _=a("C7Lr")(f,v,!1,function(e){a("nKIX")},"data-v-e4526b36",null).exports,w={name:"pana-deleteRouter",props:{show:Boolean},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},deletePublicIp:function(){this.closeModal(!0)}}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.common.info,visible:e.show,width:"30%",modal:!0},on:{close:e.closeModal}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:10}},[e._v(e._s(e.lang.outside.deletePublicIp))])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.deletePublicIp}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]},k=a("C7Lr")(w,y,!1,null,null,null).exports,x={name:"pana-deleteRouter",props:{show:Boolean},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},untiePublicIp:function(){this.closeModal(!0)}}},P={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.common.info,visible:e.show,width:"30%",modal:!0},on:{close:e.closeModal}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:10}},[e._v(e._s(e.lang.outside.untiePublicIp))])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.untiePublicIp}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]},I=a("C7Lr")(x,P,!1,null,null,null).exports,R={name:"pana-bond-public",props:{show:Boolean,publicId:String},methods:{closeModal:function(e){e=e||!1,d()(this.$data,this.$options.data.call(this)),this.$emit("closeModal",e)},initForm:function(){null!=this.$refs.form&&this.$refs.form.clearValidate(),this.getResourceList()},bondPublicIp:function(){var e=this;this.disable=!0,this.$refs.form.validate(function(t){t?(e.form=e.common.dropEmptyParameter(e.form),e.checkError(e.$http({url:e.common.formatMsg(e.api.cloud.post_floatingips_detail_association,{floatingip_id:e.publicId}),method:"post",data:e.form}),function(){e.$notify({title:e.lang.common.success,type:"success",message:e.lang.outside.bondPublicIpSuccess}),e.closeModal(!0)},function(){e.disable=!1})):e.disable=!1})},getResourceList:function(){var e=this,t={"neutron:LOADBALANCERV2":this.lang.outside.loadBalance,virtual_card:this.lang.outside.virtualCard};this.publicLoading=!0,this.checkError(this.$http({url:this.api.cloud.get_instanceips,method:"get"}),function(a){e.resourceList=a.data.map(function(e){""===e.device_owner&&(e.device_owner="virtual_card");var a=""===e.instance_name?null==t[e.device_owner]?"":t[e.device_owner]:e.instance_name;return e.name=a+" : "+e.ip,e}),e.resourceList.length>0&&(e.form.port_id=e.resourceList[0].id),e.publicLoading=!1})}},data:function(){return{labelWidth:"100px",form:{port_id:""},rules:{port_id:[{required:!0,message:this.lang.outside.portRequireRule,trigger:"blur"}]},resourceList:[],publicLoading:!1,disable:!1}}},S={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.outside.bondPublicIp,width:"25%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.publicLoading,expression:"publicLoading"}],ref:"form",attrs:{"label-position":"right",model:e.form,rules:e.rules,"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)"}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.outside.resource,"label-width":e.labelWidth,prop:"port_id"}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.outside.resourcePlaceholder,width:"100%"},model:{value:e.form.port_id,callback:function(t){e.$set(e.form,"port_id",t)},expression:"form.port_id"}},e._l(e.resourceList,function(t,l){return a("el-option",{key:l,attrs:{label:t.name,value:t.id}},[t.name.length>15?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.name,placement:"top-start"}},[a("span",[e._v(e._s(t.name.slice(0,15)+"..."))])]):a("span",[e._v(e._s(t.name))])],1)}),1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.bondPublicIp}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var N=a("C7Lr")(R,S,!1,function(e){a("vfpm")},"data-v-e7f715f4",null).exports,E={name:"cloudDisk",components:{"pana-breadcrumb":n.a,"cloud-info":o.a,"pana-delete-external":c,"pana-create-external":h,"pana-edit-external":b.a,"pana-apply-public":_,"pana-delete-public":k,"pana-untie-public":I,"pana-bond-public":N},watch:{externalSearch:function(){this.externalPage=1},publicSearch:function(){this.publicPage=1}},computed:{externalFilter:function(){var e=this;return this.externalOrigin.filter(function(t){return""===e.externalSearch||-1!==s()(t).search(e.externalSearch)}).sort(function(t,a){return t[e.sortProp]=null==t[e.sortProp]?"":t[e.sortProp],a[e.sortProp]=null==a[e.sortProp]?"":a[e.sortProp],t[e.sortProp]==a[e.sortProp]?a.created_at-t.created_at:(t[e.sortProp]>a[e.sortProp]?1:-1)*e.sortOrder})},externalTable:function(){return this.externalFilter.length>this.pageSize?this.externalFilter.slice((this.externalPage-1)*this.pageSize,this.externalPage*this.pageSize):this.externalFilter},publicFilter:function(){var e=this;return this.publicOrigin.filter(function(t){return""===e.publicSearch||-1!==s()(t).search(e.publicSearch)}).sort(function(t,a){return t[e.sortPropPublic]=null==t[e.sortPropPublic]?"":t[e.sortPropPublic],a[e.sortPropPublic]=null==a[e.sortPropPublic]?"":a[e.sortPropPublic],(t[e.sortPropPublic]>a[e.sortPropPublic]?1:-1)*e.sortOrderPublic})},publicTable:function(){return this.publicFilter.length>this.pageSize?this.publicFilter.slice((this.publicPage-1)*this.pageSize,this.publicPage*this.pageSize):this.publicFilter}},data:function(){return{sortOrder:0,sortProp:"",sortOrderPublic:0,sortPropPublic:"",activeName:"external",pageSize:10,externalOrigin:[],externalSearch:"",externalPage:1,externalSelectionIds:[],publicSelectionIds:[],publicOrigin:[],publicPage:1,publicSearch:"",createExternal:!1,showCreateExternal:!1,showDeleteExternal:!1,showEditExternal:!1,showApplyPublic:!1,showDeletePublic:!1,showUntiePublic:!1,showBondPublic:!1,config:{active:{style:"cloud-success",title:this.lang.common.running},down:{style:"cloud-warning",title:this.lang.common.stop},build:{style:"cloud-fault",title:this.lang.common.buildStatus},error:{style:"cloud-error",title:this.lang.common.errorStatus}},lastPublicObj:null,editObj:null,networkType:{flat:this.lang.outside.flat,vlan:this.lang.outside.vlan,xvlan:this.lang.outside.xvlan,gre:this.lang.outside.gre},externalLoading:!1,publicIpLoading:!1,isAdmin:!0}},methods:{handleEdit:function(e){this.editObj=e,this.showEditExternal=!0},sortChangeExternal:function(e){var t=null==e.order?0:"ascending"===e.order?1:-1;this.sortProp=e.prop,this.sortOrder=t,this.externalOrigin=this.externalOrigin.sort(function(a,l){switch(e.prop){case"available_ip":return a[e.prop]==l[e.prop]?l.created_at-a.created_at:(a[e.prop]-l[e.prop])*t;default:return a[e.prop]=null==a[e.prop]?"":a[e.prop],l[e.prop]=null==l[e.prop]?"":l[e.prop],a[e.prop]==l[e.prop]?l.created_at-a.created_at:(a[e.prop]>l[e.prop]?1:-1)*t}})},sortChangePublic:function(e){var t=null==e.order?0:"ascending"===e.order?1:-1;this.sortPropPublic=e.prop,this.sortOrderPublic=t,this.publicOrigin=this.publicOrigin.sort(function(a,l){return a[e.prop]=null==a[e.prop]?"":a[e.prop],l[e.prop]=null==l[e.prop]?"":l[e.prop],(a[e.prop]>l[e.prop]?1:-1)*t})},switchExternalPage:function(e){this.externalPage=e},switchPublicPage:function(e){this.publicPage=e},selectExternal:function(e){var t=[];e.forEach(function(e){t.push(e.id)}),this.externalSelectionIds=t},selectPublic:function(e){var t=[];this.lastPublicObj=e.length>0?e[e.length-1]:null,e.forEach(function(e){t.push(e.id)}),this.publicSelectionIds=t},initOutsideTab:function(){switch(this.activeName){case"external":this.getExternalData();break;case"public":this.getPublicIpList()}},getExternalData:function(){var e=this;e.externalLoading=!0,this.checkError(this.$http({url:this.api.cloud.get_external_networks+"?detail=true",method:"get"}),function(t){e.externalLoading=!1,e.externalOrigin=t.data},function(){e.externalLoading=!1})},getPublicIpList:function(){var e=this;e.publicIpLoading=!0,this.checkError(this.$http({url:this.api.cloud.get_floatingips,method:"get"}),function(t){e.publicIpLoading=!1,e.publicOrigin=t.data},function(){e.publicIpLoading=!1})},closeDeleteExternal:function(e){var t=this;if(this.showDeleteExternal=!1,!0===e){var a=this.api.cloud.post_networks_patch_delete;this.checkError(this.$http({url:a,method:"post",data:{network_ids:this.externalSelectionIds}}),function(){t.$notify({title:t.lang.common.success,type:"success",message:t.lang.outside.deleteExternalSuccess}),t.getExternalData(),t.externalSelectionIds=[]})}},closeCreateExternal:function(e){this.showCreateExternal=!1,!0===e&&this.getExternalData()},closeEditExternal:function(e){this.showEditExternal=!1,!0===e&&this.getExternalData()},closeApplyPublic:function(e){this.showApplyPublic=!1,!0===e&&this.getPublicIpList()},closeDeletePublic:function(e){var t=this;this.showDeletePublic=!1,!0===e&&this.checkError(this.$http({url:this.api.cloud.post_floatingips_patch_delete,method:"post",data:{floatingip_ids:this.publicSelectionIds}}),function(){t.publicSelectionIds=[],t.$notify({title:t.lang.common.success,type:"success",message:t.lang.outside.deletePublicIpSuccess}),t.getPublicIpList()})},closeUntiePublic:function(e){var t=this;this.showUntiePublic=!1,!0===e&&this.checkError(this.$http({url:this.common.formatMsg(this.api.cloud.post_floatingips_detail_dissociation,{floatingip_id:this.publicSelectionIds[0]}),method:"post"}),function(){t.externalSelectionIds=[],t.$notify({title:t.lang.common.success,type:"success",message:t.lang.outside.untiePublicIpSuccess}),t.getPublicIpList()})},closeBondPublic:function(e){this.showBondPublic=!1,!0===e&&this.getPublicIpList()}},mounted:function(){!1===this.common.is_system_admin()?(this.isAdmin=!1,this.activeName="public"):this.getExternalData()}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{type:"flex",direction:"vertical"}},[a("pana-breadcrumb",{attrs:{changePool:!0,callback:[e.getExternalData,e.getPublicIpList]}}),e._v(" "),a("el-main",[a("el-tabs",{staticClass:"pana_outside",on:{"tab-click":e.initOutsideTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[e.isAdmin?a("el-tab-pane",{attrs:{label:e.lang.outside.outsideNetwork,name:"external"}},[a("el-row",[a("cloud-info",{attrs:{content:e.lang.outside.outsideInfo}})],1),e._v(" "),a("el-row",{staticClass:"pana-btn-group",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showCreateExternal=!0}}},[e._v("\n                            "+e._s(e.lang.common.create)+"\n                        ")]),e._v(" "),a("el-button",{attrs:{disabled:0===e.externalSelectionIds.length},on:{click:function(t){e.showDeleteExternal=!0}}},[e._v("\n                            "+e._s(e.lang.common.delete)+"\n                        ")])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-row",{staticClass:"search-row",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:22}},[a("el-input",{attrs:{placeholder:e.lang.common.search,"suffix-icon":"el-icon-search"},model:{value:e.externalSearch,callback:function(t){e.externalSearch=t},expression:"externalSearch"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"fa fa-refresh",attrs:{type:"text",circle:""},on:{click:e.getExternalData}})],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.externalLoading,expression:"externalLoading"}],ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)",data:e.externalTable,"tooltip-effect":"dark"},on:{"selection-change":e.selectExternal,"sort-change":e.sortChangeExternal}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.outside.networkName,sortable:"custom",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.outside.bondSubnet},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.subnets,function(t,l){return a("div",{key:l},[e._v("\n                                "+e._s(t.name)+"\n                            ")])})}}],null,!1,2424430893)}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.common.status,sortable:"custom",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[null==e.config[t.row.status.toLowerCase()]?a("span",{class:["status",e.config[t.row.status.toLowerCase()].style]},[e._v("\n                                "+e._s(e.config.error.title)+"\n                            ")]):a("span",{class:["status",e.config[t.row.status.toLowerCase()].style]},[e._v("\n                                "+e._s(e.config[t.row.status.toLowerCase()].title)+"\n                            ")])]}}],null,!1,751693083)}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.outside.isShare,sortable:"custom",prop:"shared"},scopedSlots:e._u([{key:"default",fn:function(t){return[!0===e.common.forceBoolean(t.row.shared)?a("span",[e._v("\n                                "+e._s(e.lang.common.yes)+"\n                            ")]):a("span",[e._v("\n                                "+e._s(e.lang.common.no)+"\n                            ")])]}}],null,!1,3349504171)}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.outside.networkType,sortable:"custom",prop:"provider:network_type"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                            "+e._s(e.networkType[t.row["provider:network_type"]])),null!=t.row["provider:segmentation_id"]&&""!==t.row["provider:segmentation_id"]?a("span",[e._v(":"+e._s(t.row["provider:segmentation_id"]))]):e._e()]}}],null,!1,3967516395)}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.outside.ipCount,sortable:"custom",prop:"available_ip"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.outside.physicalNetwork,sortable:"custom",prop:"provider:physical_network"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.common.operation},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("\n                                "+e._s(e.lang.common.update)+"\n                            ")]),e._v(" "),a("router-link",{attrs:{to:"/cloudCenter/outside/detail/"+t.row.id+"/"}},[a("el-button",{attrs:{type:"text"}},[e._v("\n                                    "+e._s(e.lang.outside.checkMore)+"\n                                ")])],1)]}}],null,!1,1380460790)})],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"end"}},[e.externalFilter.length>e.pageSize?a("el-pagination",{attrs:{background:"",layout:"slot, prev, pager, next","prev-text":e.lang.common.prevPage,"next-text":e.lang.common.nextPage,total:e.externalFilter.length,"page-size":e.pageSize},on:{"current-change":e.switchExternalPage}},[e._t("default",[a("span",{staticClass:"pagination-slot"},[e._v("\n                                "+e._s(e.common.formatMsg(e.lang.common.paginationMsg,{current:this.externalPage,total:this.externalFilter.length}))+"\n                            ")])])],2):e._e()],1)],1):e._e(),e._v(" "),a("el-tab-pane",{attrs:{label:e.lang.outside.publicIp,name:"public"}},[a("el-row",[a("cloud-info",{attrs:{content:e.lang.outside.publicInfo}})],1),e._v(" "),a("el-row",{staticClass:"pana-btn-group",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showApplyPublic=!0}}},[e._v("\n                            "+e._s(e.lang.outside.applyPublicIp)+"\n                        ")]),e._v(" "),a("el-button",{attrs:{disabled:1!==e.publicSelectionIds.length||null!=e.lastPublicObj.fixed_ip_address&&""!==e.lastPublicObj.fixed_ip_address},on:{click:function(t){e.showBondPublic=!0}}},[e._v("\n                            "+e._s(e.lang.outside.bond)+"\n                        ")]),e._v(" "),a("el-button",{attrs:{disabled:1!==e.publicSelectionIds.length||null==e.lastPublicObj.fixed_ip_address||""===e.lastPublicObj.fixed_ip_address},on:{click:function(t){e.showUntiePublic=!0}}},[e._v("\n                            "+e._s(e.lang.outside.untie)+"\n                        ")]),e._v(" "),a("el-button",{attrs:{disabled:0===e.publicSelectionIds.length},on:{click:function(t){e.showDeletePublic=!0}}},[e._v("\n                            "+e._s(e.lang.common.delete)+"\n                        ")])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-row",{staticClass:"search-row",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:22}},[a("el-input",{attrs:{placeholder:e.lang.common.search,"suffix-icon":"el-icon-search"},model:{value:e.publicSearch,callback:function(t){e.publicSearch=t},expression:"publicSearch"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"fa fa-refresh",attrs:{type:"text",circle:""},on:{click:e.getPublicIpList}})],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.publicIpLoading,expression:"publicIpLoading"}],ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)",data:e.publicTable,"tooltip-effect":"dark"},on:{"selection-change":e.selectPublic,"sort-change":e.sortChangePublic}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.outside.ipAddress,sortable:"custom",prop:"floating_ip_address"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.outside.sourceName,sortable:"custom",prop:"instance_name"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.outside.privateIp,sortable:"custom",prop:"fixed_ip_address"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.common.status,sortable:"custom",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[null==e.config[t.row.status.toLowerCase()]?a("span",{class:["status",e.config[t.row.status.toLowerCase()].style]},[e._v("\n                                "+e._s(e.config.error.title)+"\n                            ")]):a("span",{class:["status",e.config[t.row.status.toLowerCase()].style]},[e._v("\n                                "+e._s(e.config[t.row.status.toLowerCase()].title)+"\n                            ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.outside.networkResourcePool,sortable:"custom",prop:"network_name"}})],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"end"}},[e.publicFilter.length>e.pageSize?a("el-pagination",{attrs:{background:"",layout:"slot, prev, pager, next","prev-text":e.lang.common.prevPage,"next-text":e.lang.common.nextPage,total:e.publicFilter.length,"page-size":e.pageSize},on:{"current-change":e.switchPublicPage}},[e._t("default",[a("span",{staticClass:"pagination-slot"},[e._v("\n                                "+e._s(e.common.formatMsg(e.lang.common.paginationMsg,{current:this.publicPage,total:this.publicFilter.length}))+"\n                            ")])])],2):e._e()],1)],1)],1),e._v(" "),a("pana-delete-external",{attrs:{show:e.showDeleteExternal},on:{closeModal:e.closeDeleteExternal}}),e._v(" "),a("pana-create-external",{attrs:{show:e.showCreateExternal},on:{closeModal:e.closeCreateExternal}}),e._v(" "),a("pana-edit-external",{attrs:{show:e.showEditExternal,network:e.editObj,netIndex:"outside"},on:{closeModal:e.closeEditExternal}}),e._v(" "),a("pana-apply-public",{attrs:{show:e.showApplyPublic},on:{closeModal:e.closeApplyPublic}}),e._v(" "),a("pana-delete-public",{attrs:{show:e.showDeletePublic},on:{closeModal:e.closeDeletePublic}}),e._v(" "),a("pana-untie-public",{attrs:{show:e.showUntiePublic},on:{closeModal:e.closeUntiePublic}}),e._v(" "),a("pana-bond-public",{attrs:{show:e.showBondPublic,publicId:e.publicSelectionIds[0]},on:{closeModal:e.closeBondPublic}})],1)],1)},staticRenderFns:[]};var C=a("C7Lr")(E,$,!1,function(e){a("2P8r"),a("Xgsw")},"data-v-f55de214",null);t.default=C.exports},vfpm:function(e,t){}});