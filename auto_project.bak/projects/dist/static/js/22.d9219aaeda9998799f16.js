webpackJsonp([22],{"+UFB":function(e,t){},"1yb3":function(e,t){},"5I2A":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("1JPr"),r=o("/n4h"),i=o("zAAO"),n=o("aA9S"),l=o.n(n),s={props:{show:Boolean},data:function(){return{form:{import:"",name:"",public_key:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{max:32,message:this.lang.common.validateLength32,trigger:"blur"},{validator:this.common.validateName4,trigger:"blur"}],public_key:[{required:!0,message:this.lang.resource.required_item,trigger:"blur"}]}}},methods:{confirm:function(){var e=!0;if(this.$refs.form.validate(function(t){t||(e=!1)}),!e)return!1;var t=this,o={keypair:this.form};t.closeModal(!1),this.checkError(this.$http({url:this.api.cloud.post_keypairs,method:"post",data:o}),function(e){t.$emit("getList"),t.$notify({title:t.lang.common.success,type:"success",message:t.lang.resource.importKeypairSuccess})})},closeModal:function(e){l()(this.$data,this.$options.data.call(this)),e=e||!1,this.$emit("closeModal",e)},initForm:function(){this.$refs.form&&this.$refs.form.resetFields()}}},c={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{id:"load",title:e.lang.resource.importKeypair,visible:e.show,modal:!0,top:"8vh",width:"35%"},on:{"update:visible":function(t){e.show=t},open:e.initForm,close:e.closeModal}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[o("el-form-item",{attrs:{label:e.lang.resource.keypairName,prop:"name"}},[o("el-input",{attrs:{placeholder:e.lang.common.namePlaceholder},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"==typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:e.lang.resource.publicKey,prop:"public_key"}},[o("el-input",{attrs:{type:"textarea",placeholder:e.lang.resource.publicKeyPlaceholder},model:{value:e.form.public_key,callback:function(t){e.$set(e.form,"public_key","string"==typeof t?t.trim():t)},expression:"form.public_key"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var p=o("C7Lr")(s,c,!1,function(e){o("+UFB")},"data-v-3865c698",null).exports,u={data:function(){return{sortOrder:0,sortProp:"",showCreate:!1,showImport:!1,loading:!0,dialogVisible:!1,tipDialogMsg:"",tableData:[],multipleSelection:[],search:"",pageNum:1,pageSize:10}},created:function(){this.getList()},components:{panaBreadcrumb:a.a,cloudTipDialog:r.a,create:i.a,importKeypair:p},methods:{sort:function(e){var t=null==e.order?0:"ascending"===e.order?1:-1;this.sortProp=e.prop,this.sortOrder=t,this.tableData=this.tableData.sort(function(o,a){return o[e.prop]=null==o[e.prop]?"":o[e.prop],a[e.prop]=null==a[e.prop]?"":a[e.prop],(o[e.prop]>a[e.prop]?1:-1)*t})},closeCreate:function(e){!0===e&&this.getList(),this.showCreate=!1},closeImport:function(e){!0===e&&this.getList(),this.showImport=!1},getList:function(){var e=this;e.loading=!0,this.checkError(this.$http({url:this.api.cloud.get_keypairs,method:"get"}),function(t){e.loading=!1,e.tableData=t.data},function(t){e.loading=!1})},pageSelect:function(e){this.pageNum=e},handleSelectionChange:function(e){this.multipleSelection=e},deleteConfirm:function(){this.dialogVisible=!0,this.tipDialogMsg=this.lang.resource.confirm_delete},dialogConfirm:function(){this.dialogVisible=!1;var e=this,t=[];this.multipleSelection.forEach(function(o){t.push(o.name),e.wsEventQueue.push(o.name)});var o=this.common.formatGetUrl({keypair_name:t});this.checkError(this.$http({url:this.api.cloud.get_keypairs+o,method:"delete"}),function(e){})}},mounted:function(){var e=this;this.$ws.setCallback(function(t){if(-1!==e.wsEventQueue.indexOf(t.resource_id)){var o=t.event_type.split(".");"keypair"===o[0]&&"end"===o[2]&&e.getList()}})},computed:{filterData:function(){var e=this,t=this.search,o=[];return o=""===t?this.tableData:this.common.cloudFilter(this.tableData,t),o.sort(function(t,o){return t[e.sortProp]=null==t[e.sortProp]?"":t[e.sortProp],o[e.sortProp]=null==o[e.sortProp]?"":o[e.sortProp],(t[e.sortProp]>o[e.sortProp]?1:-1)*e.sortOrder})},pagedData:function(){return this.filterData.length<=this.pageSize?this.filterData:this.common.pagination(this.filterData,this.pageSize,this.pageNum)}},watch:{search:function(){this.pageNum=1}}},m={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"mainDiv",attrs:{id:"rescyle"}},[o("pana-breadcrumb",{attrs:{changePool:!0,callback:e.getList}}),e._v(" "),o("el-main",[o("el-row",{staticClass:"cloud-btn-row",attrs:{type:"flex",justify:"space-between"}},[o("el-col",{attrs:{span:18}},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showCreate=!0}}},[e._v(e._s(e.lang.common.create))]),e._v(" "),o("el-button",{on:{click:function(t){e.showImport=!0}}},[e._v(e._s(e.lang.resource.import))]),e._v(" "),o("el-button",{attrs:{disabled:e.multipleSelection.length<=0},on:{click:e.deleteConfirm}},[e._v(e._s(e.lang.common.delete))])],1),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-row",{staticClass:"search-row",attrs:{type:"flex",justify:"space-around"}},[o("el-col",{attrs:{span:22}},[o("el-input",{attrs:{placeholder:e.lang.common.search,"suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),o("el-col",{attrs:{span:2}},[o("el-button",{staticClass:"fa fa-refresh",attrs:{type:"text",circle:""},on:{click:e.getList}})],1)],1)],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)",data:e.pagedData},on:{"sort-change":e.sort,"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"45"}}),e._v(" "),o("el-table-column",{attrs:{sortable:"custom",prop:"name",label:e.lang.resource.keypairName}}),e._v(" "),o("el-table-column",{attrs:{sortable:"custom",prop:"fingerprint",label:e.lang.resource.fingerprint}})],1),e._v(" "),o("el-row",{staticClass:"row-bg pana-pagination-row",attrs:{type:"flex",justify:"end"}},[e.filterData.length>e.pageSize?o("el-pagination",{attrs:{background:"",layout:"prev, pager, next","prev-text":e.lang.common.prevPage,"next-text":e.lang.common.nextPage,total:e.filterData.length,"current-page":e.pageNum},on:{"current-change":e.pageSelect}}):e._e()],1)],1),e._v(" "),o("create",{attrs:{show:e.showCreate},on:{getList:e.getList,closeModal:e.closeCreate}}),e._v(" "),o("import-keypair",{attrs:{show:e.showImport},on:{getList:e.getList,closeModal:e.closeImport}}),e._v(" "),o("cloud-tip-dialog",{attrs:{dialogVisible:e.dialogVisible},on:{cancel:function(t){e.dialogVisible=!1},confirm:e.dialogConfirm}},[e._v("\n        "+e._s(e.tipDialogMsg)+"\n    ")])],1)},staticRenderFns:[]};var d=o("C7Lr")(u,m,!1,function(e){o("1yb3"),o("9QwI")},"data-v-ad741e34",null);t.default=d.exports},"9QwI":function(e,t){},WIfE:function(e,t){},zAAO:function(e,t,o){"use strict";var a=o("aA9S"),r=o.n(a),i={props:{show:Boolean},data:function(){return{showDownload:!1,privateKey:"",form:{name:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{max:32,message:this.lang.common.validateLength32,trigger:"blur"},{validator:this.common.validateName4,trigger:"blur"}]}}},methods:{download:function(){var e=document.getElementById("download-keypair"),t=this.form.name+".pem",o=this.privateKey,a=new Blob([o],{type:"application/json;charset=UTF-8"});e.download=t,e.href=URL.createObjectURL(a),e.click(),URL.revokeObjectURL(a),this.showDownload=!1,r()(this.$data,this.$options.data.call(this))},confirm:function(){var e=this,t={keypair:{name:this.form.name}};this.$refs.form.validate(function(o){o&&(e.wsEventQueue.push(e.form.name),e.checkError(e.$http({url:e.api.cloud.post_keypairs,method:"post",data:t}),function(t){e.showDownload=!0,e.privateKey=t.data.private_key,e.closeModal(!0)}))})},closeModal:function(e){this.$emit("closeModal",e)},initForm:function(){this.$refs.form&&this.$refs.form.resetFields()}}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{attrs:{id:"load",title:e.lang.resource.createKeypair,visible:e.show,modal:!0,top:"8vh",width:"35%"},on:{"update:visible":function(t){e.show=t},open:e.initForm,close:e.closeModal}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[o("el-form-item",{attrs:{label:e.lang.resource.keypairName,prop:"name"}},[o("el-input",{attrs:{placeholder:e.lang.common.namePlaceholder},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"==typeof t?t.trim():t)},expression:"form.name"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.lang.common.confirm))])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:e.lang.resource.downloadKeypair,visible:e.showDownload,modal:!0,top:"8vh",width:"35%"},on:{"update:visible":function(t){e.showDownload=t}}},[o("p",{staticClass:"downloadTip"},[e._v(e._s(e.lang.resource.downloadKeypairConfirm))]),e._v(" "),o("a",{attrs:{id:"download-keypair",hidden:""}}),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.download()}}},[e._v(e._s(e.lang.resource.download))])],1)])],1)},staticRenderFns:[]};var l=o("C7Lr")(i,n,!1,function(e){o("WIfE")},"data-v-7baa6fba",null);t.a=l.exports}});