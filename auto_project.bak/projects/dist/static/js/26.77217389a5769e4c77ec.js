webpackJsonp([26],{FxZD:function(e,t){},Oi0q:function(e,t){},PQmD:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("3cXf"),l=a.n(s),r=a("1JPr"),o=a("aA9S"),n=a.n(o),i={name:"pana-create-file",props:{show:Boolean},watch:{"form.cifs":function(e){"yes"===e?this.services.push("cifs"):this.services.splice(this.services.indexOf("cifs"),1)},"form.nfs":function(e){"yes"===e?this.services.push("nfs"):this.services.splice(this.services.indexOf("nfs"),1)},services:function(e){0===e.length?(this.nextStep=0,this.completeIndex=0):e.indexOf("cifs")>-1?(this.nextStep=1,this.completeIndex=1,e.indexOf("nfs")>-1&&(this.completeIndex=2)):(this.nextStep=2,this.completeIndex=2)},users:function(e,t){var a=this;e=this.common.deepCopyByJson(e),t=(t=this.common.deepCopyByJson(t)).filter(function(t){return!(e.indexOf(t)>-1)||(e.splice(e.indexOf(t),1),!1)}),this.usersInfo=this.usersInfo.filter(function(e){return!(t.indexOf(e.name)>-1)||(a.form.read_user.splice(a.form.read_user.indexOf(e),1),a.form.write_user.splice(a.form.write_user.indexOf(e),1),a.form.admin_users.splice(a.form.admin_users.indexOf(e),1),!1)}),e.map(function(e){a.usersInfo.push({name:e,access:"ro",show:!1}),a.form.read_user.push(e)})},groups:function(e,t){var a=this;e=this.common.deepCopyByJson(e),t=(t=this.common.deepCopyByJson(t)).filter(function(t){return!(e.indexOf(t)>-1)||(e.splice(e.indexOf(t),1),!1)}),this.groupInfo=this.groupInfo.filter(function(e){return!(t.indexOf(e.name)>-1)||(a.form.read_group.splice(a.form.read_group.indexOf(e),1),a.form.write_group.splice(a.form.write_group.indexOf(e),1),a.form.admin_groups.splice(a.form.admin_groups.indexOf(e),1),!1)}),e.map(function(e){a.groupInfo.push({name:e,access:"ro",show:!1}),a.form.read_group.push(e)})}},methods:{closeModal:function(e){e=e||!1,n()(this.$data,this.$options.data.call(this)),this.$emit("closeModal",e)},initForm:function(){null!=this.$refs.file_form&&this.$refs.file_form.resetFields(),this.getVolumeList(),this.getSystemType()},getVolumeList:function(){var e=this;this.loading=!0,this.checkError(this.$http({url:this.api.dataset.dataset,method:"get"}),function(t){e.volumes=t.data,e.volumes.length>0&&(e.form.volume=e.volumes[0].path),e.loading=!1},function(){e.loading=!1})},validateIpAddressLen:function(e,t,a){var s=this,l=""===s.form[e.conmsg]||null==s.form[e.conmsg]?[]:s.form[e.conmsg].split("\n");e.items.map(function(e){null!=e.start&&null!=e.end&&s.common.arrayMerge(l,s.getIpInRange(e.start,e.end))}),l.length<=50?a():a(new Error(e.message))},createFileShare:function(){this.disable=!0;var e=this;this.$refs.file_form.validate(function(t){if(t){e.form.hosts_allow=""===e.form.hosts_allow||null==e.form.hosts_allow?[]:e.form.hosts_allow.split("\n"),e.form.hosts_deny=""===e.form.hosts_deny||null==e.form.hosts_deny?[]:e.form.hosts_deny.split("\n"),e.form.access_host=""===e.form.access_host||null==e.form.access_host?[]:e.form.access_host.split("\n"),e.form.write_host=""===e.form.write_host||null==e.form.write_host?[]:e.form.write_host.split("\n"),e.getAllRangeColumn(),delete e.form.allow_range,delete e.form.deny_range,delete e.form.nfs_allow_range,delete e.form.nfs_deny_range;var a=e.common.deepCopyByJson(e.common.dropEmptyParameter(e.form));e.form.hosts_allow="",e.form.hosts_deny="",e.form.access_host="",e.form.write_host="",e.checkError(e.$http({url:e.api.shares.shares,method:"post",data:a}),function(){e.$notify({title:e.lang.common.success,type:"success",message:e.lang.poolStorageFileShare.createFileShareSuccess}),e.closeModal(!0)},function(){e.closeModal(!1)})}else e.disable=!1})},checkStep:function(e){var t=this;!0===e?this.$refs.file_form.validate(function(e){e&&(t.stepIndex=t.nextStep,t.nextStep=t.completeIndex)}):(2===this.stepIndex?this.services.indexOf("cifs")>-1?this.stepIndex=1:this.stepIndex=0:this.stepIndex--,null!=this.$refs.file_form&&this.$refs.file_form.clearValidate()),2===this.stepIndex&&this.getSquashBase()},validateShareName:function(e,t,a){null==t||""===t||!0===/^[A-Za-z0-9][A-Za-z0-9_]*$/.test(t)?a():a(new Error(e.message))},validateIpEndRange:function(e,t,a){null!=e.start&&""!==e.start&&null!=t&&""!==t||a(),this.common.getLargerIp(e.start,t)===e.start?a(Error(e.message)):a()},newAddress:function(e){e.push({start:null,end:null})},deleteAddress:function(e,t){e.splice(t,1)},validateIpRange:function(){var e=["hosts_allow","hosts_deny","access_host","write_host"];!0===this.allowIpRange&&this.form.allow_range.map(function(t,a){e.push("allow_range."+a+".start"),e.push("allow_range."+a+".end")}),!0===this.denyIpRange&&this.form.deny_range.map(function(t,a){e.push("deny_range."+a+".start"),e.push("deny_range."+a+".end")}),!0===this.nfsAllowIpRange&&this.form.nfs_allow_range.map(function(t,a){e.push("nfs_allow_range."+a+".start"),e.push("nfs_allow_range."+a+".end")}),!0===this.nfsDenyIpRange&&this.form.nfs_deny_range.map(function(t,a){e.push("nfs_deny_range."+a+".start"),e.push("nfs_deny_range."+a+".end")});var t=!0;return this.$refs.file_form.validateField(e,function(e){t=null==e||""===e}),t},selectUser:function(){this.showSelectUser=!0,this.userOrigin=[],this.getUserList()},selectGroup:function(){this.showSelectGroup=!0,this.groupOrigin=[],this.getGroupList()},getUserList:function(e){var t=this,a=!0===e?"?t=nfs":"";this.checkError(this.$http({url:this.api.user.user+a,method:"get"}),function(e){t.userOrigin=e.data})},getGroupList:function(e){var t=this,a=!0===e?"?t=nfs":"";this.checkError(this.$http({url:this.api.group.group+a,method:"get"}),function(e){t.groupOrigin=e.data})},getSelectedUser:function(){this.users=this.preUsers,this.closeChildDialog()},getSelectedGroup:function(){this.groups=this.preGroups,this.closeChildDialog()},closeChildDialog:function(){this.preGroups=[],this.preUsers=[],this.showSelectUser=!1,this.showSelectGroup=!1},userAccessChange:function(e){var t=this.form.read_user.indexOf(e.name),a=this.form.write_user.indexOf(e.name),s=this.form.admin_users.indexOf(e.name);switch(e.access){case"ro":this.form.read_user.push(e.name),a>-1&&this.form.write_user.splice(a,1),s>-1&&this.form.admin_users.splice(s,1);break;case"rw":this.form.write_user.push(e.name),t>-1&&this.form.read_user.splice(t,1),s>-1&&this.form.admin_users.splice(s,1);break;case"super":this.form.admin_users.push(e.name),t>-1&&this.form.read_user.splice(t,1),a>-1&&this.form.write_user.splice(a,1)}e.show=!1},groupAccessChange:function(e){var t=this.form.read_group.indexOf(e.name),a=this.form.write_group.indexOf(e.name),s=this.form.admin_groups.indexOf(e.name);switch(e.access){case"ro":this.form.read_group.push(e.name),a>-1&&this.form.write_group.splice(a,1),s>-1&&this.form.admin_groups.splice(s,1);break;case"rw":this.form.write_group.push(e.name),t>-1&&this.form.read_group.splice(t,1),s>-1&&this.form.admin_groups.splice(s,1);break;case"super":this.form.admin_groups.push(e.name),t>-1&&this.form.read_group.splice(t,1),a>-1&&this.form.write_group.splice(a,1)}e.show=!1},getSquashBase:function(){this.getUserList(!0),this.getGroupList(!0)},getAllRangeColumn:function(){var e=this;this.form.allow_range.map(function(t){null!=t.start&&null!=t.end&&e.common.arrayMerge(e.form.hosts_allow,e.getIpInRange(t.start,t.end))}),this.form.deny_range.map(function(t){null!=t.start&&null!=t.end&&e.common.arrayMerge(e.form.hosts_deny,e.getIpInRange(t.start,t.end))}),this.form.nfs_allow_range.map(function(t){null!=t.start&&null!=t.end&&e.common.arrayMerge(e.form.access_host,e.getIpInRange(t.start,t.end))}),this.form.nfs_deny_range.map(function(t){null!=t.start&&null!=t.end&&e.common.arrayMerge(e.form.write_host,e.getIpInRange(t.start,t.end))})},getIpInRange:function(e,t){if(null==e||null==t||""===e||""===t)return[];for(var a=e,s=[];this.common.getLargerIp(a,t)===t&&(s.push(a),a!==t);){for(var l=a.split(".").reverse(),r=0;r<4&&-1!==r;){if(!(l[r]>=255)){l[r]++,r=-1;break}r++}a=l.reverse().join("."),s.push(a)}return s},getSystemType:function(){var e=this;this.checkError(this.$http({url:this.api.storage.get_type,method:"get"}),function(t){e.systemType=t.data})}},data:function(){return{labelWidth:"120px",form:{name:"",volume:"",cifs:"no",nfs:"no",browseable:"yes",read_only:"no",create_mask:"0744",directory_mask:"0755",hosts_allow:"",hosts_deny:"",guest_ok:"no",read_user:[],write_user:[],admin_users:[],read_group:[],write_group:[],admin_groups:[],sync:"no",access_host:"",write_host:"",no_root_squash:"no",squash_user:"",squash_group:"",allow_range:[{start:"",end:""}],deny_range:[{start:"",end:""}],nfs_allow_range:[{start:"",end:""}],nfs_deny_range:[{start:"",end:""}]},stepIndex:0,nextStep:0,completeIndex:0,accessControl:"allow",nfsAccessControl:"allow",allowIpRange:!1,denyIpRange:!1,nfsAllowIpRange:!1,nfsDenyIpRange:!1,rules:{name:[{required:!0,message:this.lang.poolStorageFileShare.nameRequiredRule,trigger:"blur"},{min:1,max:32,message:this.lang.poolStorageFileShare.nameLengthRule,trigger:"blur"},{validator:this.validateShareName,message:this.lang.poolStorageFileShare.nameFormatRule,trigger:"blur"}],volume:[{required:!0,message:this.lang.poolStorageFileShare.volumeRequiredRule,trigger:"blur"}],create_mask:[{required:!0,message:this.lang.poolStorageFileShare.createMaskRequiredRule,trigger:"blur"},{validator:this.validateLinuxMask,message:this.lang.poolStorageFileShare.createMaskFormatRule,trigger:"blur"}],directory_mask:[{required:!0,message:this.lang.poolStorageFileShare.directoryMaskRequiredRule,trigger:"blur"},{validator:this.validateLinuxMask,message:this.lang.poolStorageFileShare.directoryMaskFormatRule,trigger:"blur"}],hosts_allow:[{validator:this.common.validateDnsServers,message:this.lang.poolStorageFileShare.hostsFormatRule,trigger:"blur"},{validator:this.common.validateDnsServersLen,message:"ip名单不能超过50条",trigger:"blur"}],hosts_deny:[{validator:this.common.validateDnsServers,message:this.lang.poolStorageFileShare.hostsFormatRule,trigger:"blur"},{validator:this.common.validateDnsServersLen,message:"ip名单不能超过50条",trigger:"blur"}],access_host:[{validator:this.common.validateDnsServers,message:this.lang.poolStorageFileShare.hostsFormatRule,trigger:"blur"},{validator:this.common.validateDnsServersLen,message:"ip名单不能超过50条",trigger:"blur"}],write_host:[{validator:this.common.validateDnsServers,message:this.lang.poolStorageFileShare.hostsFormatRule,trigger:"blur"},{validator:this.common.validateDnsServersLen,message:"ip名单不能超过50条",trigger:"blur"}]},langStepConfig:[this.lang.poolStorageFileShare.baseSeting,this.lang.poolStorageFileShare.cifs,this.lang.poolStorageFileShare.nfs],volumes:[],services:[],users:[],groups:[],preUsers:[],preGroups:[],userOrigin:[],groupOrigin:[],usersInfo:[],groupInfo:[],cifs:!1,nfs:!1,accessConf:{ro:this.lang.poolStorageFileShare.roAccess,rw:this.lang.poolStorageFileShare.rwAccess,super:this.lang.poolStorageFileShare.superAccess},showSelectUser:!1,showSelectGroup:!1,disable:!1,loading:!1,systemType:""}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.poolStorageFileShare.createShare,width:"40%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"file_form",attrs:{"label-position":"right",model:e.form,rules:e.rules,"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)"}},[a("el-steps",{attrs:{active:e.stepIndex,"align-center":!0,"process-status":"finish","finish-status":"success"}},e._l(e.langStepConfig,function(e,t){return a("el-step",{key:t,attrs:{title:e,icon:"fa fa-circle"}})}),1),e._v(" "),0===e.stepIndex?a("div",{staticClass:"step-padding-top"},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.shareName,"label-width":e.labelWidth,prop:"name"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.poolStorageFileShare.shareNamePlaceholder},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.volumeName,"label-width":e.labelWidth,prop:"volume"}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.poolStorageFileShare.volumeNamePlaceholder,width:"100%"},model:{value:e.form.volume,callback:function(t){e.$set(e.form,"volume",t)},expression:"form.volume"}},e._l(e.volumes,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.path}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.pool.share,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{attrs:{label:e.lang.poolStorageFileShare.cifs,"true-label":"yes","false-label":"no"},model:{value:e.form.cifs,callback:function(t){e.$set(e.form,"cifs",t)},expression:"form.cifs"}}),e._v(" "),a("el-checkbox",{attrs:{label:e.lang.poolStorageFileShare.nfs,"true-label":"yes","false-label":"no"},model:{value:e.form.nfs,callback:function(t){e.$set(e.form,"nfs",t)},expression:"form.nfs"}})],1)],1)],1)],1)],1):e._e(),e._v(" "),1===e.stepIndex?a("div",{staticClass:"step-padding-top"},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{attrs:{label:e.lang.poolStorageFileShare.browseable,"true-label":"yes","false-label":"no"},model:{value:e.form.browseable,callback:function(t){e.$set(e.form,"browseable",t)},expression:"form.browseable"}}),e._v(" "),a("el-checkbox",{attrs:{label:e.lang.poolStorageFileShare.readonly,"true-label":"yes","false-label":"no"},model:{value:e.form.read_only,callback:function(t){e.$set(e.form,"read_only",t)},expression:"form.read_only"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.createMask,"label-width":e.labelWidth,prop:"create_mask"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.poolStorageFileShare.createMaskPlaceholder},model:{value:e.form.create_mask,callback:function(t){e.$set(e.form,"create_mask",t)},expression:"form.create_mask"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.directoryMask,"label-width":e.labelWidth,prop:"directory_mask"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.poolStorageFileShare.directoryMaskPlaceholder},model:{value:e.form.directory_mask,callback:function(t){e.$set(e.form,"directory_mask",t)},expression:"form.directory_mask"}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"hr-row",attrs:{type:"flex",justify:"space-between"}},[a("span",{staticStyle:{display:"inline-block","margin-left":"20px"}},[e._v(e._s(e.lang.poolStorageFileShare.ipAccessControl))]),e._v(" "),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.lang.poolStorageFileShare.accessIpInfo)},slot:"content"}),e._v(" "),a("i",{staticClass:"fa fa-question-circle"})])],1),e._v(" "),a("el-tabs",{attrs:{"tab-position":"left","before-leave":e.validateIpRange},model:{value:e.accessControl,callback:function(t){e.accessControl=t},expression:"accessControl"}},[a("el-tab-pane",{attrs:{label:e.lang.poolStorageFileShare.allowAccessIp,name:"allow"}},[a("el-row",{staticClass:"ip-textarea",attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipAddress,"label-width":e.labelWidth,prop:"hosts_allow"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:e.lang.poolStorageFileShare.hostsPlaceholder},model:{value:e.form.hosts_allow,callback:function(t){e.$set(e.form,"hosts_allow",t)},expression:"form.hosts_allow"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.useRangeSeting,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.allowIpRange,callback:function(t){e.allowIpRange=t},expression:"allowIpRange"}})],1)],1)],1)],1),e._v(" "),!0===e.allowIpRange?a("div",[a("el-row",{attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipRange,"label-width":e.labelWidth}},[e._l(e.form.allow_range,function(t,s){return a("el-row",{key:s,staticClass:"ip-range",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.start,"label-width":"50px",prop:"allow_range."+s+".start",rules:[{required:!0,message:e.lang.poolStorageFileShare.startRequiredRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.poolStorageFileShare.ipFormatRule,trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.end,"label-width":"50px",prop:"allow_range."+s+".end",rules:[{required:!0,message:e.lang.pool.endRequiredRule,trigger:"blur"},{validator:e.validateIpEndRange,start:t.start,message:e.lang.poolStorageFileShare.endRangeRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.pool.ipFormatRule,trigger:"blur"},{validator:e.validateIpAddressLen,message:"ip名单不能超过50条",items:e.form.allow_range,conmsg:"hosts_allow",trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range-button",attrs:{label:""}},[1!==e.form.allow_range.length?a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteAddress(e.form.allow_range,s)}}},[e._v("\n                                                    "+e._s(e.lang.common.delete)+"\n                                                ")]):e._e()],1)],1)],1)}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.newAddress(e.form.allow_range)}}},[e._v("\n                                        "+e._s(e.lang.common.create)+"\n                                    ")])],2)],1)],1)],1):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{label:e.lang.poolStorageFileShare.denyAccessIp,name:"deny"}},[a("el-row",{staticClass:"ip-textarea",attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipAddress,"label-width":e.labelWidth,prop:"hosts_deny"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:e.lang.poolStorageFileShare.hostsPlaceholder},model:{value:e.form.hosts_deny,callback:function(t){e.$set(e.form,"hosts_deny",t)},expression:"form.hosts_deny"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.useRangeSeting,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.denyIpRange,callback:function(t){e.denyIpRange=t},expression:"denyIpRange"}})],1)],1)],1)],1),e._v(" "),!0===e.denyIpRange?a("div",[a("el-row",{attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipRange,"label-width":e.labelWidth}},[e._l(e.form.deny_range,function(t,s){return a("el-row",{key:s,staticClass:"ip-range",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.start,"label-width":"50px",prop:"deny_range."+s+".start",rules:[{required:!0,message:e.lang.poolStorageFileShare.startRequiredRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.poolStorageFileShare.ipFormatRule,trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.end,"label-width":"50px",prop:"deny_range."+s+".end",rules:[{required:!0,message:e.lang.pool.endRequiredRule,trigger:"blur"},{validator:e.validateIpEndRange,start:t.start,message:e.lang.poolStorageFileShare.endRangeRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.pool.ipFormatRule,trigger:"blur"},{validator:e.validateIpAddressLen,message:"ip名单不能超过50条",items:e.form.deny_range,conmsg:"hosts_deny",trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range-button",attrs:{label:""}},[1!==e.form.deny_range.length?a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteAddress(e.form.deny_range,s)}}},[e._v("\n                                                    "+e._s(e.lang.common.delete)+"\n                                                ")]):e._e()],1)],1)],1)}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.newAddress(e.form.deny_range)}}},[e._v("\n                                        "+e._s(e.lang.common.create)+"\n                                    ")])],2)],1)],1)],1):e._e()],1)],1),e._v(" "),a("el-row",{staticClass:"hr-row",attrs:{type:"flex",justify:"start"}},[a("span",{staticStyle:{display:"inline-block","margin-left":"20px"}},[e._v(e._s(e.lang.poolStorageFileShare.userGroupAccessControl))])]),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.anonymousAccess,"label-width":e.labelWidth}},[a("el-radio-group",{model:{value:e.form.guest_ok,callback:function(t){e.$set(e.form,"guest_ok",t)},expression:"form.guest_ok"}},[a("el-radio",{attrs:{label:"yes"}},[e._v(e._s(e.lang.common.yes))]),e._v(" "),a("el-radio",{attrs:{label:"no"}},[e._v(e._s(e.lang.common.no))])],1)],1)],1)],1),e._v(" "),"no"===e.form.guest_ok?a("div",[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("span",[e._v(e._s(e.lang.poolStorageFileShare.userAccess))]),e._v(" "),a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:e.selectUser}},[e._v(e._s(e.lang.common.update))])],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-table",{ref:"singleTable",staticClass:"cloud-table modal-table",staticStyle:{width:"100%"},attrs:{data:e.usersInfo,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.username,sortable:"",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.access,sortable:"",prop:"access",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:function(e){t.row.show=!t.row.show}}},[e._v("\n                                            "+e._s(e.accessConf[t.row.access])+"\n                                            "),!1===t.row.show?a("i",{staticClass:"fa fa-lock",staticStyle:{"margin-left":"10px"}}):a("i",{staticClass:"fa fa-unlock",staticStyle:{"margin-left":"10px"}})])]}}],null,!1,27438355)}),e._v(" "),a("el-table-column",{attrs:{width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio-group",{directives:[{name:"show",rawName:"v-show",value:t.row.show,expression:"scope.row.show"}],on:{change:function(a){return e.userAccessChange(t.row)}},model:{value:t.row.access,callback:function(a){e.$set(t.row,"access",a)},expression:"scope.row.access"}},[a("el-radio",{attrs:{label:"ro"}},[e._v(e._s(e.lang.poolStorageFileShare.roAccess))]),e._v(" "),a("el-radio",{attrs:{label:"rw"}},[e._v(e._s(e.lang.poolStorageFileShare.rwAccess))]),e._v(" "),a("el-radio",{attrs:{label:"super"}},[e._v(e._s(e.lang.poolStorageFileShare.superAccess))])],1)]}}],null,!1,3710881091)})],1)],1),e._v(" "),a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"space-between"}},[a("span",[e._v(e._s(e.lang.poolStorageFileShare.groupAccess))]),e._v(" "),a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:e.selectGroup}},[e._v(e._s(e.lang.common.update))])],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-table",{ref:"singleTable",staticClass:"cloud-table modal-table",staticStyle:{width:"100%"},attrs:{data:e.groupInfo,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.groupName,sortable:"",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.access,sortable:"",prop:"access",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:function(e){t.row.show=!t.row.show}}},[e._v("\n                                            "+e._s(e.accessConf[t.row.access])+"\n                                            "),!1===t.row.show?a("i",{staticClass:"fa fa-lock",staticStyle:{"margin-left":"10px"}}):a("i",{staticClass:"fa fa-unlock",staticStyle:{"margin-left":"10px"}})])]}}],null,!1,27438355)}),e._v(" "),a("el-table-column",{attrs:{width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio-group",{directives:[{name:"show",rawName:"v-show",value:t.row.show,expression:"scope.row.show"}],on:{change:function(a){return e.groupAccessChange(t.row)}},model:{value:t.row.access,callback:function(a){e.$set(t.row,"access",a)},expression:"scope.row.access"}},[a("el-radio",{attrs:{label:"ro"}},[e._v(e._s(e.lang.poolStorageFileShare.roAccess))]),e._v(" "),a("el-radio",{attrs:{label:"rw"}},[e._v(e._s(e.lang.poolStorageFileShare.rwAccess))]),e._v(" "),a("el-radio",{attrs:{label:"super"}},[e._v(e._s(e.lang.poolStorageFileShare.superAccess))])],1)]}}],null,!1,727300877)})],1)],1)],1)],1)],1):e._e()],1):e._e(),e._v(" "),2===e.stepIndex?a("div",{staticClass:"step-padding-top"},["FreeBSD"!==e.systemType?a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.dataSync,"label-width":e.labelWidth}},[a("el-radio-group",{model:{value:e.form.sync,callback:function(t){e.$set(e.form,"sync",t)},expression:"form.sync"}},[a("el-radio",{attrs:{label:"yes"}},[e._v(e._s(e.lang.common.yes))]),e._v(" "),a("el-radio",{attrs:{label:"no"}},[e._v(e._s(e.lang.common.no))])],1)],1)],1)],1):e._e(),e._v(" "),a("el-row",{staticClass:"hr-row",attrs:{type:"flex",justify:"space-between"}},[a("span",{staticStyle:{display:"inline-block","margin-left":"20px"}},[e._v(e._s(e.lang.poolStorageFileShare.ipAccessControl))]),e._v(" "),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.lang.poolStorageFileShare.accessIpInfo)},slot:"content"}),e._v(" "),a("i",{staticClass:"fa fa-question-circle"})])],1),e._v(" "),a("el-tabs",{attrs:{"tab-position":"left","before-leave":e.validateIpRange},model:{value:e.nfsAccessControl,callback:function(t){e.nfsAccessControl=t},expression:"nfsAccessControl"}},[a("el-tab-pane",{attrs:{label:e.lang.poolStorageFileShare.allowAccessIp,name:"allow"}},[a("el-row",{staticClass:"ip-textarea",attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipAddress,"label-width":e.labelWidth,prop:"access_host"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:e.lang.poolStorageFileShare.hostsPlaceholder},model:{value:e.form.access_host,callback:function(t){e.$set(e.form,"access_host",t)},expression:"form.access_host"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.useRangeSeting,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.nfsAllowIpRange,callback:function(t){e.nfsAllowIpRange=t},expression:"nfsAllowIpRange"}})],1)],1)],1)],1),e._v(" "),!0===e.nfsAllowIpRange?a("div",[a("el-row",{attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipRange,"label-width":e.labelWidth}},[e._l(e.form.nfs_allow_range,function(t,s){return a("el-row",{key:s,staticClass:"ip-range",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.start,"label-width":"50px",prop:"nfs_allow_range."+s+".start",rules:[{required:!0,message:e.lang.poolStorageFileShare.startRequiredRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.poolStorageFileShare.ipFormatRule,trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.end,"label-width":"50px",prop:"nfs_allow_range."+s+".end",rules:[{required:!0,message:e.lang.pool.endRequiredRule,trigger:"blur"},{validator:e.validateIpEndRange,start:t.start,message:e.lang.poolStorageFileShare.endRangeRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.pool.ipFormatRule,trigger:"blur"},{validator:e.validateIpAddressLen,message:"ip名单不能超过50条",items:e.form.nfs_allow_range,conmsg:"access_host",trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range-button",attrs:{label:""}},[1!==e.form.nfs_allow_range.length?a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteAddress(e.form.nfs_allow_range,s)}}},[e._v("\n                                                    "+e._s(e.lang.common.delete)+"\n                                                ")]):e._e()],1)],1)],1)}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.newAddress(e.form.nfs_allow_range)}}},[e._v("\n                                        "+e._s(e.lang.common.create)+"\n                                    ")])],2)],1)],1)],1):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{label:e.lang.poolStorageFileShare.denyAccessIp,name:"deny"}},[a("el-row",{staticClass:"ip-textarea",attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipAddress,"label-width":e.labelWidth,prop:"write_host"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:e.lang.poolStorageFileShare.hostsPlaceholder},model:{value:e.form.write_host,callback:function(t){e.$set(e.form,"write_host",t)},expression:"form.write_host"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.useRangeSeting,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.nfsDenyIpRange,callback:function(t){e.nfsDenyIpRange=t},expression:"nfsDenyIpRange"}})],1)],1)],1)],1),e._v(" "),!0===e.nfsDenyIpRange?a("div",[a("el-row",{attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipRange,"label-width":e.labelWidth}},e._l(e.form.nfs_deny_range,function(t,s){return a("el-row",{key:s,staticClass:"ip-range",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.start,"label-width":"50px",prop:"nfs_deny_range."+s+".start",rules:[{required:!0,message:e.lang.poolStorageFileShare.startRequiredRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.poolStorageFileShare.ipFormatRule,trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.end,"label-width":"50px",prop:"nfs_deny_range."+s+".end",rules:[{required:!0,message:e.lang.pool.endRequiredRule,trigger:"blur"},{validator:e.validateIpEndRange,start:t.start,message:e.lang.poolStorageFileShare.endRangeRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.pool.ipFormatRule,trigger:"blur"},{validator:e.validateIpAddressLen,message:"ip名单不能超过50条",items:e.form.nfs_deny_range,conmsg:"write_host",trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range-button",attrs:{label:""}},[1!==e.form.nfs_deny_range.length?a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteAddress(e.form.nfs_deny_range,s)}}},[e._v("\n                                                    "+e._s(e.lang.common.delete)+"\n                                                ")]):e._e()],1)],1)],1)}),1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.newAddress(e.form.nfs_deny_range)}}},[e._v("\n                                    "+e._s(e.lang.common.create)+"\n                                ")])],1)],1)],1):e._e()],1)],1),e._v(" "),a("el-row",{staticClass:"hr-row",attrs:{type:"flex",justify:"start"}},[a("span",{staticStyle:{display:"inline-block","margin-left":"20px"}},[e._v(e._s(e.lang.poolStorageFileShare.userGroupAccessControl))])]),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.denySquashUser,"label-width":e.labelWidth}},[a("el-radio-group",{model:{value:e.form.no_root_squash,callback:function(t){e.$set(e.form,"no_root_squash",t)},expression:"form.no_root_squash"}},[a("el-radio",{attrs:{label:"yes"}},[e._v(e._s(e.lang.common.yes))]),e._v(" "),a("el-radio",{attrs:{label:"no"}},[e._v(e._s(e.lang.common.no))])],1)],1)],1)],1),e._v(" "),"no"===e.form.no_root_squash?a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.squashUser,"label-width":e.labelWidth}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.poolStorageFileShare.userPlaceholder,width:"100%"},model:{value:e.form.squash_user,callback:function(t){e.$set(e.form,"squash_user",t)},expression:"form.squash_user"}},e._l(e.userOrigin,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})}),1)],1)],1)],1):e._e(),e._v(" "),"no"===e.form.no_root_squash?a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.squashGroup,"label-width":e.labelWidth}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.poolStorageFileShare.groupPlaceholder,width:"100%"},model:{value:e.form.squash_group,callback:function(t){e.$set(e.form,"squash_group",t)},expression:"form.squash_group"}},e._l(e.groupOrigin,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})}),1)],1)],1)],1):e._e()],1):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:e.lang.poolStorageFileShare.selectUser,visible:e.showSelectUser,"append-to-body":"",width:"40%"},on:{close:e.closeChildDialog,open:function(t){e.preUsers=e.users}}},[a("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.member}},[a("el-col",{attrs:{span:24}},[a("el-transfer",{attrs:{filterable:"",titles:[e.lang.poolStorageFileShare.availableMember,e.lang.poolStorageGroup.selectedMember],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},props:{label:"name",key:"name"},data:e.userOrigin},model:{value:e.preUsers,callback:function(t){e.preUsers=t},expression:"preUsers"}})],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeChildDialog}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.getSelectedUser}},[e._v(e._s(e.lang.common.confirm))])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.lang.poolStorageFileShare.selectGroup,visible:e.showSelectGroup,"append-to-body":"",width:"40%"},on:{close:e.closeChildDialog,open:function(t){e.preGroups=e.groups}}},[a("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.userGroup}},[a("el-col",{attrs:{span:24}},[a("el-transfer",{attrs:{filterable:"",titles:[e.lang.poolStorageFileShare.availableGroup,e.lang.poolStorageFileShare.selectedGroup],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},props:{label:"name",key:"name"},data:e.groupOrigin},model:{value:e.preGroups,callback:function(t){e.preGroups=t},expression:"preGroups"}})],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeChildDialog}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.getSelectedGroup}},[e._v(e._s(e.lang.common.confirm))])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.stepIndex>0?a("el-button",{on:{click:function(t){return e.checkStep(!1)}}},[e._v(e._s(e.lang.common.prevStep))]):e._e(),e._v(" "),e.stepIndex!==e.nextStep?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.checkStep(!0)}}},[e._v(e._s(e.lang.common.nextStep))]):e._e(),e._v(" "),e.stepIndex===e.completeIndex?a("el-button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.createFileShare}},[e._v(e._s(e.lang.common.complete))]):e._e(),e._v(" "),a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))])],1)],1)},staticRenderFns:[]};var p=a("C7Lr")(i,c,!1,function(e){a("Oi0q"),a("XNQU")},"data-v-750af840",null).exports,u={name:"pana-delete-user",props:{show:Boolean},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},deleteUser:function(){this.closeModal(!0)}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.common.info,visible:e.show,width:"30%",modal:!0},on:{close:e.closeModal}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:10}},[e._v(e._s(e.lang.poolStorageFileShare.confirmDeleteFileShare))])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteUser}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]},g=a("C7Lr")(u,d,!1,null,null,null).exports,m={name:"pana-create-file",components:{"pana-ip-input":a("Cj+A").a},props:{show:Boolean,shareName:String},watch:{"form.cifs":function(e){"yes"===e?this.services.push("cifs"):this.services.splice(this.services.indexOf("cifs"),1)},"form.nfs":function(e){"yes"===e?this.services.push("nfs"):this.services.splice(this.services.indexOf("nfs"),1)},services:function(e){0===e.length?(this.nextStep=0,this.completeIndex=0):e.indexOf("cifs")>-1?(this.nextStep=1,this.completeIndex=1,e.indexOf("nfs")>-1&&(this.completeIndex=2)):(this.nextStep=2,this.completeIndex=2)},users:function(e,t){var a=this;e=this.common.deepCopyByJson(e),t=(t=this.common.deepCopyByJson(t)).filter(function(t){return!(e.indexOf(t)>-1)||(e.splice(e.indexOf(t),1),!1)}),this.usersInfo=this.usersInfo.filter(function(e){return!(t.indexOf(e.name)>-1)||(a.form.read_user.splice(a.form.read_user.indexOf(e),1),a.form.write_user.splice(a.form.write_user.indexOf(e),1),a.form.admin_users.splice(a.form.admin_users.indexOf(e),1),!1)}),e.map(function(e){a.usersInfo.push({name:e,access:"ro",show:!1}),a.form.read_user.push(e)})},groups:function(e,t){var a=this;e=this.common.deepCopyByJson(e),t=(t=this.common.deepCopyByJson(t)).filter(function(t){return!(e.indexOf(t)>-1)||(e.splice(e.indexOf(t),1),!1)}),this.groupInfo=this.groupInfo.filter(function(e){return!(t.indexOf(e.name)>-1)||(a.form.read_group.splice(a.form.read_group.indexOf(e),1),a.form.write_group.splice(a.form.write_group.indexOf(e),1),a.form.admin_groups.splice(a.form.admin_groups.indexOf(e),1),!1)}),e.map(function(e){a.groupInfo.push({name:e,access:"ro",show:!1}),a.form.read_group.push(e)})}},methods:{closeModal:function(e){e=e||!1,n()(this.$data,this.$options.data.call(this)),this.$emit("closeModal",e)},initForm:function(){null!=this.$refs.form&&this.$refs.form.clearValidate(),this.getShareInfo(),this.getVolumeList(),this.getSystemType()},getShareInfo:function(){var e=this;this.loading=!0,this.checkError(this.$http({url:this.common.formatMsg(this.api.shares.shares_detail,{name:this.shareName}),method:"get"}),function(t){var a=t.data[0],s=["hosts_allow","hosts_deny","write_host","access_host"];for(var l in a)a.hasOwnProperty(l)&&e.form.hasOwnProperty(l)&&(-1===s.indexOf(l)?e.form[l]=a[l]:e.form[l]=a[l].join("\n"));null!=a.read_user&&a.read_user.map(function(t){e.users.push(t),e.usersInfo.push({name:t,access:"ro",show:!1})}),null!=a.write_user&&a.write_user.map(function(t){e.users.push(t),e.usersInfo.push({name:t,access:"rw",show:!1})}),null!=a.admin_users&&a.admin_users.map(function(t){e.users.push(t),e.usersInfo.push({name:t,access:"super",show:!1})}),null!=a.read_group&&a.read_group.map(function(t){e.groups.push(t),e.groupInfo.push({name:t,access:"ro",show:!1})}),null!=a.write_group&&a.write_group.map(function(t){e.groups.push(t),e.groupInfo.push({name:t,access:"rw",show:!1})}),null!=a.admin_groups&&a.admin_groups.map(function(t){e.groups.push(t),e.groupInfo.push({name:t,access:"super",show:!1})}),e.loading=!1})},getVolumeList:function(){var e=this;this.loading=!0,this.checkError(this.$http({url:this.api.dataset.dataset,method:"get"}),function(t){e.loading=!1,e.volumes=t.data},function(){e.loading=!1})},validateIpAddressLen:function(e,t,a){var s=this,l=""===s.form[e.conmsg]||null==s.form[e.conmsg]?[]:s.form[e.conmsg].split("\n");e.items.map(function(e){null!=e.start&&null!=e.end&&s.common.arrayMerge(l,s.getIpInRange(e.start,e.end))}),l.length<=50?a():a(new Error(e.message))},editFileShare:function(){this.disable=!0;var e=this;this.$refs.form.validate(function(t){if(t){e.form.hosts_allow=""===e.form.hosts_allow||null==e.form.hosts_allow?[]:e.form.hosts_allow.split("\n"),e.form.hosts_deny=""===e.form.hosts_deny||null==e.form.hosts_deny?[]:e.form.hosts_deny.split("\n"),e.form.access_host=""===e.form.access_host||null==e.form.access_host?[]:e.form.access_host.split("\n"),e.form.write_host=""===e.form.write_host||null==e.form.write_host?[]:e.form.write_host.split("\n"),e.getAllRangeColumn(),delete e.form.allow_range,delete e.form.deny_range,delete e.form.nfs_allow_range,delete e.form.nfs_deny_range;var a=e.common.deepCopyByJson(e.common.dropEmptyParameter(e.form));e.form.hosts_allow="",e.form.hosts_deny="",e.form.access_host="",e.form.write_host="",e.checkError(e.$http({url:e.common.formatMsg(e.api.shares.shares_detail,{name:e.shareName}),method:"put",data:a}),function(){e.$notify({title:e.lang.common.success,type:"success",message:e.lang.poolStorageFileShare.editFileShareSuccess}),e.closeModal(!0)},function(){e.disable=!1})}else e.disable=!1})},checkStep:function(e){var t=this;!0===e?this.$refs.form.validate(function(e){e&&(t.stepIndex=t.nextStep,t.nextStep=t.completeIndex)}):(2===this.stepIndex?this.services.indexOf("cifs")>-1?this.stepIndex=1:this.stepIndex=0:this.stepIndex--,null!=this.$refs.form&&this.$refs.form.clearValidate()),2===this.stepIndex&&this.getSquashBase()},validateShareName:function(e,t,a){null==t||""===t||!0===/^[A-Za-z0-9][A-Za-z0-9_]*$/.test(t)?a():a(new Error(e.message))},validateIpEndRange:function(e,t,a){null!=e.start&&""!==e.start&&null!=t&&""!==t||a(),this.common.getLargerIp(e.start,t)===e.start?a(Error(e.message)):a()},newAddress:function(e){e.push({start:null,end:null})},deleteAddress:function(e,t){e.splice(t,1)},validateIpRange:function(){var e=["hosts_allow","hosts_deny","access_host","write_host"];!0===this.allowIpRange&&this.form.allow_range.map(function(t,a){e.push("allow_range."+a+".start"),e.push("allow_range."+a+".end")}),!0===this.denyIpRange&&this.form.deny_range.map(function(t,a){e.push("deny_range."+a+".start"),e.push("deny_range."+a+".end")}),!0===this.nfsAllowIpRange&&this.form.nfs_allow_range.map(function(t,a){e.push("nfs_allow_range."+a+".start"),e.push("nfs_allow_range."+a+".end")}),!0===this.nfsDenyIpRange&&this.form.nfs_deny_range.map(function(t,a){e.push("nfs_deny_range."+a+".start"),e.push("nfs_deny_range."+a+".end")});var t=!0;return this.$refs.form.validateField(e,function(e){t=null==e||""===e}),t},selectUser:function(){this.showSelectUser=!0,this.getUserList()},selectGroup:function(){this.showSelectGroup=!0,this.getGroupList()},getUserList:function(e){var t=this,a=!0===e?"?t=nfs":"";this.checkError(this.$http({url:this.api.user.user+a,method:"get"}),function(e){t.userOrigin=e.data})},getGroupList:function(e){var t=this,a=!0===e?"?t=nfs":"";this.checkError(this.$http({url:this.api.group.group+a,method:"get"}),function(e){t.groupOrigin=e.data})},getSelectedUser:function(){this.users=this.preUsers,this.closeChildDialog()},getSelectedGroup:function(){this.groups=this.preGroups,this.closeChildDialog()},closeChildDialog:function(){this.preGroups=[],this.preUsers=[],this.showSelectUser=!1,this.showSelectGroup=!1},userAccessChange:function(e){var t=this.form.read_user.indexOf(e.name),a=this.form.write_user.indexOf(e.name),s=this.form.admin_users.indexOf(e.name);switch(e.access){case"ro":this.form.read_user.push(e.name),a>-1&&this.form.write_user.splice(a,1),s>-1&&this.form.admin_users.splice(s,1);break;case"rw":this.form.write_user.push(e.name),t>-1&&this.form.read_user.splice(t,1),s>-1&&this.form.admin_users.splice(s,1);break;case"super":this.form.admin_users.push(e.name),t>-1&&this.form.read_user.splice(t,1),a>-1&&this.form.write_user.splice(a,1)}e.show=!1},groupAccessChange:function(e){var t=this.form.read_group.indexOf(e.name),a=this.form.write_group.indexOf(e.name),s=this.form.admin_groups.indexOf(e.name);switch(e.access){case"ro":this.form.read_group.push(e.name),a>-1&&this.form.write_group.splice(a,1),s>-1&&this.form.admin_groups.splice(s,1);break;case"rw":this.form.write_group.push(e.name),t>-1&&this.form.read_group.splice(t,1),s>-1&&this.form.admin_groups.splice(s,1);break;case"super":this.form.admin_groups.push(e.name),t>-1&&this.form.read_group.splice(t,1),a>-1&&this.form.write_group.splice(a,1)}e.show=!1},getSquashBase:function(){0===this.userOrigin.length&&this.getUserList(!0),0===this.groupOrigin.length&&this.getGroupList(!0)},getAllRangeColumn:function(){var e=this;this.form.allow_range.map(function(t){null!=t.start&&null!=t.end&&e.common.arrayMerge(e.form.hosts_allow,e.getIpInRange(t.start,t.end))}),this.form.deny_range.map(function(t){null!=t.start&&null!=t.end&&e.common.arrayMerge(e.form.hosts_deny,e.getIpInRange(t.start,t.end))}),this.form.nfs_allow_range.map(function(t){null!=t.start&&null!=t.end&&e.common.arrayMerge(e.form.access_host,e.getIpInRange(t.start,t.end))}),this.form.nfs_deny_range.map(function(t){null!=t.start&&null!=t.end&&e.common.arrayMerge(e.form.write_host,e.getIpInRange(t.start,t.end))})},getIpInRange:function(e,t){if(null==e||null==t||""===e||""===t)return[];for(var a=e,s=[];this.common.getLargerIp(a,t)===t&&(s.push(a),a!==t);){for(var l=a.split(".").reverse(),r=0;r<4&&-1!==r;){if(!(l[r]>=255)){l[r]++,r=-1;break}r++}a=l.reverse().join("."),s.push(a)}return s},validateIps:function(e,t,a){""!==t&&null!=t||a();var s=!0,l=/^((?=(\b|\D))(((\d{1,2})|(1\d{1,2})|(2[0-4]\d)|(25[0-5]))\.){3}((\d{1,2})|(1\d{1,2})|(2[0-4]\d)|(25[0-5]))(?=(\b|\D))|\*)$/;t.split("\n").map(function(e){!1===l.test(e)&&(s=!1)}),!0===s?a():a(new Error(e.message))},getSystemType:function(){var e=this;this.checkError(this.$http({url:this.api.storage.get_type,method:"get"}),function(t){e.systemType=t.data})}},data:function(){return{labelWidth:"120px",form:{name:"",volume:"",cifs:"no",nfs:"no",browseable:"yes",read_only:"no",create_mask:"0744",directory_mask:"0755",hosts_allow:"",hosts_deny:"",guest_ok:"no",read_user:[],write_user:[],admin_users:[],read_group:[],write_group:[],admin_groups:[],sync:"no",access_host:"",write_host:"",no_root_squash:"no",squash_user:"",squash_group:"",allow_range:[{start:"",end:""}],deny_range:[{start:"",end:""}],nfs_allow_range:[{start:"",end:""}],nfs_deny_range:[{start:"",end:""}]},stepIndex:0,nextStep:0,completeIndex:0,accessControl:"allow",nfsAccessControl:"allow",allowIpRange:!1,denyIpRange:!1,nfsAllowIpRange:!1,nfsDenyIpRange:!1,rules:{name:[{required:!0,message:this.lang.poolStorageFileShare.nameRequiredRule,trigger:"blur"},{min:1,max:32,message:this.lang.poolStorageFileShare.nameLengthRule,trigger:"blur"},{validator:this.validateShareName,message:this.lang.poolStorageFileShare.nameFormatRule,trigger:"blur"}],volume:[{required:!0,message:this.lang.poolStorageFileShare.volumeRequiredRule,trigger:"blur"}],create_mask:[{required:!0,message:this.lang.poolStorageFileShare.createMaskRequiredRule,trigger:"blur"},{validator:this.validateLinuxMask,message:this.lang.poolStorageFileShare.createMaskFormatRule,trigger:"blur"}],directory_mask:[{required:!0,message:this.lang.poolStorageFileShare.directoryMaskRequiredRule,trigger:"blur"},{validator:this.validateLinuxMask,message:this.lang.poolStorageFileShare.directoryMaskFormatRule,trigger:"blur"}],hosts_allow:[{validator:this.validateIps,message:this.lang.poolStorageFileShare.hostsFormatRule,trigger:"blur"},{validator:this.common.validateDnsServersLen,message:"ip名单不能超过50条",trigger:"blur"}],hosts_deny:[{validator:this.validateIps,message:this.lang.poolStorageFileShare.hostsFormatRule,trigger:"blur"},{validator:this.common.validateDnsServersLen,message:"ip名单不能超过50条",trigger:"blur"}],access_host:[{validator:this.validateIps,message:this.lang.poolStorageFileShare.hostsFormatRule,trigger:"blur"},{validator:this.common.validateDnsServersLen,message:"ip名单不能超过50条",trigger:"blur"}],write_host:[{validator:this.validateIps,message:this.lang.poolStorageFileShare.hostsFormatRule,trigger:"blur"},{validator:this.common.validateDnsServersLen,message:"ip名单不能超过50条",trigger:"blur"}]},langStepConfig:[this.lang.poolStorageFileShare.baseSeting,this.lang.poolStorageFileShare.cifs,this.lang.poolStorageFileShare.nfs],volumes:[],services:[],users:[],groups:[],preUsers:[],preGroups:[],userOrigin:[],groupOrigin:[],usersInfo:[],groupInfo:[],cifs:!1,nfs:!1,accessConf:{ro:this.lang.poolStorageFileShare.roAccess,rw:this.lang.poolStorageFileShare.rwAccess,super:this.lang.poolStorageFileShare.superAccess},showSelectUser:!1,showSelectGroup:!1,disable:!1,loading:!1,systemType:""}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.poolStorageFileShare.editFile,width:"40%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{"label-position":"right",model:e.form,rules:e.rules,"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)"}},[a("el-steps",{attrs:{active:e.stepIndex,"align-center":!0,"process-status":"finish","finish-status":"success"}},e._l(e.langStepConfig,function(e,t){return a("el-step",{key:t,attrs:{title:e,icon:"fa fa-circle"}})}),1),e._v(" "),0===e.stepIndex?a("div",{staticClass:"step-padding-top"},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.shareName,"label-width":e.labelWidth,prop:"name"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.poolStorageFileShare.shareNamePlaceholder,disabled:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.volumeName,"label-width":e.labelWidth,prop:"volume"}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.poolStorageFileShare.volumeNamePlaceholder,disabled:"",width:"100%"},model:{value:e.form.volume,callback:function(t){e.$set(e.form,"volume",t)},expression:"form.volume"}},e._l(e.volumes,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.path}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.pool.share,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{attrs:{label:e.lang.poolStorageFileShare.cifs,"true-label":"yes","false-label":"no"},model:{value:e.form.cifs,callback:function(t){e.$set(e.form,"cifs",t)},expression:"form.cifs"}}),e._v(" "),a("el-checkbox",{attrs:{label:e.lang.poolStorageFileShare.nfs,"true-label":"yes","false-label":"no"},model:{value:e.form.nfs,callback:function(t){e.$set(e.form,"nfs",t)},expression:"form.nfs"}})],1)],1)],1)],1)],1):e._e(),e._v(" "),1===e.stepIndex?a("div",{staticClass:"step-padding-top"},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{attrs:{label:e.lang.poolStorageFileShare.browseable,"true-label":"yes","false-label":"no"},model:{value:e.form.browseable,callback:function(t){e.$set(e.form,"browseable",t)},expression:"form.browseable"}}),e._v(" "),a("el-checkbox",{attrs:{label:e.lang.poolStorageFileShare.readonly,"true-label":"yes","false-label":"no"},model:{value:e.form.read_only,callback:function(t){e.$set(e.form,"read_only",t)},expression:"form.read_only"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.createMask,"label-width":e.labelWidth,prop:"create_mask"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.poolStorageFileShare.createMaskPlaceholder},model:{value:e.form.create_mask,callback:function(t){e.$set(e.form,"create_mask",t)},expression:"form.create_mask"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.directoryMask,"label-width":e.labelWidth,prop:"directory_mask"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.poolStorageFileShare.directoryMaskPlaceholder},model:{value:e.form.directory_mask,callback:function(t){e.$set(e.form,"directory_mask",t)},expression:"form.directory_mask"}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"hr-row",attrs:{type:"flex",justify:"space-between"}},[a("span",{staticStyle:{display:"inline-block","margin-left":"20px"}},[e._v(e._s(e.lang.poolStorageFileShare.ipAccessControl))]),e._v(" "),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.lang.poolStorageFileShare.accessIpInfo)},slot:"content"}),e._v(" "),a("i",{staticClass:"fa fa-question-circle"})])],1),e._v(" "),a("el-tabs",{attrs:{"tab-position":"left","before-leave":e.validateIpRange},model:{value:e.accessControl,callback:function(t){e.accessControl=t},expression:"accessControl"}},[a("el-tab-pane",{attrs:{label:e.lang.poolStorageFileShare.allowAccessIp,name:"allow"}},[a("el-row",{staticClass:"ip-textarea",attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipAddress,"label-width":e.labelWidth,prop:"hosts_allow"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:e.lang.poolStorageFileShare.hostsPlaceholder},model:{value:e.form.hosts_allow,callback:function(t){e.$set(e.form,"hosts_allow",t)},expression:"form.hosts_allow"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.useRangeSeting,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.allowIpRange,callback:function(t){e.allowIpRange=t},expression:"allowIpRange"}})],1)],1)],1)],1),e._v(" "),!0===e.allowIpRange?a("div",[a("el-row",{attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipRange,"label-width":e.labelWidth}},e._l(e.form.allow_range,function(t,s){return a("el-row",{key:s,staticClass:"ip-range",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.start,"label-width":"50px",prop:"allow_range."+s+".start",rules:[{required:!0,message:e.lang.poolStorageFileShare.startRequiredRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.poolStorageFileShare.ipFormatRule,trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.end,"label-width":"50px",prop:"allow_range."+s+".end",rules:[{required:!0,message:e.lang.pool.endRequiredRule,trigger:"blur"},{validator:e.validateIpEndRange,start:t.start,message:e.lang.poolStorageFileShare.endRangeRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.pool.ipFormatRule,trigger:"blur"},{validator:e.validateIpAddressLen,message:"ip名单不能超过50条",items:e.form.allow_range,conmsg:"hosts_allow",trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range-button",attrs:{label:""}},[1!==e.form.allow_range.length?a("el-button",{staticClass:"fa fa-minus",staticStyle:{color:"#67C23A"},attrs:{type:"text"},on:{click:function(t){return e.deleteAddress(e.form.allow_range,s)}}}):e._e(),e._v(" "),e.form.allow_range.length-1===s?a("el-button",{staticClass:"fa fa-plus",attrs:{type:"text"},on:{click:function(t){return e.newAddress(e.form.allow_range)}}}):e._e()],1)],1)],1)}),1)],1)],1)],1):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{label:e.lang.poolStorageFileShare.denyAccessIp,name:"deny"}},[a("el-row",{staticClass:"ip-textarea",attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipAddress,"label-width":e.labelWidth,prop:"hosts_deny"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:e.lang.poolStorageFileShare.hostsPlaceholder},model:{value:e.form.hosts_deny,callback:function(t){e.$set(e.form,"hosts_deny",t)},expression:"form.hosts_deny"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.useRangeSeting,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.denyIpRange,callback:function(t){e.denyIpRange=t},expression:"denyIpRange"}})],1)],1)],1)],1),e._v(" "),!0===e.denyIpRange?a("div",[a("el-row",{attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipRange,"label-width":e.labelWidth}},e._l(e.form.deny_range,function(t,s){return a("el-row",{key:s,staticClass:"ip-range",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.start,"label-width":"50px",prop:"deny_range."+s+".start",rules:[{required:!0,message:e.lang.poolStorageFileShare.startRequiredRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.poolStorageFileShare.ipFormatRule,trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.end,"label-width":"50px",prop:"deny_range."+s+".end",rules:[{required:!0,message:e.lang.pool.endRequiredRule,trigger:"blur"},{validator:e.validateIpEndRange,start:t.start,message:e.lang.poolStorageFileShare.endRangeRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.pool.ipFormatRule,trigger:"blur"},{validator:e.validateIpAddressLen,message:"ip名单不能超过50条",items:e.form.deny_range,conmsg:"hosts_deny",trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range-button",attrs:{label:""}},[1!==e.form.deny_range.length?a("el-button",{staticClass:"fa fa-minus",staticStyle:{color:"#67C23A"},attrs:{type:"text"},on:{click:function(t){return e.deleteAddress(e.form.deny_range,s)}}}):e._e(),e._v(" "),e.form.deny_range.length-1===s?a("el-button",{staticClass:"fa fa-plus",attrs:{type:"text"},on:{click:function(t){return e.newAddress(e.form.deny_range)}}}):e._e()],1)],1)],1)}),1)],1)],1)],1):e._e()],1)],1),e._v(" "),a("el-row",{staticClass:"hr-row",attrs:{type:"flex",justify:"start"}},[a("span",{staticStyle:{display:"inline-block","margin-left":"20px"}},[e._v(e._s(e.lang.poolStorageFileShare.userGroupAccessControl))])]),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.anonymousAccess,"label-width":e.labelWidth}},[a("el-radio-group",{model:{value:e.form.guest_ok,callback:function(t){e.$set(e.form,"guest_ok",t)},expression:"form.guest_ok"}},[a("el-radio",{attrs:{label:"yes"}},[e._v(e._s(e.lang.common.yes))]),e._v(" "),a("el-radio",{attrs:{label:"no"}},[e._v(e._s(e.lang.common.no))])],1)],1)],1)],1),e._v(" "),"no"===e.form.guest_ok?a("div",[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("span",[e._v(e._s(e.lang.poolStorageFileShare.userAccess))]),e._v(" "),a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:e.selectUser}},[e._v(e._s(e.lang.common.update))])],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-table",{ref:"singleTable",staticClass:"cloud-table modal-table",staticStyle:{width:"100%"},attrs:{data:e.usersInfo,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.username,sortable:"",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.access,sortable:"",prop:"access",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:function(e){t.row.show=!t.row.show}}},[e._v("\n                                            "+e._s(e.accessConf[t.row.access])+"\n                                            "),!1===t.row.show?a("i",{staticClass:"fa fa-lock",staticStyle:{"margin-left":"10px"}}):a("i",{staticClass:"fa fa-unlock",staticStyle:{"margin-left":"10px"}})])]}}],null,!1,27438355)}),e._v(" "),a("el-table-column",{attrs:{width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio-group",{directives:[{name:"show",rawName:"v-show",value:t.row.show,expression:"scope.row.show"}],on:{change:function(a){return e.userAccessChange(t.row)}},model:{value:t.row.access,callback:function(a){e.$set(t.row,"access",a)},expression:"scope.row.access"}},[a("el-radio",{attrs:{label:"ro"}},[e._v(e._s(e.lang.poolStorageFileShare.roAccess))]),e._v(" "),a("el-radio",{attrs:{label:"rw"}},[e._v(e._s(e.lang.poolStorageFileShare.rwAccess))]),e._v(" "),a("el-radio",{attrs:{label:"super"}},[e._v(e._s(e.lang.poolStorageFileShare.superAccess))])],1)]}}],null,!1,3710881091)})],1)],1),e._v(" "),a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"space-between"}},[a("span",[e._v(e._s(e.lang.poolStorageFileShare.groupAccess))]),e._v(" "),a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:e.selectGroup}},[e._v(e._s(e.lang.common.update))])],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-table",{ref:"singleTable",staticClass:"cloud-table modal-table",staticStyle:{width:"100%"},attrs:{data:e.groupInfo,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.groupName,sortable:"",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.access,sortable:"",prop:"access",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:function(e){t.row.show=!t.row.show}}},[e._v("\n                                            "+e._s(e.accessConf[t.row.access])+"\n                                            "),!1===t.row.show?a("i",{staticClass:"fa fa-lock",staticStyle:{"margin-left":"10px"}}):a("i",{staticClass:"fa fa-unlock",staticStyle:{"margin-left":"10px"}})])]}}],null,!1,27438355)}),e._v(" "),a("el-table-column",{attrs:{width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio-group",{directives:[{name:"show",rawName:"v-show",value:t.row.show,expression:"scope.row.show"}],on:{change:function(a){return e.groupAccessChange(t.row)}},model:{value:t.row.access,callback:function(a){e.$set(t.row,"access",a)},expression:"scope.row.access"}},[a("el-radio",{attrs:{label:"ro"}},[e._v(e._s(e.lang.poolStorageFileShare.roAccess))]),e._v(" "),a("el-radio",{attrs:{label:"rw"}},[e._v(e._s(e.lang.poolStorageFileShare.rwAccess))]),e._v(" "),a("el-radio",{attrs:{label:"super"}},[e._v(e._s(e.lang.poolStorageFileShare.superAccess))])],1)]}}],null,!1,727300877)})],1)],1)],1)],1)],1):e._e()],1):e._e(),e._v(" "),2===e.stepIndex?a("div",{staticClass:"step-padding-top"},["FreeBSD"!==e.systemType?a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.dataSync,"label-width":e.labelWidth}},[a("el-radio-group",{model:{value:e.form.sync,callback:function(t){e.$set(e.form,"sync",t)},expression:"form.sync"}},[a("el-radio",{attrs:{label:"yes"}},[e._v(e._s(e.lang.common.yes))]),e._v(" "),a("el-radio",{attrs:{label:"no"}},[e._v(e._s(e.lang.common.no))])],1)],1)],1)],1):e._e(),e._v(" "),a("el-row",{staticClass:"hr-row",attrs:{type:"flex",justify:"space-between"}},[a("span",{staticStyle:{display:"inline-block","margin-left":"20px"}},[e._v(e._s(e.lang.poolStorageFileShare.ipAccessControl))]),e._v(" "),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.lang.poolStorageFileShare.accessIpInfo)},slot:"content"}),e._v(" "),a("i",{staticClass:"fa fa-question-circle"})])],1),e._v(" "),a("el-tabs",{attrs:{"tab-position":"left","before-leave":e.validateIpRange},model:{value:e.nfsAccessControl,callback:function(t){e.nfsAccessControl=t},expression:"nfsAccessControl"}},[a("el-tab-pane",{attrs:{label:e.lang.poolStorageFileShare.allowAccessIp,name:"allow"}},[a("el-row",{staticClass:"ip-textarea",attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipAddress,"label-width":e.labelWidth,prop:"access_host"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:e.lang.poolStorageFileShare.hostsPlaceholder},model:{value:e.form.access_host,callback:function(t){e.$set(e.form,"access_host",t)},expression:"form.access_host"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.useRangeSeting,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.nfsAllowIpRange,callback:function(t){e.nfsAllowIpRange=t},expression:"nfsAllowIpRange"}})],1)],1)],1)],1),e._v(" "),!0===e.nfsAllowIpRange?a("div",[a("el-row",{attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipRange,"label-width":e.labelWidth}},e._l(e.form.nfs_allow_range,function(t,s){return a("el-row",{key:s,staticClass:"ip-range",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.start,"label-width":"50px",prop:"nfs_allow_range."+s+".start",rules:[{required:!0,message:e.lang.poolStorageFileShare.startRequiredRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.poolStorageFileShare.ipFormatRule,trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.end,"label-width":"50px",prop:"nfs_allow_range."+s+".end",rules:[{required:!0,message:e.lang.pool.endRequiredRule,trigger:"blur"},{validator:e.validateIpEndRange,start:t.start,message:e.lang.poolStorageFileShare.endRangeRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.pool.ipFormatRule,trigger:"blur"},{validator:e.validateIpAddressLen,message:"ip名单不能超过50条",items:e.form.nfs_allow_range,conmsg:"access_host",trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range-button",attrs:{label:""}},[1!==e.form.nfs_allow_range.length?a("el-button",{staticClass:"fa fa-minus",staticStyle:{color:"#67C23A"},attrs:{type:"text"},on:{click:function(t){return e.deleteAddress(e.form.nfs_allow_range,s)}}}):e._e(),e._v(" "),e.form.nfs_allow_range.length-1===s?a("el-button",{staticClass:"fa fa-plus",attrs:{type:"text"},on:{click:function(t){return e.newAddress(e.form.nfs_allow_range)}}}):e._e()],1)],1)],1)}),1)],1)],1)],1):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{label:e.lang.poolStorageFileShare.denyAccessIp,name:"deny"}},[a("el-row",{staticClass:"ip-textarea",attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipAddress,"label-width":e.labelWidth,prop:"write_host"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:e.lang.poolStorageFileShare.hostsPlaceholder},model:{value:e.form.write_host,callback:function(t){e.$set(e.form,"write_host",t)},expression:"form.write_host"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.useRangeSeting,"label-width":e.labelWidth}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.nfsDenyIpRange,callback:function(t){e.nfsDenyIpRange=t},expression:"nfsDenyIpRange"}})],1)],1)],1)],1),e._v(" "),!0===e.nfsDenyIpRange?a("div",[a("el-row",{attrs:{type:"flex",justify:"start"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.ipRange,"label-width":e.labelWidth}},e._l(e.form.nfs_deny_range,function(t,s){return a("el-row",{key:s,staticClass:"ip-range",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.start,"label-width":"50px",prop:"nfs_deny_range."+s+".start",rules:[{required:!0,message:e.lang.poolStorageFileShare.startRequiredRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.poolStorageFileShare.ipFormatRule,trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range",attrs:{label:e.lang.common.end,"label-width":"50px",prop:"nfs_deny_range."+s+".end",rules:[{required:!0,message:e.lang.pool.endRequiredRule,trigger:"blur"},{validator:e.validateIpEndRange,start:t.start,message:e.lang.poolStorageFileShare.endRangeRule,trigger:"blur"},{validator:e.common.validateIpAddress,message:e.lang.pool.ipFormatRule,trigger:"blur"},{validator:e.validateIpAddressLen,message:"ip名单不能超过50条",items:e.form.nfs_deny_range,conmsg:"write_host",trigger:"blur"}]}},[a("el-input",{staticClass:"address",model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("el-form-item",{staticClass:"address-range-button",attrs:{label:""}},[1!==e.form.nfs_deny_range.length?a("el-button",{staticClass:"fa fa-minus",staticStyle:{color:"#67C23A"},attrs:{type:"text"},on:{click:function(t){return e.deleteAddress(e.form.nfs_deny_range,s)}}}):e._e(),e._v(" "),e.form.nfs_deny_range.length-1===s?a("el-button",{staticClass:"fa fa-plus",attrs:{type:"text"},on:{click:function(t){return e.newAddress(e.form.nfs_deny_range)}}}):e._e()],1)],1)],1)}),1)],1)],1)],1):e._e()],1)],1),e._v(" "),a("el-row",{staticClass:"hr-row",attrs:{type:"flex",justify:"start"}},[a("span",{staticStyle:{display:"inline-block","margin-left":"20px"}},[e._v(e._s(e.lang.poolStorageFileShare.userGroupAccessControl))])]),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.denySquashUser,"label-width":e.labelWidth}},[a("el-radio-group",{model:{value:e.form.no_root_squash,callback:function(t){e.$set(e.form,"no_root_squash",t)},expression:"form.no_root_squash"}},[a("el-radio",{attrs:{label:"yes"}},[e._v(e._s(e.lang.common.yes))]),e._v(" "),a("el-radio",{attrs:{label:"no"}},[e._v(e._s(e.lang.common.no))])],1)],1)],1)],1),e._v(" "),"no"===e.form.no_root_squash?a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.squashUser,"label-width":e.labelWidth}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.poolStorageFileShare.userPlaceholder,width:"100%"},model:{value:e.form.squash_user,callback:function(t){e.$set(e.form,"squash_user",t)},expression:"form.squash_user"}},e._l(e.userOrigin,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})}),1)],1)],1)],1):e._e(),e._v(" "),"no"===e.form.no_root_squash?a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.squashGroup,"label-width":e.labelWidth}},[a("el-select",{attrs:{filterable:"",placeholder:e.lang.poolStorageFileShare.groupPlaceholder,width:"100%"},model:{value:e.form.squash_group,callback:function(t){e.$set(e.form,"squash_group",t)},expression:"form.squash_group"}},e._l(e.groupOrigin,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})}),1)],1)],1)],1):e._e()],1):e._e()],1),e._v(" "),a("el-dialog",{staticClass:"transfer-dialog",attrs:{title:e.lang.poolStorageFileShare.selectUser,visible:e.showSelectUser,"append-to-body":"",width:"40%"},on:{close:e.closeChildDialog,open:function(t){e.preUsers=e.users}}},[a("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.member}},[a("el-col",{attrs:{span:24}},[a("el-transfer",{attrs:{filterable:"",titles:[e.lang.poolStorageFileShare.availableMember,e.lang.poolStorageGroup.selectedMember],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},props:{label:"name",key:"name"},data:e.userOrigin},model:{value:e.preUsers,callback:function(t){e.preUsers=t},expression:"preUsers"}})],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeChildDialog}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.getSelectedUser}},[e._v(e._s(e.lang.common.confirm))])],1)],1),e._v(" "),a("el-dialog",{staticClass:"transfer-dialog",attrs:{title:e.lang.poolStorageFileShare.selectGroup,visible:e.showSelectGroup,"append-to-body":"",width:"40%"},on:{close:e.closeChildDialog,open:function(t){e.preGroups=e.groups}}},[a("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.lang.poolStorageFileShare.userGroup}},[a("el-col",{attrs:{span:24}},[a("el-transfer",{attrs:{filterable:"",titles:[e.lang.poolStorageFileShare.availableGroup,e.lang.poolStorageFileShare.selectedGroup],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},props:{label:"name",key:"name"},data:e.groupOrigin},model:{value:e.preGroups,callback:function(t){e.preGroups=t},expression:"preGroups"}})],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeChildDialog}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.getSelectedGroup}},[e._v(e._s(e.lang.common.confirm))])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.stepIndex>0?a("el-button",{on:{click:function(t){return e.checkStep(!1)}}},[e._v(e._s(e.lang.common.prevStep))]):e._e(),e._v(" "),e.stepIndex!==e.nextStep?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.checkStep(!0)}}},[e._v(e._s(e.lang.common.nextStep))]):e._e(),e._v(" "),e.stepIndex===e.completeIndex?a("el-button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.editFileShare}},[e._v(e._s(e.lang.common.complete))]):e._e(),e._v(" "),a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))])],1)],1)},staticRenderFns:[]};var h=a("C7Lr")(m,f,!1,function(e){a("FxZD"),a("lOtg")},"data-v-1b9aec4e",null).exports,_={name:"file-share",components:{"pana-breadcrumb":r.a,"pana-create-file":p,"pana-delete-file":g,"pana-edit-file":h},data:function(){return{showShadow:!1,pageSize:10,fileSearch:"",fileOrigin:[],fileSelectionNames:[],filePage:1,showCreateFile:!1,showDeleteFile:!1,showEditFile:!1,status:{yes:this.lang.common.yes,no:this.lang.common.no},editObjName:"",loading:!1}},computed:{fileFilter:function(){var e=this;return this.fileOrigin.filter(function(t){return""===e.fileSearch||-1!==l()(t).search(e.fileSearch)})},fileTable:function(){return this.fileFilter.length>this.pageSize?this.fileFilter.slice((this.filePage-1)*this.pageSize,this.filePage*this.pageSize):this.fileFilter}},methods:{switchFilePage:function(e){this.filePage=e},editFile:function(e){this.editObjName=e.name,this.showEditFile=!0},sortChange:function(e){var t=null==e.order?0:"ascending"===e.order?1:-1;this.fileOrigin=this.fileOrigin.sort(function(a,s){return a[e.prop]=null==a[e.prop]?"":a[e.prop],s[e.prop]=null==s[e.prop]?"":s[e.prop],(a[e.prop]>s[e.prop]?1:-1)*t})},closeCreateFile:function(e){!0===e&&this.getFileList(),this.showCreateFile=!1},closeEditFile:function(e){!0===e&&this.getFileList(),this.showEditFile=!1},closeDeleteFile:function(e){var t=this;this.showDeleteFile=!1,!0===e&&this.checkError(this.$http({url:this.api.shares.shares_batch_delete,method:"post",data:{names:this.fileSelectionNames}}),function(){t.$notify({title:t.lang.common.success,type:"success",message:t.lang.poolStorageFileShare.deleteFileShareSuccess}),t.getFileList()})},getFileList:function(){var e=this;this.loading=!0,this.checkError(this.$http({url:this.api.shares.shares,method:"get"}),function(t){e.loading=!1,null==t.data?e.showShadow=!0:e.fileOrigin=t.data},function(){e.loading=!1})},selectFileNames:function(e){var t=[];e.forEach(function(e){t.push(e.name)}),this.fileSelectionNames=t},editUser:function(e){this.editObj=this.common.deepCopyByJson(e),this.showEditFile=!0}},mounted:function(){this.getFileList()},watch:{fileSearch:function(){this.filePage=1}}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"parent-div"},[a("el-container",{attrs:{type:"flex",direction:"vertical"}},[a("pana-breadcrumb",{attrs:{changePool:!0,callback:e.getFileList}}),e._v(" "),a("el-main",[a("el-row",{staticClass:"pana-btn-group",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"primary",disabled:e.loading},on:{click:function(t){e.showCreateFile=!0}}},[e._v("\n                        "+e._s(e.lang.common.create)+"\n                    ")]),e._v(" "),a("el-button",{attrs:{disabled:e.loading||0===e.fileSelectionNames.length},on:{click:function(t){e.showDeleteFile=!0}}},[e._v("\n                        "+e._s(e.lang.common.delete)+"\n                    ")])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-row",{staticClass:"search-row",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:22}},[a("el-input",{attrs:{placeholder:e.lang.common.search,"suffix-icon":"el-icon-search"},model:{value:e.fileSearch,callback:function(t){e.fileSearch=t},expression:"fileSearch"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"fa fa-refresh",attrs:{type:"text",circle:""},on:{click:e.getFileList}})],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)",data:e.fileTable,"tooltip-effect":"dark"},on:{"selection-change":e.selectFileNames,"sort-change":e.sortChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.shareName,sortable:"custom",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.supportCifs,sortable:"custom",prop:"cifs"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e.status[t.row.cifs])+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.supportNfs,sortable:"custom",prop:"nfs"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e.status[t.row.nfs])+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.poolStorageFileShare.volumeName,sortable:"custom",prop:"volume"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.common.operation},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editFile(t.row)}}},[e._v("\n                            "+e._s(e.lang.common.update)+"\n                        ")])]}}])})],1),e._v(" "),a("el-row",{staticClass:"pana-pagination-row",attrs:{type:"flex",justify:"end"}},[e.fileFilter.length>e.pageSize?a("el-pagination",{attrs:{background:"",layout:"slot, prev, pager, next","prev-text":e.lang.common.prevPage,"next-text":e.lang.common.nextPage,total:e.fileFilter.length,"page-size":e.pageSize},on:{"current-change":e.switchFilePage}},[e._t("default",[a("span",{staticClass:"pagination-slot"},[e._v("\n                        "+e._s(e.common.formatMsg(e.lang.common.paginationMsg,{current:this.filePage,total:this.fileFilter.length}))+"\n                    ")])])],2):e._e()],1)],1),e._v(" "),a("pana-create-file",{attrs:{show:e.showCreateFile},on:{closeModal:e.closeCreateFile}}),e._v(" "),a("pana-delete-file",{attrs:{show:e.showDeleteFile},on:{closeModal:e.closeDeleteFile}}),e._v(" "),a("pana-edit-file",{attrs:{show:e.showEditFile,shareName:e.editObjName},on:{closeModal:e.closeEditFile}})],1),e._v(" "),e.showShadow?a("div",{staticClass:"none-service"},[a("div",{staticClass:"info"},[e._v(e._s(e.lang.poolStorageFileShare.noneServiceInfo))])]):e._e()],1)},staticRenderFns:[]};var v=a("C7Lr")(_,b,!1,function(e){a("fsgw")},"data-v-1e1cd11c",null);t.default=v.exports},XNQU:function(e,t){},fsgw:function(e,t){},lOtg:function(e,t){}});