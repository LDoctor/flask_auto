webpackJsonp([33],{"7UtQ":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("1JPr"),s={props:{show:Boolean},data:function(){return{labelWidth:"120px",form:{name:"",resourceType:"physical"},rules:{name:[{required:!0,message:"请输入告警模板名称",trigger:"blur"},{min:1,max:32,message:"长度为1-32个字符",trigger:"blur"},{validator:this.common.validateName6,trigger:"blur"}]},loading:!1}},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},ensureCreat:function(){var e=this,t=this;this.$refs.form.validate(function(a){a&&(e.loading=!0,e.checkError(e.$http({url:t.api.alarmManage.getalarmTemplate,method:"post",data:t.form}),function(){t.loading=!1,t.$notify({title:t.lang.common.success,type:"success",message:"新建成功"}),t.closeModal(!0)}))})},initForm:function(){null!=this.$refs.form&&this.$refs.form.resetFields(),this.loading=!1}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.alarmManage.createTemplate,width:"45%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[a("el-form",{ref:"form",attrs:{"label-position":"right",model:e.form,rules:e.rules}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.alarmManage.templateName,"label-width":e.labelWidth,prop:"name"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.alarmManage.placealarmTemplate},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.alarmManage.sourceType,"label-width":e.labelWidth,prop:"resourceType"}},[a("el-radio-group",{model:{value:e.form.resourceType,callback:function(t){e.$set(e.form,"resourceType",t)},expression:"form.resourceType"}},[a("el-radio",{attrs:{label:"physical"}},[e._v("物理主机")]),e._v(" "),a("el-radio",{attrs:{label:"virtual"}},[e._v("云组件")]),e._v(" "),a("el-radio",{attrs:{label:"ceph"}},[e._v("ceph")])],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",staticStyle:{display:"block","text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.ensureCreat}},[e._v(e._s(e.lang.common.confirm))])],1)],1)])},staticRenderFns:[]};var r=a("C7Lr")(s,o,!1,function(e){a("LNH0")},null,null).exports,n={props:{show:Boolean},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},deleteTemplate:function(){this.closeModal(!0)}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.common.info,visible:e.show,width:"30%",modal:!0},on:{close:e.closeModal}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:10}},[e._v(e._s(e.lang.alarmManage.deleteTemplate))])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteTemplate}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]},u=a("C7Lr")(n,i,!1,null,null,null).exports,c={props:{show:Boolean,template:Object,listdata:Array},data:function(){return{labelWidth:"120px",form:{name:""},rules:{name:[{required:!0,message:"请输入告警模板名称",trigger:"blur"},{min:1,max:32,message:"长度为1-32个字符",trigger:"blur"},{validator:this.common.validateName6,trigger:"blur"}]},showsameName:!1}},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},ensureEdite:function(){for(var e=this,t=this,a=0;a<this.listdata.length;a++)if(this.listdata[a].name==this.form.name&&this.form.name!==this.template.name)return this.showsameName=!0,!1;this.$refs.form.validate(function(a){a&&e.checkError(e.$http({url:t.common.formatMsg(t.api.alarmManage.editTemplate,{id:t.template.id}),method:"put",data:{name:e.form.name,resourceType:e.template.resourceType}}),function(e){t.$notify({title:t.lang.common.success,type:"success",message:"修改成功！"}),t.closeModal(!0)})})},initForm:function(){null!=this.$refs.form&&this.$refs.form.clearValidate(),this.form.name=this.template.name,this.showsameName=!1}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.alarmManage.editTemplate,width:"45%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{ref:"form",attrs:{"label-position":"right",model:e.form,rules:e.rules}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.alarmManage.templateName,"label-width":e.labelWidth,prop:"name"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.alarmManage.placealarmTemplate},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1)],1)],1),e._v(" "),e.showsameName?a("div",{staticStyle:{color:"red","text-align":"center"}},[e._v("模板名称已存在，请重新输入")]):e._e(),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.ensureEdite}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var m=a("C7Lr")(c,p,!1,function(e){a("8HwQ")},null,null).exports,h={props:{show:Boolean,template:Object},data:function(){return{labelWidth:"120px",showwarning:!0,tableData:[],flagData:[],form:{inputvalue:""},severityLever:{critical:"严重",moderate:"适中",low:"低"},rulesname:{"mem.used_percent":"内存使用率","disk.used_percent":"磁盘分区使用率","cpu.usage_system":"CPU使用率","swap.used_percent":"交换空间使用率","net.bytes_recv":"网络流入速率","net.bytes_sent":"网络流出速率","disk.used_percent.paths-/":"根目录使用率","disk.used_percent.paths-/var":"var目录使用率"},cephrulesname:{"ceph_pools.use_percent":"存储池空间使用率","ceph_pools.pool_rBandwidth":"存储池读带宽","ceph_pools.pool_wBandwidth":"存储池写带宽","ceph_pools.pool_IOPS":"存储池IOPS","ceph_status.use_percent":"集群空间使用率","ceph_status.cluster_rBandwidth":"集群读带宽","ceph_status.cluster_wBandwidth":"集群写带宽","ceph_status.cluster_IOPS":"集群IOPS"},meanValue:{mean:"平均值",max:"最大值",min:"最小值"},symbolValue:{ge:">=",le:"<="},options:[],value:"",unitoptuion:[{value:"mean",label:"平均值"},{value:"max",label:"最大值"},{value:"min",label:"最小值"}],unitvalue:"mean",operator:[{value:"ge",label:">="},{value:"le",label:"<="}],symbols:"ge",cycleoption:[{value:"100",label:"100s"},{value:"150",label:"150s"},{value:"200",label:"200s"}],cyclevalue:"100",leveloption:[{value:"critical",label:"严重"},{value:"moderate",label:"适中"},{value:"low",label:"低"}],levelvalue:"critical",resourceType:"",showlevel:!1}},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},closewaring:function(){this.showwarning=!1},validateinputValue:function(e,t,a){(""===t||null==t||isNaN(t))&&a(),t>=0&&t<=100?a():a(Error("请输入0-100的整数"))},validateNtework:function(e,t,a){(""===t||null==t||isNaN(t))&&a(),t>=0&&t<=102400?a():a(Error("请输入0-102400的整数"))},getlist:function(){var e=this;this.checkError(this.$http({url:e.common.formatMsg(this.api.alarmManage.getalarmRules,{id:e.template.id}),method:"get"}),function(t){e.tableData=t.data;for(var a=[],l=0;l<t.data.length;l++)a.push(t.data[l]);e.flagData=a})},deleteindex:function(e){this.tableData.splice(e,1)},addList:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a={name:e.value,statistic:e.unitvalue,operator:e.symbols,threshold:""+e.form.inputvalue,period:Number(e.cyclevalue),severity:e.levelvalue,id:"",tempId:e.template.id,alarmType:"threshold"};e.handleAddRule(a)}}),"physical"==this.resourceType||"virtual"==this.resourceType?this.value="cpu.usage_system":this.value="ceph_pools.use_percent",this.unitvalue="mean",this.symbols="ge",this.form.inputvalue="",this.cyclevalue="100",this.levelvalue="critical"},severityValueCompare:function(e,t){var a=[];"critical"==t.severity?a.push({level:3,value:t.threshold}):"moderate"==t.severity?a.push({level:2,value:t.threshold}):"low"==t.severity&&a.push({level:1,value:t.threshold});for(var l=0;l<e.length;l++)"critical"==e[l].severity?a.push({level:3,value:e[l].threshold}):"moderate"==e[l].severity?a.push({level:2,value:e[l].threshold}):"low"==e[l].severity&&a.push({level:1,value:e[l].threshold});if(a.sort(function(e,t){return t.level-e.level}),console.log(a),"ge"==t.operator){if(2==a.length)return a[0].value<a[1].value;if(3==a.length)return a[0].value<a[1].value&&a[1].value<a[2].value}else if("lt"==t.operator){if(2==a.length)return a[0].value>a[1].value;if(3==a.length)return a[0].value>a[1].value&&a[1].value>a[2].value}},handleAddRule:function(e){for(var t=this,a=[],l=0;l<this.tableData.length;l++){var s=this.tableData[l];s.name==e.name&&s.statistic==e.statistic&&s.operator==e.operator&&(s.currentIndex=l,a.push(s))}if(console.log(a.length),1==a.length)console.log(a[0].severity,e.severity),a[0].severity==e.severity?this.tableData.splice(a[0].currentIndex,1,e):(t.isSatisfy=this.severityValueCompare(a,e),t.isSatisfy?(this.showlevel=!0,setTimeout(function(){t.showlevel=!1},1e3)):this.tableData.push(e));else if(a.length>1){for(var o=!1,r=[],n=0;n<a.length;n++)if(a[n].severity==e.severity){o=!0,this.tableData.splice(a[n].currentIndex,1,e),r=[].concat(a);break}if(o){if(t.isSatisfy=this.severityValueCompare(r,e),t.isSatisfy){for(var i=0;i<this.tableData.lenth;i++)item.severity==e.severity&&item.name==e.name&&item.operator==e.operator&&item.statistic==e.statistic&&this.tableData.splice(i,1);this.tableData.push(e)}}else t.isSatisfy=this.severityValueCompare(a,e),t.isSatisfy&&this.tableData.push(e)}else 0===a.length&&this.tableData.push(e)},ensureSet:function(){var e=this;this.checkError(this.$http({url:e.common.formatMsg(e.api.alarmManage.getalarmRules,{id:e.template.id}),method:"put",data:{alarmrulesNow:this.tableData,alarmrulesEx:this.flagData}}),function(t){e.$notify({title:e.lang.common.success,type:"success",message:"设置成功！"}),e.closeModal(!0)})},getthresholdList:function(){var e=this;this.checkError(this.$http({url:this.api.alarmManage.getthresholdList+this.common.formatGetUrl({restype:this.resourceType}),method:"get"}),function(t){for(var a=[],l=0;l<t.data.length;l++)a.push({value:t.data[l].ruleKey,label:t.data[l].name});e.options=a,e.value=t.data[0].ruleKey})},initForm:function(){null!=this.$refs.form&&this.$refs.form.clearValidate(),this.resourceType=this.template.resourceType,this.getlist(),this.getthresholdList(),this.unitvalue="mean",this.symbols="ge",this.form.inputvalue="",this.cyclevalue="100",this.levelvalue="critical"}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.alarmManage.setalarmtemplateRules,width:"45%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[e.showwarning?a("div",{staticClass:"alarm-alert"},[a("el-button",{staticClass:"closebtn",attrs:{icon:"el-icon-close"},on:{click:e.closewaring}}),e._v(" "),a("div",{staticClass:"alert-wraning"},[e._v(e._s(e.lang.alarmManage.generateAlarm))])],1):e._e(),e._v(" "),a("el-table",{ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)",data:e.tableData}},[a("el-table-column",{attrs:{label:e.lang.alarmManage.rulesname},scopedSlots:e._u([{key:"default",fn:function(t){return["physical"==e.resourceType||"virtual"==e.resourceType?a("span",[e._v(e._s(e.rulesname[t.row.name]))]):e._e(),e._v(" "),"ceph"==e.resourceType?a("span",[e._v(e._s(e.cephrulesname[t.row.name]))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.alarmManage.sourceType},scopedSlots:e._u([{key:"default",fn:function(t){return["net.bytes_recv"==t.row.name||"net.bytes_sent"==t.row.name?a("span",[e._v(e._s(e.meanValue[t.row.statistic])+e._s(e.symbolValue[t.row.operator])+e._s(t.row.threshold)+"Mbit/s")]):e._e(),e._v(" "),"ceph_pools.pool_rBandwidth"==t.row.name||"ceph_pools.pool_wBandwidth"==t.row.name||"ceph_status.cluster_rBandwidth"==t.row.name||"ceph_status.cluster_wBandwidth"==t.row.name?a("span",[e._v(e._s(e.meanValue[t.row.statistic])+e._s(e.symbolValue[t.row.operator])+e._s(t.row.threshold)+"B/s")]):e._e(),e._v(" "),"ceph_pools.pool_IOPS"==t.row.name||"ceph_status.cluster_IOPS"==t.row.name?a("span",[e._v(e._s(e.meanValue[t.row.statistic])+e._s(e.symbolValue[t.row.operator])+e._s(t.row.threshold)+"op/s")]):e._e(),e._v(" "),"net.bytes_recv"!=t.row.name&&"net.bytes_sent"!=t.row.name&&"ceph_pools.pool_IOPS"!=t.row.name&&"ceph_status.cluster_IOPS"!=t.row.name&&"ceph_pools.pool_rBandwidth"!=t.row.name&&"ceph_pools.pool_wBandwidth"!=t.row.name&&"ceph_status.cluster_rBandwidth"!=t.row.name&&"ceph_status.cluster_wBandwidth"!=t.row.name?a("span",[e._v(e._s(e.meanValue[t.row.statistic])+e._s(e.symbolValue[t.row.operator])+e._s(t.row.threshold)+"%")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"period",label:e.lang.alarmManage.cycle},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.period)+"s")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.alarmManage.level},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.severityLever[t.row.severity]))])]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"el-icon-close",attrs:{circle:""},on:{click:function(a){return e.deleteindex(t.$index)}}})]}}])})],1),e._v(" "),a("el-form",{ref:"form",staticClass:"setingvalue",attrs:{"label-position":"right",model:e.form}},[a("el-row",{attrs:{type:"flex",justify:"left"}},[a("el-col",{staticStyle:{"margin-right":"5px"},attrs:{span:9}},[a("el-form-item",{attrs:{label:e.lang.alarmManage.yuvalue,"label-width":e.labelWidth}},[a("el-select",{attrs:{filterable:""},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-right":"5px"},attrs:{span:5}},[a("el-select",{attrs:{filterable:""},model:{value:e.unitvalue,callback:function(t){e.unitvalue=t},expression:"unitvalue"}},e._l(e.unitoptuion,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-right":"5px"},attrs:{span:3}},[a("el-select",{attrs:{filterable:""},model:{value:e.symbols,callback:function(t){e.symbols=t},expression:"symbols"}},e._l(e.operator,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),"net.bytes_recv"!=e.value&&"net.bytes_sent"!=e.value&&"ceph_pools.pool_IOPS"!=e.value&&"ceph_status.cluster_IOPS"!=e.value&&"ceph_pools.pool_rBandwidth"!=e.value&&"ceph_pools.pool_wBandwidth"!=e.value&&"ceph_status.cluster_rBandwidth"!=e.value&&"ceph_status.cluster_wBandwidth"!=e.value?a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{prop:"inputvalue",rules:[{required:!0,message:"必填项",trigger:"blur"},{validator:this.validateinputValue,trigger:"blur"},{validator:this.common.validateIntegerType,message:"请输入数字",trigger:"blur"}]}},[a("el-input",{nativeOn:{mousewheel:function(e){e.preventDefault()}},model:{value:e.form.inputvalue,callback:function(t){e.$set(e.form,"inputvalue",e._n(t))},expression:"form.inputvalue"}},[a("template",{slot:"append"},[e._v("%")])],2)],1)],1):e._e(),e._v(" "),"net.bytes_recv"==e.value||"net.bytes_sent"==e.value?a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{prop:"inputvalue",rules:[{required:!0,message:"必填项",trigger:"blur"},{validator:this.validateNtework,trigger:"blur"},{validator:this.common.validateIntegerType,message:"请输入数字",trigger:"blur"}]}},[a("el-input",{nativeOn:{mousewheel:function(e){e.preventDefault()}},model:{value:e.form.inputvalue,callback:function(t){e.$set(e.form,"inputvalue",e._n(t))},expression:"form.inputvalue"}},[a("template",{slot:"append"},[e._v("Mbit/s")])],2)],1)],1):e._e(),e._v(" "),"ceph_pools.pool_IOPS"==e.value||"ceph_status.cluster_IOPS"==e.value?a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{prop:"inputvalue",rules:[{required:!0,message:"必填项",trigger:"blur"}]}},[a("el-input",{nativeOn:{mousewheel:function(e){e.preventDefault()}},model:{value:e.form.inputvalue,callback:function(t){e.$set(e.form,"inputvalue",t)},expression:"form.inputvalue"}},[a("template",{slot:"append"},[e._v("op/s")])],2)],1)],1):e._e(),e._v(" "),"ceph_pools.pool_rBandwidth"==e.value||"ceph_pools.pool_wBandwidth"==e.value||"ceph_status.cluster_rBandwidth"==e.value||"ceph_status.cluster_wBandwidth"==e.value?a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{prop:"inputvalue",rules:[{required:!0,message:"必填项",trigger:"blur"}]}},[a("el-input",{nativeOn:{mousewheel:function(e){e.preventDefault()}},model:{value:e.form.inputvalue,callback:function(t){e.$set(e.form,"inputvalue",t)},expression:"form.inputvalue"}},[a("template",{slot:"append"},[e._v("B/s")])],2)],1)],1):e._e()],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"left"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.lang.alarmManage.cycle,"label-width":e.labelWidth}},[a("el-select",{attrs:{filterable:""},model:{value:e.cyclevalue,callback:function(t){e.cyclevalue=t},expression:"cyclevalue"}},e._l(e.cycleoption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"left"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.lang.alarmManage.level,"label-width":e.labelWidth}},[a("el-select",{attrs:{filterable:""},model:{value:e.levelvalue,callback:function(t){e.levelvalue=t},expression:"levelvalue"}},e._l(e.leveloption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"left"}},[a("el-col",{attrs:{span:11,offset:3}},[a("el-button",{attrs:{type:"text"},on:{click:e.addList}},[e._v("添加新规则\n                ")])],1)],1),e._v(" "),a("el-row",[a("el-col",[e.showlevel&&"ceph"!=e.resourceType?a("span",{staticStyle:{color:"red"}},[e._v(e._s(e.rulesname[e.value])+"不同告警级别之间告警值有冲突,请重新设值")]):e._e(),e._v(" "),e.showlevel&&"ceph"==e.resourceType?a("span",{staticStyle:{color:"red"}},[e._v(e._s(e.cephrulesname[e.value])+"不同告警级别之间告警值有冲突,请重新设值")]):e._e()])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.ensureSet}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var v=a("C7Lr")(h,d,!1,function(e){a("T/Gp")},"data-v-2c91f9c8",null).exports,f={components:{"pana-breadcrumb":l.a,"pana-createtemplate":r,"pana-deletetemplate":u,"pana-edittemplate":m,"pana-settemplaterules":v},data:function(){return{tableData:[],pageNum:1,pageSize:10,showCreate:!1,showDelete:!1,showEdite:!1,showSet:!1,setTemplaterules:null,deleteIds:[],editTemplatename:null,resourceType:{physical:"物理主机",ceph:"ceph",computeha:"高可用",hardware:"硬件故障",ceph_check:"ceph健康检查",planwork:"计划任务",virtual:"云组件"}}},methods:{gettemplateList:function(){var e=this;this.checkError(this.$http({url:this.api.alarmManage.getalarmTemplate,method:"get"}),function(t){e.tableData=t.data})},pageSelect:function(e){this.pageNum=e},sortChange:function(e){var t=null==e.order?0:"ascending"===e.order?1:-1;this.tableData=this.tableData.sort(function(a,l){return(a[e.prop]>l[e.prop]?1:-1)*t})},closeCreate:function(e){1==e&&this.gettemplateList(),this.showCreate=!1},selectids:function(e){var t=[];e.forEach(function(e){t.push(e.id)}),this.deleteIds=t},closeDalete:function(e){var t=this,a=[];this.showDelete=!1,!0===e&&(a=this.deleteIds,this.checkError(this.$http({url:this.api.alarmManage.getalarmTemplate+this.common.formatGetUrl({ids:a}),method:"delete"}),function(e){t.$notify({title:t.lang.common.success,type:"success",message:"删除成功"}),t.gettemplateList()}))},editTemplate:function(e){this.showEdite=!0,this.editTemplatename=e},closeEdit:function(e){1==e&&this.gettemplateList(),this.showEdite=!1},setTemplate:function(e){this.showSet=!0,this.setTemplaterules=e},closeSet:function(e){1==e&&this.gettemplateList(),this.showSet=!1}},computed:{filterData:function(){var e=this.search,t=[];return t=""===e?this.tableData:this.common.cloudFilter(this.tableData,e),t},pagedData:function(){return this.filterData.length<=this.pageSize?this.filterData:this.common.pagination(this.filterData,this.pageSize,this.pageNum)}},watch:{search:function(){this.pageNum=1}},mounted:function(){this.gettemplateList()}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{type:"flex",direction:"vertical"}},[a("pana-breadcrumb"),e._v(" "),a("el-main",[a("el-row",{staticClass:"pana-btn-group",attrs:{type:"flex",justify:"space-between"}},[a("el-col",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showCreate=!0}}},[e._v(e._s(e.lang.common.create))]),e._v(" "),a("el-button",{attrs:{disabled:0==e.deleteIds.length},on:{click:function(t){e.showDelete=!0}}},[e._v(e._s(e.lang.common.delete))])],1)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)",data:e.pagedData},on:{"selection-change":e.selectids,"sort-change":e.sortChange}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:e.lang.alarmManage.templateName,sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"resourceType",label:e.lang.alarmManage.sourceType,sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.resourceType[t.row.resourceType]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.alarmManage.operate},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editTemplate(t.row)}}},[e._v("\n                        "+e._s(e.lang.common.edit)+"\n                    ")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.setTemplate(t.row)}}},[e._v("\n                        "+e._s(e.lang.alarmManage.setRules)+"\n                    ")])]}}])})],1),e._v(" "),a("el-row",{staticClass:"row-bg pana-pagination-row",attrs:{type:"flex",justify:"end"}},[e.filterData.length>e.pageSize?a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","prev-text":e.lang.common.prevPage,"next-text":e.lang.common.nextPage,total:e.filterData.length,"current-page":e.pageNum},on:{"current-change":e.pageSelect}}):e._e()],1)],1),e._v(" "),a("pana-createtemplate",{attrs:{show:e.showCreate},on:{closeModal:e.closeCreate}}),e._v(" "),a("pana-deletetemplate",{attrs:{show:e.showDelete},on:{closeModal:e.closeDalete}}),e._v(" "),a("pana-edittemplate",{attrs:{show:e.showEdite,listdata:e.tableData,template:e.editTemplatename},on:{closeModal:e.closeEdit}}),e._v(" "),a("pana-settemplaterules",{attrs:{show:e.showSet,template:e.setTemplaterules},on:{closeModal:e.closeSet}})],1)},staticRenderFns:[]};var _=a("C7Lr")(f,g,!1,function(e){a("TSVN")},"data-v-5090d450",null);t.default=_.exports},"8HwQ":function(e,t){},LNH0:function(e,t){},"T/Gp":function(e,t){},TSVN:function(e,t){}});