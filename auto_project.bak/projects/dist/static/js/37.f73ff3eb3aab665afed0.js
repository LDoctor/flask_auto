webpackJsonp([37],{"249g":function(e,t){},Agjy:function(e,t){},Feis:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("ZLEe"),o=a.n(i),l=a("1JPr"),s=a("aA9S"),r=a.n(s),n={props:{show:Boolean,id:String},data:function(){return{data:{},loading:!0}},methods:{get_detail:function(){var e=this,t=this.common.formatMsg(this.api.cloud.get_image_detail,{id:e.id});this.loading=!0,this.checkError(this.$http({url:t,method:"get"}),function(t){e.data=t.data,e.loading=!1},function(){e.loading=!1})},initForm:function(){this.get_detail()},closeModal:function(){r()(this.$data,this.$options.data.call(this)),this.$emit("closeModal")},formatCapacity:function(e){var t=this.common.formatCapacity(e,"GB",2);return t.value+t.unit}},computed:{qemu_guest_agent:function(){var e=this.data,t=this.lang;return"hw_qemu_guest_agent"in e&&!0===e.hw_qemu_guest_agent?t.common.enable:t.common.close},vif_multiqueue_enabled:function(){var e=this.data,t=this.lang;return"hw_vif_multiqueue_enabled"in e&&!0===e.hw_vif_multiqueue_enabled?t.common.enable:t.common.close}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.imageManage.detail,visible:e.show,modal:!0,top:"8vh",width:"40%"},on:{open:e.initForm,close:e.closeModal}},[a("div",{staticClass:"cloud-detail-modal cloud-detail"},[a("table",[a("tr",[a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.imageName))]),e._v(" "),a("td",[e._v(e._s(e.data.name))]),e._v(" "),a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.create_time))]),e._v(" "),a("td",[e._v(e._s(e._f("utc2beijing")(e.data.created_at)))])]),e._v(" "),a("tr",[a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.status))]),e._v(" "),a("td",[e._v(e._s(e.lang.imageManage.statusArray[e.data.status]))]),e._v(" "),a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.update_time))]),e._v(" "),a("td",[e._v(e._s(e._f("utc2beijing")(e.data.updated_at)))])]),e._v(" "),a("tr",[a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.disk))]),e._v(" "),a("td",{domProps:{innerHTML:e._s(e.data.min_disk)}}),e._v(" "),a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.type))]),e._v(" "),a("td",[e._v(e._s(e.data.os_type?e.data.os_type:"--"))])]),e._v(" "),a("tr",[a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.osType))]),e._v(" "),a("td",{domProps:{innerHTML:e._s(e.data.os_distro?e.data.os_distro:"--")}}),e._v(" "),a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.public))]),e._v(" "),a("td",[e._v(e._s("public"==e.data.visibility?e.lang.imageManage.yes:e.lang.imageManage.no))])]),e._v(" "),a("tr",[a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.osArch))]),e._v(" "),a("td",[e._v(e._s(e.data.architecture?e.data.architecture:"--"))]),e._v(" "),a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.imageSize))]),e._v(" "),a("td",[e._v(e._s(e.formatCapacity(e.data.size)))])]),e._v(" "),a("tr",[a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.hw_disk_bus))]),e._v(" "),a("td",[e._v(e._s(e.data.hw_disk_bus?e.data.hw_disk_bus:"--"))]),e._v(" "),a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.hw_vif_model))]),e._v(" "),a("td",[e._v(e._s(e.data.hw_vif_model?e.data.hw_vif_model:"--"))])]),e._v(" "),a("tr",[a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.hw_vif_multiqueue))]),e._v(" "),a("td",[e._v(e._s(e.vif_multiqueue_enabled))]),e._v(" "),a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.hw_video_model))]),e._v(" "),a("td",[e._v(e._s(e.data.hw_video_model?e.data.hw_video_model:"--"))])]),e._v(" "),a("tr",[a("td",{staticClass:"cloud-label"},[e._v(e._s(e.lang.imageManage.hw_qemu_guest_agent))]),e._v(" "),a("td",[e._v(e._s(e.qemu_guest_agent))]),e._v(" "),a("td",{staticClass:"cloud-label"}),e._v(" "),a("td")])])]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.closeModal}},[e._v(e._s(e.lang.common.close))])],1)])},staticRenderFns:[]};var m=a("C7Lr")(n,c,!1,function(e){a("Agjy")},null,null).exports,d={props:{show:Boolean,id:String,osArchOptions:Array,osTypeOptions:Array,publicShow:Boolean},data:function(){return{busTypeList:[{id:"virtio",name:"virtio"},{id:"scsi",name:"scsi"},{id:"ide",name:"ide"}],vifModelList:[{id:"virtio",name:"virtio"},{id:"e1000",name:"e1000"},{id:"rtl8139",name:"rtl8139"}],videoModelList:[{id:"vga",name:"vga"},{id:"qxl",name:"qxl"}],advancedOptions:!1,form:{},rules:{name:[{required:!0,message:"请输入镜像名称",trigger:"blur"},{min:1,max:30,message:this.lang.common.validateLength30,trigger:"blur"},{validator:this.common.validateName3,trigger:"blur"}],min_disk:[{required:!0,message:this.lang.common.validateNumber,trigger:"blur"},{min:1,max:200,type:"integer",message:"请输入1~200的整数",trigger:"blur"}]},loading:!1}},methods:{initForm:function(){this.$refs.form&&this.$refs.form.resetFields(),this.get_detail()},advancedOptionsChange:function(){this.advancedOptions=!this.advancedOptions},get_detail:function(){var e=this,t=this.common.formatMsg(this.api.cloud.get_image_detail,{id:e.id});this.loading=!0,this.checkError(this.$http({url:t,method:"get"}),function(t){e.form=t.data,e.form.min_disk=parseInt(e.form.min_disk),e.form.hw_disk_bus=e.form.hw_disk_bus||"virtio",e.form.hw_vif_model=e.form.hw_vif_model||"virtio",e.form.hw_vif_multiqueue_enabled=e.form.hw_vif_multiqueue_enabled||!1,e.form.hw_video_model=e.form.hw_video_model||"vga",e.form.hw_qemu_guest_agent=e.form.hw_qemu_guest_agent||!1,e.form.hw_scsi_model=e.form.hw_scsi_model||!1,e.loading=!1},function(){e.loading=!1})},updateImage:function(){var e=this,t=this;this.$refs.form.validate(function(a){if(!a)return!1;var i=e.common.formatMsg(e.api.cloud.get_image_detail,{id:e.form.id}),o=e.form;"virtio"!==o.hw_disk_bus&&delete o.hw_scsi_model,"virtio"!==o.hw_vif_model&&delete o.hw_vif_multiqueue_enabled,t.closeModal(),e.checkError(e.$http({url:i,method:"put",data:o}),function(e){t.$emit("getList"),t.$notify({title:t.lang.common.success,type:"success",message:t.lang.resource.editImageSuccess})})})},closeModal:function(){r()(this.$data,this.$options.data.call(this)),this.$emit("closeModal")}},computed:{operateSystems:function(){var e=[],t=this.form.os_type;return this.osTypeOptions.forEach(function(a){a.value==t&&(e=a.os)}),-1===e.indexOf(this.form.os_distro)&&(this.form.os_distro=e[0]),e}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.imageManage.update,visible:e.show,modal:!0,top:"8vh",width:"40%"},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,"label-width":"130px",rules:e.rules,"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)"}},[a("el-form-item",{attrs:{label:e.lang.imageManage.imageName,prop:"name"}},[a("el-input",{attrs:{placeholder:e.lang.imageManage.imageNamePlaceholder},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"==typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.imageManage.osArch}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.architecture,callback:function(t){e.$set(e.form,"architecture",t)},expression:"form.architecture"}},e._l(e.osArchOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.text,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.imageManage.osSystem}},[a("el-col",{attrs:{span:11}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.os_type,callback:function(t){e.$set(e.form,"os_type",t)},expression:"form.os_type"}},e._l(e.osTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.text,value:e.value}})}),1)],1),e._v(" "),a("el-col",{staticClass:"line",attrs:{span:1}},[e._v(" ")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.os_distro,callback:function(t){e.$set(e.form,"os_distro",t)},expression:"form.os_distro"}},e._l(e.operateSystems,function(e,t){return a("el-option",{key:t,attrs:{value:e}})}),1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.imageManage.disk,prop:"min_disk"}},[a("el-input",{attrs:{placeholder:e.lang.imageManage.diskPlaceholder},model:{value:e.form.min_disk,callback:function(t){e.$set(e.form,"min_disk",e._n(t))},expression:"form.min_disk"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"",prop:"visibility"}},[a("el-radio-group",{model:{value:e.form.visibility,callback:function(t){e.$set(e.form,"visibility",t)},expression:"form.visibility"}},[a("el-radio",{attrs:{label:"public",disabled:!e.publicShow}},[e._v(e._s(e.lang.imageManage.public))]),e._v(" "),a("el-radio",{attrs:{label:"private"}},[e._v(e._s(e.lang.imageManage.private))])],1)],1),e._v(" "),a("el-form-item",{class:{"cloud-expand-icon":e.advancedOptions}},[a("el-button",{attrs:{type:"text"},on:{click:e.advancedOptionsChange}},[e._v("\n                "+e._s(e.lang.volume.advancedOptions)+"\n                "),a("i",{staticClass:"fa fa-angle-double-right",attrs:{"aria-hidden":"true"}})])],1),e._v(" "),e.advancedOptions?a("div",[a("el-form-item",{attrs:{label:e.lang.imageManage.disk_bus}},[a("el-select",{staticStyle:{"margin-left":"0"},attrs:{filterable:""},model:{value:e.form.hw_disk_bus,callback:function(t){e.$set(e.form,"hw_disk_bus",t)},expression:"form.hw_disk_bus"}},e._l(e.busTypeList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.imageManage.vif_model}},[a("el-select",{staticStyle:{"margin-left":"0"},attrs:{filterable:""},model:{value:e.form.hw_vif_model,callback:function(t){e.$set(e.form,"hw_vif_model",t)},expression:"form.hw_vif_model"}},e._l(e.vifModelList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),"virtio"===e.form.hw_vif_model?a("el-form-item",{attrs:{label:e.lang.imageManage.vif_multiqueue}},[a("el-radio-group",{model:{value:e.form.hw_vif_multiqueue_enabled,callback:function(t){e.$set(e.form,"hw_vif_multiqueue_enabled",t)},expression:"form.hw_vif_multiqueue_enabled"}},[a("el-radio",{attrs:{label:!0}},[e._v(e._s(e.lang.imageManage.enable))]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v(e._s(e.lang.imageManage.disable))])],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:e.lang.imageManage.video_model}},[a("el-select",{staticStyle:{"margin-left":"0"},attrs:{filterable:""},model:{value:e.form.hw_video_model,callback:function(t){e.$set(e.form,"hw_video_model",t)},expression:"form.hw_video_model"}},e._l(e.videoModelList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:e.lang.imageManage.qemu_guest_agent}},[a("el-radio-group",{model:{value:e.form.hw_qemu_guest_agent,callback:function(t){e.$set(e.form,"hw_qemu_guest_agent",t)},expression:"form.hw_qemu_guest_agent"}},[a("el-radio",{attrs:{label:!0}},[e._v(e._s(e.lang.imageManage.enable))]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v(e._s(e.lang.imageManage.disable))])],1)],1),e._v(" "),"virtio"===e.form.hw_disk_bus?a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:e.lang.imageManage.scsi_model}},[a("el-radio-group",{model:{value:e.form.hw_scsi_model,callback:function(t){e.$set(e.form,"hw_scsi_model",t)},expression:"form.hw_scsi_model"}},[a("el-radio",{attrs:{label:!0}},[e._v(e._s(e.lang.imageManage.enable))]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v(e._s(e.lang.imageManage.disable))])],1)],1):e._e()],1):e._e()],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.updateImage}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var u=a("C7Lr")(d,g,!1,function(e){a("249g")},"data-v-a28688ba",null).exports,_={data:function(){var e=this;return{sortOrder:0,sortProp:"",validImageType:["iso","raw","qcow2"],createConfirmDialogVisible:!1,showEdit:!1,loading:!0,progress:0,visibility:"",id:"",detailDialogVisible:!1,file:"",imageSource:"0",tableData:[],multipleSelection:[],search:"",pageNum:1,pageSize:10,createDialogVisible:!1,createImageForm:{name:"",disk_format:"qcow2",arch:"x86_64",os_type:"windows",os_distro:"Windows7",min_disk:"",visibility:"public",fileName:"",file_path:""},imageSourceOptions:[{value:"0",text:"本地"},{value:"1",text:"http上传"}],imageFormatOptions:[{value:"raw",text:"raw"},{value:"qcow2",text:"qcow2"},{value:"iso",text:"iso"}],osArchOptions:[{value:"i686",text:"i686"},{value:"x86_64",text:"x86_64"}],osTypeOptions:[{value:"windows",text:"Windows",os:["Windows7","Windows7 X64","Windows8","Windows8 X64","Windows Server 2012","Windows Server 2008","Windows Server 2008 X64","Windows Server 2008 R2 X64","Windows Server 2003 Standard","Windows Server 2003 Enterprise","Windows Server 2003 Enterprise X64"]},{value:"Linux",text:"Linux",os:["CentOS","CentOS X64","Ubuntu","Ubuntu X64","Fedora","Fedora X64","Debian","Debian X64","Red Hat Enterprise Linux 6","Red Hat Enterprise Linux 6 X64","Red Hat Enterprise Linux 7","Red Hat Enterprise Linux 7 X64","SUSE Linux Enterprise","SUSE Linux Enterprise  X64","cirros"]}],deleteDialogVisible:!1,deleteItem:"",publicShow:!0,rules:{name:[{required:!0,message:"请输入镜像名称",trigger:"blur"},{min:1,max:30,message:this.lang.common.validateLength30,trigger:"blur"},{validator:this.common.validateName3,trigger:"blur"}],min_disk:[{required:!0,message:this.lang.common.validateNumber,trigger:"blur"},{min:1,max:200,type:"integer",message:"请输入1~200的整数",trigger:"blur"}],fileName:[{required:!0,message:"请选择镜像文件",trigger:"change"},{validator:function(t,a,i){var o=e.createImageForm.fileName.lastIndexOf("."),l=e.createImageForm.fileName.substring(o+1);e.fileSize>e.common.switchCapacity(10,"GB","B")?i(new Error("文件大小不能超过10GB")):-1===e.validImageType.indexOf(l)?i(new Error(e.lang.imageManage.invalidImageType)):i()},trigger:"blur"}],file_path:[{required:!0,message:"请输入镜像地址",trigger:"change"}]}}},mounted:function(){var e=this;this.getList(),this.permitionManage(),this.$ws.setCallback(function(t){var a=e.wsEventQueue.indexOf(t.resource_id);if(-1!==a){var i=t.event_type.split(".");if("image"===i[0]&&"update"===i[1]&&"active"===t.payload.status&&e.getList(),t.resource_id===sessionStorage.getItem("time")){var o=t.payload.data.speed+"%";document.querySelector("#createProgress .el-progress-bar__inner").style.width=o,document.querySelector("#createProgress .el-progress__text").innerHTML=o,"100%"===o&&(e.createProcessNotify.close(),e.wsEventQueue.splice(a,1),e.getList())}}})},components:{panaBreadcrumb:l.a,imageDetail:m,edit:u},methods:{closeEdit:function(){this.showEdit=!1},closeDetail:function(){this.detailDialogVisible=!1},permitionManage:function(){var e=this,t=JSON.parse(sessionStorage.getItem("panaCurrentPool"));this.common.is_system_admin()||(e.publicShow=!0,this.common.permissionManage(e,t.id,function(){e.publicShow=!1,e.createImageForm.visibility="private"}))},sort:function(e){var t=null==e.order?0:"ascending"===e.order?1:-1;this.sortProp=e.prop,this.sortOrder=t,this.tableData=this.tableData.sort(function(a,i){return a[e.prop]=null==a[e.prop]?"":a[e.prop],i[e.prop]=null==i[e.prop]?"":i[e.prop],a[e.prop]==i[e.prop]?i.created_at-a.created_at:(a[e.prop]>i[e.prop]?1:-1)*t})},createDialogShow:function(){this.$refs.createImageForm&&this.$refs.createImageForm.resetFields(),this.createDialogVisible=!0},statusClass:function(e){switch(e){case"active":return"cloud-success";case"killed":case"deactivated":return"cloud-error";case"deleted":case"pending_delete":return"cloud-warning";default:return"cloud-info"}},handleEdit:function(e,t){this.showEdit=!0,this.id=t.id},showDetail:function(e){this.id=e,this.detailDialogVisible=!0},getList:function(){var e=this;this.checkError(this.$http({url:this.api.cloud.get_images_list,method:"get"}),function(t){e.loading=!1,e.tableData=t.data,e.tableData=e.tableData.filter(function(e){return-1===e.tags.indexOf("storage_gateway")})},function(){e.loading=!1})},uploadFile:function(e){this.file=e.file},createConfirm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.createConfirmDialogVisible=!0})},createImage:function(e){var t=this,a=this;this.createDialogVisible=!1,this.createConfirmDialogVisible=!1;var i=new FormData;"0"===this.imageSource?(this.api.cloud.post_images_upload,o()(this.createImageForm).forEach(function(e){"fileName"!==e&&i.append(e,t.createImageForm[e])}),i.append("file",this.file),this.createProcessNotify=this.$notify({title:a.common.formatMsg(a.lang.imageManage.createProgressTile,{name:a.createImageForm.name}),dangerouslyUseHTMLString:!0,duration:0,showClose:!1,message:'<div role="progressbar" id="createProgress" style="width: 300px;" aria-valuenow="" aria-valuemin="0" aria-valuemax="100"\n             class="el-progress el-progress--line">\n            <div class="el-progress-bar">\n                <div class="el-progress-bar__outer" style="height: 8px;">\n                    <div class="el-progress-bar__inner">\x3c!----\x3e</div>\n                </div>\n            </div>\n            <div class="el-progress__text" style="font-size: 14.4px;"></div>\n        </div>'}),this.checkError(this.$http({url:this.api.cloud.post_images_upload,method:"post",data:i,headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){if(e.lengthComputable){var t=(e.loaded/e.total*100|0)+"%";document.querySelector("#createProgress .el-progress-bar__inner").style.width=t,document.querySelector("#createProgress .el-progress__text").innerHTML=t,"100%"===t&&a.createProcessNotify.close()}}}),function(e){var t=a.common.formatMsg(a.lang.imageManage.saving,{name:e.data.name});a.getList(),a.wsEventQueue.push(e.data.id),a.$notify({title:a.lang.common.success,type:"success",message:t})},function(){a.createProcessNotify.close()})):(sessionStorage.setItem("time",(new Date).getTime()),this.api.cloud.post_http_upload,o()(this.createImageForm).forEach(function(e){"fileName"!==e&&i.append(e,t.createImageForm[e])}),i.append("time",sessionStorage.getItem("time")),this.createProcessNotify=this.$notify({title:a.common.formatMsg(a.lang.imageManage.createProgressTile,{name:a.createImageForm.name}),dangerouslyUseHTMLString:!0,duration:0,showClose:!1,message:'<div role="progressbar" id="createProgress" style="width: 300px;" aria-valuenow="" aria-valuemin="0" aria-valuemax="100"\n             class="el-progress el-progress--line">\n            <div class="el-progress-bar">\n                <div class="el-progress-bar__outer" style="height: 8px;">\n                    <div class="el-progress-bar__inner">\x3c!----\x3e</div>\n                </div>\n            </div>\n            <div class="el-progress__text" style="font-size: 14.4px;"></div>\n        </div>'}),a.wsEventQueue.push(sessionStorage.getItem("time")),this.checkError(this.$http({url:this.api.cloud.post_http_upload,method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}}),function(e){var t=a.common.formatMsg(a.lang.imageManage.saving,{name:e.data.name});a.getList(),a.wsEventQueue.push(e.data.id),a.$notify({title:a.lang.common.success,type:"success",message:t})},function(){a.createProcessNotify.close()})),e&&window.open(location.href,"_blank")},pageSelect:function(e){this.pageNum=e},handleChange:function(e){this.createImageForm.fileName=e.name,this.fileSize=e.size},handleSelectionChange:function(e){this.multipleSelection=e},deleteConfirm:function(e){this.deleteDialogVisible=!0,this.deleteItem="","string"==typeof e&&(this.deleteItem=e)},deleteMethod:function(){this.deleteDialogVisible=!1;var e=this,t=[];this.deleteItem?t.push(this.deleteItem):this.multipleSelection.forEach(function(e){t.push(e.id)}),this.checkError(this.$http({url:this.api.cloud.delete_images,method:"post",data:{ids:t}}),function(t){e.getList(),e.$notify({title:e.lang.common.success,type:"success",message:e.lang.resource.deleteImageSuccess})})}},computed:{filterData:function(){var e=this.search,t=this,a=[];return a=""===e?this.tableData:this.common.cloudFilter(this.tableData,e),a.sort(function(e,a){return e[t.sortProp]=null==e[t.sortProp]?"":e[t.sortProp],a[t.sortProp]=null==a[t.sortProp]?"":a[t.sortProp],e[t.sortProp]==a[t.sortProp]?a.created_at-e.created_at:(e[t.sortProp]>a[t.sortProp]?1:-1)*t.sortOrder})},pagedData:function(){return this.filterData.length<=this.pageSize?this.filterData:this.common.pagination(this.filterData,this.pageSize,this.pageNum)},operateSystems:function(){var e=[],t=this.createImageForm.os_type;return this.osTypeOptions.forEach(function(a){a.value==t&&(e=a.os)}),this.createImageForm.os_distro=e[0],e}},watch:{search:function(){this.pageNum=1}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"col mainDiv",attrs:{id:"image-list"}},[a("pana-breadcrumb",{attrs:{changePool:!0,callback:[e.getList,e.permitionManage]}}),e._v(" "),a("el-main",[a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:e.createDialogShow}},[e._v(e._s(e.lang.imageManage.create))]),e._v(" "),a("el-button",{attrs:{disabled:e.multipleSelection.length<=0},on:{click:e.deleteConfirm}},[e._v(e._s(e.lang.common.delete)+"\n\t\t\t\t\t")])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-row",{staticClass:"search-row",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:22}},[a("el-input",{attrs:{placeholder:e.lang.common.search,"suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"fa fa-refresh",attrs:{type:"text",circle:""},on:{click:e.getList}})],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)",data:e.pagedData},on:{"sort-change":e.sort,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"custom",prop:"name",label:e.lang.imageManage.name},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"name",on:{click:function(a){return e.showDetail(t.row.id)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{sortable:"custom",prop:"os_distro",label:e.lang.imageManage.imageType}}),e._v(" "),a("el-table-column",{attrs:{sortable:"custom",prop:"status",label:e.lang.common.status},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"status",class:e.statusClass(t.row.status)},[e._v(e._s(e.lang.imageManage.statusArray[t.row.status]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{sortable:"custom",prop:"visibility",label:e.lang.imageManage.public},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t"+e._s("public"===t.row.visibility?e.lang.imageManage.yes:e.lang.imageManage.no)+"\n\t\t\t\t\t")]}}])}),e._v(" "),a("el-table-column",{attrs:{sortable:"custom",prop:"disk_format",label:e.lang.imageManage.diskFormat}}),e._v(" "),a("el-table-column",{attrs:{sortable:"custom",prop:"size",label:e.lang.imageManage.size},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t"+e._s(e.common.formatCapacity(t.row.size,"B",2).value+e.common.formatCapacity(t.row.size,"B",2).unit)+"\n\t\t\t\t\t")]}}])}),e._v(" "),a("el-table-column",{attrs:{sortable:"custom",prop:"created_at",label:e.lang.common.create_time},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t"+e._s(e._f("utc2beijing")(t.row.created_at))+"\n\t\t\t\t\t")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.common.operation},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v(e._s(e.lang.common.update)+"\n\t\t\t\t\t\t")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.deleteConfirm(t.row.id)}}},[e._v(e._s(e.lang.common.delete)+"\n\t\t\t\t\t\t")])]}}])})],1),e._v(" "),a("el-row",{staticClass:"row-bg pana-pagination-row",attrs:{type:"flex",justify:"end"}},[e.filterData.length>e.pageSize?a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","prev-text":e.lang.common.prevPage,"next-text":e.lang.common.nextPage,"current-page":e.pageNum,total:e.filterData.length},on:{"current-change":e.pageSelect}}):e._e()],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.lang.imageManage.createImage,visible:e.createDialogVisible,top:"8vh",width:"35%"},on:{"update:visible":function(t){e.createDialogVisible=t}}},[a("el-form",{ref:"createImageForm",attrs:{model:e.createImageForm,"label-width":"100px",rules:e.rules}},[a("el-form-item",{attrs:{label:e.lang.imageManage.imageName,prop:"name"}},[a("el-input",{attrs:{placeholder:e.lang.imageManage.imageNamePlaceholder},model:{value:e.createImageForm.name,callback:function(t){e.$set(e.createImageForm,"name","string"==typeof t?t.trim():t)},expression:"createImageForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.imageManage.imageSource,prop:"imageSource"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.imageSource,callback:function(t){e.imageSource=t},expression:"imageSource"}},e._l(e.imageSourceOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.text,value:e.value}})}),1)],1),e._v(" "),"0"===e.imageSource?a("el-form-item",{staticClass:"image-file",attrs:{label:e.lang.imageManage.imageFile,prop:"fileName"}},[a("el-upload",{attrs:{action:"","on-change":e.handleChange,"http-request":e.uploadFile,"show-file-list":!1}},[a("el-input",{attrs:{placeholder:""},model:{value:e.createImageForm.fileName,callback:function(t){e.$set(e.createImageForm,"fileName",t)},expression:"createImageForm.fileName"}},[a("template",{slot:"append"},[e._v(e._s(e.lang.imageManage.selectFile))])],2)],1),e._v(" "),a("span",{staticClass:"image-file-tip"},[e._v(e._s(e.lang.imageManage.imageFileTip))])],1):e._e(),e._v(" "),"1"===e.imageSource?a("el-form-item",{attrs:{prop:"file_path",label:e.lang.imageManage.copyAddress}},[a("el-input",{attrs:{placeholder:e.lang.imageManage.copyAddressPlaceholder},model:{value:e.createImageForm.file_path,callback:function(t){e.$set(e.createImageForm,"file_path",t)},expression:"createImageForm.file_path"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:e.lang.imageManage.diskFormat,prop:"disk_format"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.createImageForm.disk_format,callback:function(t){e.$set(e.createImageForm,"disk_format",t)},expression:"createImageForm.disk_format"}},e._l(e.imageFormatOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.text,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.imageManage.osArch,prop:"arch"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.createImageForm.arch,callback:function(t){e.$set(e.createImageForm,"arch",t)},expression:"createImageForm.arch"}},e._l(e.osArchOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.text,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.imageManage.osSystem,prop:"os_type"}},[a("el-col",{attrs:{span:11}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.createImageForm.os_type,callback:function(t){e.$set(e.createImageForm,"os_type",t)},expression:"createImageForm.os_type"}},e._l(e.osTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.text,value:e.value}})}),1)],1),e._v(" "),a("el-col",{staticClass:"line",attrs:{span:1}},[e._v(" ")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.createImageForm.os_distro,callback:function(t){e.$set(e.createImageForm,"os_distro",t)},expression:"createImageForm.os_distro"}},e._l(e.operateSystems,function(e,t){return a("el-option",{key:t,attrs:{value:e}})}),1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.imageManage.disk,prop:"min_disk"}},[a("el-input",{attrs:{type:"number",placeholder:e.lang.imageManage.diskPlaceholder},nativeOn:{mousewheel:function(e){e.preventDefault()}},model:{value:e.createImageForm.min_disk,callback:function(t){e.$set(e.createImageForm,"min_disk",e._n(t))},expression:"createImageForm.min_disk"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"",prop:"visibility"}},[a("el-radio-group",{model:{value:e.createImageForm.visibility,callback:function(t){e.$set(e.createImageForm,"visibility",t)},expression:"createImageForm.visibility"}},[e.publicShow?a("el-radio",{attrs:{label:"public"}},[e._v(e._s(e.lang.imageManage.public))]):e._e(),e._v(" "),a("el-radio",{attrs:{label:"private"}},[e._v(e._s(e.lang.imageManage.private))])],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.createDialogVisible=!1}}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.createConfirm("createImageForm")}}},[e._v(e._s(e.lang.common.confirm))])],1)],1),e._v(" "),a("edit",{attrs:{show:e.showEdit,id:e.id,publicShow:e.publicShow,osArchOptions:e.osArchOptions,osTypeOptions:e.osTypeOptions},on:{getList:e.getList,closeModal:e.closeEdit}}),e._v(" "),a("el-dialog",{staticClass:"cloud-tipDialog",attrs:{title:e.lang.imageManage.tip,visible:e.deleteDialogVisible,width:"35%"},on:{"update:visible":function(t){e.deleteDialogVisible=t}}},[e._v("\n\t\t\t"+e._s(e.lang.imageManage.confirm_delete)+"\n\t\t\t"),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deleteDialogVisible=!1}}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteMethod}},[e._v(e._s(e.lang.common.confirm))])],1)]),e._v(" "),a("el-dialog",{staticClass:"cloud-tipDialog",attrs:{title:e.lang.imageManage.tip,visible:e.createConfirmDialogVisible,width:"35%"},on:{"update:visible":function(t){e.createConfirmDialogVisible=t}}},[a("span",{domProps:{innerHTML:e._s(e.lang.imageManage.uploadImageInfo)}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.createImage(!1)}}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.createImage(!0)}}},[e._v(e._s(e.lang.common.confirm))])],1)]),e._v(" "),a("image-detail",{attrs:{show:e.detailDialogVisible,id:e.id},on:{closeModal:e.closeDetail}})],1)},staticRenderFns:[]};var f=a("C7Lr")(_,p,!1,function(e){a("lUBw"),a("QRSt")},"data-v-1d0f62f2",null);t.default=f.exports},QRSt:function(e,t){},lUBw:function(e,t){}});