webpackJsonp([41],{NUUt:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("3cXf"),r=a.n(s),o={name:"pana-create-port",props:{show:Boolean,tableData:Array},data:function(){return{labelWidth:"120px",mirrorBtn:!1,form:{initNumber:""},rules:{initNumber:[{required:!0,message:this.lang.common.required_item,trigger:"blur"},{type:"number",message:"请输入数字",trigger:"blur"},{validator:this.validateInit,message:"不能输入列表内已存在的ID",trigger:"blur"}]}}},computed:{},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal")},initForm:function(){this.form.initNumber="",void 0!=this.$refs.form&&this.$refs.form.clearValidate(),this.mirrorBtn=!1},validateInit:function(e,t,a){this.tableData.some(function(e,a){return e.vlanId==t})?a(new Error(e.message)):a(),this.mirrorBtn=!1},createPort:function(){var e=this;e.$refs.form.validate(function(t){console.log(12222),t&&(e.mirrorBtn=!0,e.checkError(e.$http({url:e.api.systemManage.post_switch_vlan_info,data:{vlan_ids:[e.form.initNumber]},method:"post"}),function(t){console.log(t),e.$emit("closeModal",!0),e.$message({type:"info",message:e.lang.switchManage.inited})},function(e){}))})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.switchManage.initPoolVlan,width:"30%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{ref:"form",attrs:{"label-position":"right",model:e.form,rules:e.rules}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.initNumber,"label-width":e.labelWidth,prop:"initNumber"}},[a("el-col",{attrs:{span:20}},[a("el-input",{attrs:{oninput:"value=value.replace(/\\D|^0/g,'')",placeholder:""},model:{value:e.form.initNumber,callback:function(t){e.$set(e.form,"initNumber",e._n(t))},expression:"form.initNumber"}})],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.mirrorBtn},on:{click:e.createPort}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var n=a("C7Lr")(o,l,!1,function(e){a("h8Z7")},"data-v-c5d93b24",null).exports,i=a("Cj+A"),c={name:"pana-create-port",components:{"pana-ip-input":i.a},props:{show:Boolean,selectItem:Object},data:function(){return{labelWidth:"120px",routerBtn:!1,form:{poolNetName:"",sourceIpSeg:"",sourceIpMask:"",sourceGatewayIpAddress:"",purposeIpAddress:"",purposeIpMask:"",purposeGatewayIpAddress:""},rules:{poolNetName:[{required:!0,message:this.lang.switchManage.required,trigger:"blur"}],sourceIpSeg:[{required:!0,message:this.lang.switchManage.required,trigger:"blur"},{validator:this.common.validateIpAddress,message:this.lang.switchManage.ipFormatRule,trigger:"blur"}],sourceGatewayIpAddress:[{required:!0,message:this.lang.switchManage.required,trigger:"blur"},{validator:this.common.validateIpAddress,message:this.lang.switchManage.ipFormatRule,trigger:"blur"}],sourceIpMask:[{required:!0,message:this.lang.switchManage.required,trigger:"blur"},{validator:this.common.validateNetMask,message:this.lang.switchManage.maskFormatRule,trigger:"blur"}],purposeIpAddress:[{required:!0,message:this.lang.switchManage.required,trigger:"blur"},{validator:this.common.validateIpAddress,message:this.lang.switchManage.ipFormatRule,trigger:"blur"}],purposeGatewayIpAddress:[{required:!0,message:this.lang.switchManage.required,trigger:"blur"},{validator:this.common.validateIpAddress,message:this.lang.switchManage.ipFormatRule,trigger:"blur"}],purposeIpMask:[{required:!0,message:this.lang.switchManage.required,trigger:"blur"},{validator:this.common.validateNetMask,message:this.lang.switchManage.maskFormatRule,trigger:"blur"}]}}},computed:{},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},initForm:function(){void 0!=this.$refs.form&&this.$refs.form.clearValidate(),this.form.poolNetName=this.selectItem.poolName},validateIpFn:function(e){this.$refs.form.validateField(e)},validateIpMask:function(e){this.$refs.form.validateField(e)},createPort:function(){var e=this,t={pool_net_name:e.form.poolNetName,source_ip:e.form.sourceIpSeg,source_mask:e.form.sourceIpMask,source_gateway:e.form.sourceGatewayIpAddress,purpose_ip:e.form.purposeIpAddress,purpose_mask:e.form.purposeIpMask,purpose_gateway:e.form.purposeGatewayIpAddress};e.$refs.form.validate(function(a){a&&(e.routerBtn=!0,e.checkError(e.$http({url:e.api.systemManage.post_switch_router_info,data:t,method:"post"}),function(t){e.routerBtn=!1,e.$notify({title:e.lang.common.success,type:"success",message:e.lang.switchManage.routerSetSuccess}),e.$emit("closeModal",!0)},function(t){e.routerBtn=!1}))})}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.switchManage.setRouter,width:"30%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{ref:"form",attrs:{"label-position":"right",rules:e.rules,model:e.form}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.poolNetName,"label-width":e.labelWidth,prop:"poolNetName"}},[a("el-col",{attrs:{span:20}},[a("el-input",{attrs:{placeholder:e.lang.switchManage.poolNetNamePls},model:{value:e.form.poolNetName,callback:function(t){e.$set(e.form,"poolNetName",t)},expression:"form.poolNetName"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.sourceIpNetSeg,"label-width":e.labelWidth,prop:"sourceIpSeg"}},[a("el-col",{attrs:{span:20}},[a("pana-ip-input",{nativeOn:{"!blur":function(t){return e.validateIpFn("sourceIpSeg")}},model:{value:e.form.sourceIpSeg,callback:function(t){e.$set(e.form,"sourceIpSeg",t)},expression:"form.sourceIpSeg"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.sourceIpMask,"label-width":e.labelWidth,prop:"sourceIpMask"}},[a("el-col",{attrs:{span:20}},[a("pana-ip-input",{nativeOn:{"!blur":function(t){return e.validateIpMask("sourceIpMask")}},model:{value:e.form.sourceIpMask,callback:function(t){e.$set(e.form,"sourceIpMask",t)},expression:"form.sourceIpMask"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.sourceGatewayIpAddress,"label-width":e.labelWidth,prop:"sourceGatewayIpAddress"}},[a("el-col",{attrs:{span:20}},[a("pana-ip-input",{nativeOn:{"!blur":function(t){return e.validateIpMask("sourceGatewayIpAddress")}},model:{value:e.form.sourceGatewayIpAddress,callback:function(t){e.$set(e.form,"sourceGatewayIpAddress",t)},expression:"form.sourceGatewayIpAddress"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.purposeIpAddress,"label-width":e.labelWidth,prop:"purposeIpAddress"}},[a("el-col",{attrs:{span:20}},[a("pana-ip-input",{nativeOn:{"!blur":function(t){return e.validateIpMask("purposeIpAddress")}},model:{value:e.form.purposeIpAddress,callback:function(t){e.$set(e.form,"purposeIpAddress",t)},expression:"form.purposeIpAddress"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.purposeIpMask,"label-width":e.labelWidth,prop:"purposeIpMask"}},[a("el-col",{attrs:{span:20}},[a("pana-ip-input",{nativeOn:{"!blur":function(t){return e.validateIpMask("purposeIpMask")}},model:{value:e.form.purposeIpMask,callback:function(t){e.$set(e.form,"purposeIpMask",t)},expression:"form.purposeIpMask"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.purposeGatewayIpAddress,"label-width":e.labelWidth,prop:"purposeGatewayIpAddress"}},[a("el-col",{attrs:{span:20}},[a("pana-ip-input",{nativeOn:{"!blur":function(t){return e.validateIpMask("purposeGatewayIpAddress")}},model:{value:e.form.purposeGatewayIpAddress,callback:function(t){e.$set(e.form,"purposeGatewayIpAddress",t)},expression:"form.purposeGatewayIpAddress"}})],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.routerBtn},on:{click:e.createPort}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var u=a("C7Lr")(c,p,!1,function(e){a("RNxs")},"data-v-0597d81a",null).exports,m={name:"pana-create-port",components:{"pana-ip-input":i.a},props:{show:Boolean},data:function(){return{labelWidth:"120px",createBtn:!1,switchBtn:!1,form:{setType:1,name:"",seg:"",mask:"",gateway:"",dnsFirst:"",dnsLast:""},rules:{macAddress:[{required:!0,message:"必填项",trigger:"blur"}],ipAddress:[{required:!0,message:"必填项",trigger:"blur"}]}}},computed:{},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},initForm:function(){},createPort:function(){var e=this;this.$refs.form.validate(function(t){console.log(t),console.log(self.form),t&&e.$emit("closeModal",!0)})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.switchManage.DHCPSet,width:"30%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{ref:"form",attrs:{"label-position":"right",rules:e.rules,model:e.form}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.openDHCP,"label-width":e.labelWidth,prop:"name"}},[a("el-switch",{model:{value:e.switchBtn,callback:function(t){e.switchBtn=t},expression:"switchBtn"}})],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.switchBtn,expression:"switchBtn"}]},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.setType,"label-width":e.labelWidth,prop:"name"}},[a("el-col",{attrs:{span:20}},[a("el-radio-group",{model:{value:e.form.setType,callback:function(t){e.$set(e.form,"setType",t)},expression:"form.setType"}},[a("el-radio",{attrs:{label:1}},[e._v("手动")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("自动")])],1)],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.name,"label-width":e.labelWidth,prop:"name"}},[a("el-col",{attrs:{span:20}},[a("el-input",{attrs:{placeholder:e.lang.switchManage.plsWrite},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.seg,"label-width":e.labelWidth,prop:"seg"}},[a("el-col",{attrs:{span:20}},[a("pana-ip-input",{model:{value:e.form.seg,callback:function(t){e.$set(e.form,"seg",t)},expression:"form.seg"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.mask,"label-width":e.labelWidth,prop:"mask"}},[a("el-col",{attrs:{span:20}},[a("pana-ip-input",{model:{value:e.form.mask,callback:function(t){e.$set(e.form,"mask",t)},expression:"form.mask"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.gateway,"label-width":e.labelWidth,prop:"gateway"}},[a("el-col",{attrs:{span:20}},[a("pana-ip-input",{model:{value:e.form.gateway,callback:function(t){e.$set(e.form,"gateway",t)},expression:"form.gateway"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.dnsFirst,"label-width":e.labelWidth,prop:"dnsFirst"}},[a("el-col",{attrs:{span:20}},[a("el-input",{attrs:{placeholder:e.lang.switchManage.plsWrite},model:{value:e.form.dnsFirst,callback:function(t){e.$set(e.form,"dnsFirst",t)},expression:"form.dnsFirst"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.switchManage.dnsLast,"label-width":e.labelWidth,prop:"dnsLast"}},[a("el-col",{attrs:{span:20}},[a("el-input",{attrs:{placeholder:e.lang.switchManage.plsWrite},model:{value:e.form.dnsLast,callback:function(t){e.$set(e.form,"dnsLast",t)},expression:"form.dnsLast"}})],1)],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.createBtn},on:{click:e.createPort}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var g={name:"pana-poolvlan-manage",components:{"pana-init":n,"pana-router-set":u,"pana-dhcp-set":a("C7Lr")(m,d,!1,function(e){a("dTG3")},"data-v-2fd53b0e",null).exports},data:function(){return{pageSize:10,currentPage:1,total:0,specSearch:"",sortOrder:0,sortProp:"",showInit:!1,showRouterSet:!1,showDhcpSet:!1,loading:!1,tableData:[],selectName:[],selectArr:[],selectItem:{},selectItemLen:[]}},methods:{handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},deleteVlan:function(){var e=this,t=this,a=[];t.selectArr.map(function(e,t){a.push(e.vlanId)}),this.$confirm(t.lang.switchManage.deleteMsg,t.lang.switchManage.deleteVlan,{confirmButtonText:t.lang.switchManage.confirm,cancelButtonText:t.lang.switchManage.cancel,type:"warning"}).then(function(a){console.log(a),t.checkError(t.$http({url:t.api.systemManage.delete_switch_vlan_list,data:{router_ids:t.deleteItem},method:"delete"}),function(a){e.$notify({title:t.lang.common.success,type:"success",message:t.lang.switchManage.deleteSuccess}),t.getList()},function(e){})}).catch(function(a){e.$message({type:"info",message:t.lang.switchManage.deleteCancel})})},getList:function(){var e=this;e.loading=!0,this.checkError(this.$http({url:e.api.systemManage.get_switch_vlan_list,method:"get"}),function(t){var a=[];t.data.map(function(e,t){a[t]={vlanId:e.vlan_id,poolName:e.pool_name,vlanName:e.vlan_name,shared:e.shared}}),e.tableData=a,e.loading=!1},function(t){e.loading=!1})},sortChange:function(e){var t=null==e.order?0:"ascending"===e.order?1:-1;this.sortProp=e.prop,this.sortOrder=t,this.tableData=this.tableData.sort(function(a,s){return a[e.prop]=null==a[e.prop]?"":a[e.prop],s[e.prop]=null==s[e.prop]?"":s[e.prop],(a[e.prop]>s[e.prop]?1:-1)*t})},closeInit:function(e){e&&this.getList(),this.showInit=!1},closeRouterSet:function(e){this.showRouterSet=!1},closeDhcpSet:function(e){this.showDhcpSet=!1},selectSwitchVlan:function(e){var t=[];this.selectItemLen=e.length,this.selectItem=e[0],this.selectArr=e,e.map(function(e){t.push(e.portName)}),this.selectName=t}},mounted:function(){this.getList()},computed:{filterData:function(){var e=this;return e.tableData.filter(function(t,a){return""===e.specSearch||(e.currentPage=1,-1!==r()(t).search(e.specSearch))}).sort(function(t,a){return t[e.sortProp]=null==t[e.sortProp]?"":t[e.sortProp],a[e.sortProp]=null==a[e.sortProp]?"":a[e.sortProp],(t[e.sortProp]>a[e.sortProp]?1:-1)*e.sortOrder})},laterData:function(){return this.filterData.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize)}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{type:"flex",direction:"vertical"}},[a("el-main",[a("el-row",{staticClass:"pana-btn-group",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showInit=!0}}},[e._v("\n                    "+e._s(e.lang.switchManage.init)+"\n                ")]),e._v(" "),a("el-button",{attrs:{disabled:1!=e.selectItemLen},on:{click:function(t){e.$router.push({path:"/systemManage/switchManage/switchTab/"+e.$route.params.id+"/poolVlanFix/"+JSON.stringify(e.selectItem)})}}},[e._v("\n                    "+e._s(e.lang.switchManage.fixed)+"\n                ")])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-row",{staticClass:"search-row",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:22}},[a("el-input",{attrs:{placeholder:e.lang.common.search,"suffix-icon":"el-icon-search"},model:{value:e.specSearch,callback:function(t){e.specSearch=t},expression:"specSearch"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"fa fa-refresh",attrs:{type:"text",circle:""},on:{click:e.getList}})],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)",data:e.laterData,"tooltip-effect":"dark"},on:{"selection-change":e.selectSwitchVlan,"sort-change":e.sortChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.switchManage.vlanid,sortable:"custom",prop:"vlanId"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.switchManage.vlanName,sortable:"custom",prop:"vlanName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("\n                        "+e._s(t.row.vlanName.substr(0,t.row.vlanName.length-1))+"\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.switchManage.shared,prop:"shared",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.shared)+"\n                ")]}}])})],1),e._v(" "),a("el-row",{staticClass:"row-bg pana-pagination-row",attrs:{type:"flex",justify:"end"}},[e.filterData.length>e.pageSize?a("el-pagination",{attrs:{"current-page":e.currentPage,background:"",layout:"slot, prev, pager, next","page-size":e.pageSize,"prev-text":e.lang.common.prevPage,"next-text":e.lang.common.nextPage,total:e.filterData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[e._t("default",[a("span",{staticClass:"pagination-slot"},[e._v("\n                        "+e._s(e.common.formatMsg(e.lang.common.paginationMsg,{current:this.currentPage,total:this.tableData.length}))+"\n                    ")])])],2):e._e()],1),e._v(" "),a("pana-init",{attrs:{show:e.showInit,selectName:e.selectName,tableData:e.tableData},on:{closeModal:e.closeInit}}),e._v(" "),a("pana-router-set",{attrs:{show:e.showRouterSet,selectItem:e.selectItem},on:{closeModal:e.closeRouterSet}}),e._v(" "),a("pana-dhcp-set",{attrs:{show:e.showDhcpSet,selectName:e.selectName},on:{closeModal:e.closeDhcpSet}})],1)],1)},staticRenderFns:[]};var h=a("C7Lr")(g,f,!1,function(e){a("leY8")},"data-v-16c0716e",null);t.default=h.exports},RNxs:function(e,t){},dTG3:function(e,t){},h8Z7:function(e,t){},leY8:function(e,t){}});