webpackJsonp([46],{HzXi:function(t,e){},IXf9:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("1JPr"),o=i("/n4h"),s=i("aA9S"),n=i.n(s),l={props:{show:Boolean,diskData:Array},data:function(){return{form:{disk_user:""},rules:{disk_user:[{required:!0,message:this.lang.common.required_item,trigger:"change"}]},zpools:[],loading:!1}},methods:{formatSize:function(t){return this.common.formatCapacity(t,"B")},confirm:function(){var t=this,e=this;this.$refs.form.validate(function(i){if(!i)return!1;var a=[];e.diskData.forEach(function(t){a.push(t.name)});var o={names:a,disk_user:t.form.disk_user};e.closeModal(),t.checkError(e.$http({url:t.api.storage.disk_action,method:"put",data:o}),function(t){e.$emit("getList"),e.$notify({title:e.lang.common.success,type:"success",message:e.lang.disk.configHotSpareDiskSuccess})})})},closeModal:function(t){n()(this.$data,this.$options.data.call(this)),t=t||!1,this.$emit("closeModal",t)},initForm:function(){this.$refs.form&&this.$refs.form.resetFields(),this.getZpool()},getZpool:function(){var t=this;this.loading=!0,this.checkError(this.$http({url:this.api.storage.zpool,method:"get"}),function(e){t.zpools=e.data,t.form.disk_user=t.zpools[0]&&t.zpools[0].name,t.loading=!1},function(){t.loading=!1})}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{id:"configHotSpare",title:t.lang.disk.configHotSpareDisk,visible:t.show,modal:!0,top:"8vh",width:"35%"},on:{"update:visible":function(e){t.show=e},open:t.initForm,close:t.closeModal}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{model:t.form,"label-width":"100px",rules:t.rules,"element-loading-text":t.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)"}},[i("el-form-item",{attrs:{label:t.lang.disk.selectedDisk}},[i("el-table",{staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{data:t.diskData,"highlight-current-row":""}},[i("el-table-column",{attrs:{prop:"name",label:t.lang.disk.slot}}),t._v(" "),i("el-table-column",{attrs:{prop:"model",label:t.lang.disk.type}}),t._v(" "),i("el-table-column",{attrs:{label:t.lang.disk.capacity},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t.formatSize(e.row.size).value+t.formatSize(e.row.size).unit)+"\n                    ")]}}])})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:t.lang.disk.zpool,prop:"disk_user"}},[i("el-select",{staticStyle:{"margin-left":"0"},attrs:{filterable:""},model:{value:t.form.disk_user,callback:function(e){t.$set(t.form,"disk_user",e)},expression:"form.disk_user"}},t._l(t.zpools,function(t){return i("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})}),1)],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.closeModal}},[t._v(t._s(t.lang.common.cancel))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v(t._s(t.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var c=i("C7Lr")(l,r,!1,function(t){i("HzXi"),i("bwJI")},"data-v-249d50de",null).exports,u={data:function(){return{loading:!0,showConfigHotSpare:!1,dialogVisible:!1,tipDialogMsg:"",operate:"",tableData:[],multipleSelection:[],search:"",pageNum:1,pageSize:10}},mounted:function(){this.getList()},components:{"pana-breadcrumb":a.a,cloudTipDialog:o.a,configHotSpare:c},methods:{formatSize:function(t){return this.common.formatCapacity(t,"B")},sort:function(t){this.tableData=this.common.sort(t,this.tableData,["size"])},formatStatus:function(t,e){return t<=1?this.lang.volume.status[t]:this.common.formatMsg(this.lang.volume.statusShow,{status:this.lang.volume.status[t],disk_user:e})},initializeDiskConfirm:function(){this.operate="initializeDisk",this.dialogVisible=!0,this.tipDialogMsg=this.lang.disk.initializeDiskConfirm},removeHotSpareConfirm:function(){this.operate="removeHotSpare",this.dialogVisible=!0,this.tipDialogMsg=this.lang.disk.removeHotSpareConfirm},closeConfigHotSpare:function(){this.showConfigHotSpare=!1},dialogConfirm:function(){switch(this.dialogVisible=!1,this.operate){case"initializeDisk":this.initializeDisk();break;case"removeHotSpare":this.removeHotSpare()}},initializeDisk:function(){var t=this,e=[];this.multipleSelection.forEach(function(t){e.push(t.name)});var i=this.api.storage.disk;this.checkError(this.$http({url:i,data:{names:e},method:"POST"}),function(e){t.getList(),t.$notify({title:t.lang.common.success,type:"success",message:t.lang.disk.initializeDiskSuccess})})},removeHotSpare:function(){var t=this,e=[];this.multipleSelection.forEach(function(t){e.push(t.name)});var i=this.api.storage.disk_action;this.checkError(this.$http({url:i,data:{names:e},method:"POST"}),function(e){t.getList(),t.$notify({title:t.lang.common.success,type:"success",message:t.lang.disk.removeHotSpareSuccess})})},notSelect:function(){return this.multipleSelection.length<=0},getList:function(){var t=this;this.checkError(this.$http({url:this.api.storage.disk,method:"get"}),function(e){t.loading=!1,t.tableData=e.data})},pageSelect:function(t){this.pageNum=t},handleSelectionChange:function(t){this.multipleSelection=t}},computed:{filterData:function(){var t=this.search,e=[];return e=""===t?this.tableData:this.common.cloudFilter(this.tableData,t),e},pagedData:function(){return this.filterData.length<=this.pageSize?this.filterData:this.common.pagination(this.filterData,this.pageSize,this.pageNum)},initializeDisabled:function(){return!!this.notSelect()||this.multipleSelection.some(function(t){return 0!==t.disk_state})},configHotSpareDisabled:function(){return!!this.notSelect()||this.multipleSelection.some(function(t){return 1!==t.disk_state})},removeHotSpareDisabled:function(){return!!this.notSelect()||this.multipleSelection.some(function(t){return 3!==t.disk_state})}},watch:{search:function(){this.pageNum=1}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-container",{staticClass:"mainDiv",attrs:{type:"flex",direction:"vertical"}},[i("pana-breadcrumb",{attrs:{changePool:!0,callback:t.getList}}),t._v(" "),i("el-main",[i("el-row",{staticClass:"cloud-btn-row",attrs:{type:"flex",justify:"space-between"}},[i("el-col",{attrs:{span:18}},[i("el-button",{attrs:{disabled:t.initializeDisabled,type:"primary"},on:{click:t.initializeDiskConfirm}},[t.initializeDisabled?i("div",[i("el-tooltip",{attrs:{content:t.lang.disk.initializeCondition,placement:"top"}},[i("div",[t._v(t._s(t.lang.disk.initializeDisk))])])],1):i("div",[i("div",[t._v(t._s(t.lang.disk.initializeDisk))])])]),t._v(" "),i("el-button",{attrs:{disabled:t.configHotSpareDisabled},on:{click:function(e){t.showConfigHotSpare=!0}}},[t.configHotSpareDisabled?i("div",[i("el-tooltip",{attrs:{content:t.lang.disk.configHotSpareCondition,placement:"top"}},[i("div",[t._v(t._s(t.lang.disk.configHotSpareDisk))])])],1):i("div",[i("div",[t._v(t._s(t.lang.disk.configHotSpareDisk))])])]),t._v(" "),i("el-button",{attrs:{disabled:t.removeHotSpareDisabled},on:{click:t.removeHotSpareConfirm}},[t._v("\n                    "+t._s(t.lang.disk.removeHotSpareDisk)+"\n                ")])],1),t._v(" "),i("el-col",{attrs:{span:6}},[i("el-row",{staticClass:"search-row",attrs:{type:"flex",justify:"space-around"}},[i("el-col",{attrs:{span:22}},[i("el-input",{attrs:{placeholder:t.lang.common.search,"suffix-icon":"el-icon-search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),i("el-col",{attrs:{span:2}},[i("el-button",{staticClass:"fa fa-refresh",attrs:{type:"text",circle:""},on:{click:t.getList}})],1)],1)],1)],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-text":t.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)",data:t.pagedData},on:{"sort-change":t.sort,"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"45"}}),t._v(" "),i("el-table-column",{attrs:{sortable:"custom",prop:"name",label:t.lang.disk.slot}}),t._v(" "),i("el-table-column",{attrs:{sortable:"custom",prop:"model",label:t.lang.disk.type}}),t._v(" "),i("el-table-column",{attrs:{sortable:"custom",prop:"vendor",label:t.lang.disk.manufacturer}}),t._v(" "),i("el-table-column",{attrs:{sortable:"custom",prop:"serial",label:t.lang.disk.productNumber}}),t._v(" "),i("el-table-column",{attrs:{sortable:"custom",prop:"size",label:t.lang.disk.capacity},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.formatSize(e.row.size).value+t.formatSize(e.row.size).unit)+"\n                ")]}}])}),t._v(" "),i("el-table-column",{attrs:{sortable:"custom",prop:"disk_state",label:t.lang.common.status},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.formatStatus(e.row.disk_state,e.row.disk_user))+"\n                ")]}}])})],1),t._v(" "),i("el-row",{staticClass:"row-bg pana-pagination-row",attrs:{type:"flex",justify:"end"}},[t.filterData.length>t.pageSize?i("el-pagination",{attrs:{background:"",layout:"prev, pager, next","prev-text":t.lang.common.prevPage,"next-text":t.lang.common.nextPage,total:t.filterData.length,"current-page":t.pageNum},on:{"current-change":t.pageSelect}}):t._e()],1),t._v(" "),i("cloud-tip-dialog",{attrs:{dialogVisible:t.dialogVisible},on:{cancel:function(e){t.dialogVisible=!1},confirm:t.dialogConfirm}},[t._v("\n            "+t._s(t.tipDialogMsg)+"\n        ")]),t._v(" "),i("config-hot-spare",{attrs:{diskData:t.multipleSelection,show:t.showConfigHotSpare},on:{closeModal:t.closeConfigHotSpare,getList:t.getList}})],1)],1)},staticRenderFns:[]};var m=i("C7Lr")(u,d,!1,function(t){i("l7DD")},"data-v-db24ad38",null);e.default=m.exports},bwJI:function(t,e){},l7DD:function(t,e){}});