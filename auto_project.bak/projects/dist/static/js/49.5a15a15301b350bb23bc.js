webpackJsonp([49],{AHh7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("1JPr"),o={props:{show:Boolean},data:function(){return{labelWidth:"100px",tableData:[],flagData:[],form:{name:"",email:[{type:"email",value:""}],contacts:[]},rules:{name:[{required:!0,message:"请输入联系人组名称",trigger:"blur"},{min:1,max:32,message:"长度为1-32个字符",trigger:"blur"},{validator:this.common.validateName6,trigger:"blur"}]},showidentical:!1,loading:!1,canSave:!0}},methods:{closeModal:function(t){t=t||!1,this.$emit("closeModal",t)},addemail:function(){this.form.email.length<10&&this.form.email.push({type:"email",value:""})},deleteemail:function(t){this.form.email.splice(t,1)},ensureAdd:function(){var t=this,e=this;this.form.contacts=this.form.email;for(var a=0;a<this.form.email.length;a++)for(var l=a+1;l<this.form.email.length;l++)if(""!==this.form.email[a].value&&""!==this.form.email[l].value&&this.form.email[a].value===this.form.email[l].value)return this.showidentical=!0,!1;this.$refs.form.validate(function(a){if(a){if(!t.canSave)return;t.canSave=!1,t.loading=!0,t.checkError(t.$http({url:e.api.alarmManage.getcontactGroup,method:"post",data:e.form}),function(t){e.canSave=!0,e.$notify({title:e.lang.common.success,type:"success",message:"创建成功"}),e.closeModal(!0)})}})},initForm:function(){null!=this.$refs.form&&this.$refs.form.resetFields(),this.form.email=[{type:"email",value:""}],this.loading=!1,this.showidentical=!1,this.canSave=!0}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.lang.alarmManage.createcontactGroup,width:"45%",visible:t.show,modal:!0},on:{open:t.initForm,close:t.closeModal}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[a("div",{staticClass:"alarm-alert"},[a("div",{staticClass:"alert-wraning"},[t._v(t._s(t.lang.alarmManage.emailrange))])]),t._v(" "),a("el-form",{ref:"form",attrs:{"label-position":"right",model:t.form,rules:t.rules}},[a("el-row",{attrs:{type:"flex",justify:"left"}},[a("el-col",{staticStyle:{"margin-right":"5px"},attrs:{span:20}},[a("el-form-item",{attrs:{label:t.lang.alarmManage.contactGroup,"label-width":t.labelWidth,prop:"name"}},[a("el-input",{attrs:{placeholder:t.lang.alarmManage.placecontact},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1),t._v(" "),t._l(t.form.email,function(e,l){return a("el-row",{key:e.key,attrs:{type:"flex",justify:"left"}},[a("el-col",{staticStyle:{"margin-right":"5px"},attrs:{span:20}},[a("el-form-item",{attrs:{label:t.lang.alarmManage.email,"label-width":t.labelWidth,prop:"email."+l+".value",rules:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{validator:t.common.validateEmail,message:"请输入正确的邮箱地址",trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:t.lang.alarmManage.placeholder},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)],1),t._v(" "),t.form.email.length>1&&0!=l?a("el-col",{staticStyle:{"margin-right":"5px"},attrs:{span:1}},[a("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.deleteemail(l)}}},[t._v("删除")])],1):t._e()],1)}),t._v(" "),a("el-row",[a("el-form-item",{attrs:{"label-width":t.labelWidth}},[a("el-button",{attrs:{type:"primary"},on:{click:t.addemail}},[t._v("新增")])],1)],1)],2),t._v(" "),t.showidentical?a("span",{staticStyle:{"text-align":"center",color:"red",display:"block","margin-bottom":"10px"}},[t._v("不可输入相同的邮箱")]):t._e(),t._v(" "),a("span",{staticClass:"dialog-footer",staticStyle:{display:"block","text-align":"center","margin-bottom":"40px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeModal}},[t._v(t._s(t.lang.common.cancel))]),t._v(" "),t.canSave?a("el-button",{attrs:{type:"primary"},on:{click:t.ensureAdd}},[t._v(t._s(t.lang.common.confirm))]):a("el-button",{attrs:{type:"primary",disabled:!0}},[t._v(t._s(t.lang.common.confirm))])],1)],1)])},staticRenderFns:[]};var i=a("C7Lr")(o,n,!1,function(t){a("R8fh")},"data-v-7f8b5137",null).exports,r={props:{show:Boolean},methods:{closeModal:function(t){t=t||!1,this.$emit("closeModal",t)},deletecontactGroup:function(){this.closeModal(!0)}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.lang.common.info,visible:t.show,width:"30%",modal:!0},on:{close:t.closeModal}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:10}},[t._v(t._s(t.lang.alarmManage.ensuredelete))])],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeModal}},[t._v(t._s(t.lang.common.cancel))]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.deletecontactGroup}},[t._v(t._s(t.lang.common.confirm))])],1)],1)},staticRenderFns:[]},c=a("C7Lr")(r,s,!1,null,null,null).exports,m={props:{show:Boolean,info:Object},data:function(){return{labelWidth:"100px",tableData:[],flagData:[],form:{name:"",email:[{type:"email",value:"",id:""}],contacts:[],delContacts:[]},rules:{name:[{required:!0,message:"请输入联系人组名称",trigger:"blur"},{min:1,max:32,message:"长度为1-32个字符",trigger:"blur"},{validator:this.common.validateName6,trigger:"blur"}]},showidentical:!1,loading:!1,canSave:!0}},methods:{closeModal:function(t){t=t||!1,this.$emit("closeModal",t)},addemail:function(){this.form.email.length<10&&this.form.email.push({type:"email",value:""})},deleteemail:function(t,e){this.form.delContacts.push(e.id),this.form.email.splice(t,1)},getgivenList:function(){var t=this;this.checkError(this.$http({url:this.common.formatMsg(this.api.alarmManage.getcontactInfo,{id:t.info.id}),method:"get"}),function(e){for(var a=[],l=0;l<e.data.contacts.length;l++)"email"==e.data.contacts[l].type&&a.push({type:"email",value:e.data.contacts[l].value,id:e.data.contacts[l].id});t.form.email=a})},ensureAdd:function(){var t=this,e=this;this.form.contacts=this.form.email;for(var a=0;a<this.form.email.length;a++)for(var l=a+1;l<this.form.email.length;l++)if(""!=this.form.email[a].value&&""!=this.form.email[l].value&&this.form.email[a].value==this.form.email[l].value)return this.showidentical=!0,!1;this.$refs.form.validate(function(a){if(a){if(!t.canSave)return;t.canSave=!1,t.loading=!0,t.checkError(t.$http({url:t.common.formatMsg(t.api.alarmManage.getcontactInfo,{id:e.info.id}),method:"put",data:{name:t.form.name,contacts:t.form.contacts,delContacts:t.form.delContacts}}),function(t){e.canSave=!0,e.$notify({title:e.lang.common.success,type:"success",message:"修改成功"}),e.closeModal(!0)})}})},initForm:function(){null!=this.$refs.form&&this.$refs.form.clearValidate(),this.form.name=this.info.name,this.showidentical=!1,this.getgivenList(),this.loading=!1,this.canSave=!0}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.lang.alarmManage.editContactgroup,width:"45%",visible:t.show,modal:!0},on:{open:t.initForm,close:t.closeModal}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[a("div",{staticClass:"alarm-alert"},[a("div",{staticClass:"alert-wraning"},[t._v(t._s(t.lang.alarmManage.emailrange))])]),t._v(" "),a("el-form",{ref:"form",attrs:{"label-position":"right",model:t.form,rules:t.rules}},[a("el-row",{attrs:{type:"flex",justify:"left"}},[a("el-col",{staticStyle:{"margin-right":"5px"},attrs:{span:15}},[a("el-form-item",{attrs:{label:t.lang.alarmManage.contactGroup,"label-width":t.labelWidth,prop:"name"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1),t._v(" "),t._l(t.form.email,function(e,l){return a("el-row",{key:e.key,attrs:{type:"flex",justify:"left"}},[a("el-col",{staticStyle:{"margin-right":"5px"},attrs:{span:15}},[a("el-form-item",{attrs:{label:t.lang.alarmManage.email,"label-width":t.labelWidth,prop:"email."+l+".value",rules:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{validator:t.common.validateEmail,message:"请输入正确的邮箱地址",trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:t.lang.alarmManage.placeholder},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)],1),t._v(" "),t.form.email.length>1&&0!=l?a("el-col",{staticStyle:{"margin-right":"5px"},attrs:{span:1}},[a("el-button",{attrs:{type:"danger"},on:{click:function(a){return t.deleteemail(l,e)}}},[t._v("删除")])],1):t._e()],1)}),t._v(" "),a("el-row",[a("el-form-item",{attrs:{"label-width":t.labelWidth}},[a("el-button",{attrs:{type:"primary"},on:{click:t.addemail}},[t._v("新增")])],1)],1)],2),t._v(" "),t.showidentical?a("span",{staticStyle:{"text-align":"center",color:"red",display:"block"}},[t._v("不可输入相同的邮箱")]):t._e(),t._v(" "),a("span",{staticClass:"dialog-footer",staticStyle:{display:"block","text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeModal}},[t._v(t._s(t.lang.common.cancel))]),t._v(" "),t.canSave?a("el-button",{attrs:{type:"primary"},on:{click:t.ensureAdd}},[t._v(t._s(t.lang.common.confirm))]):a("el-button",{attrs:{disabled:!0}},[t._v(t._s(t.lang.common.confirm))])],1)],1)])},staticRenderFns:[]};var u=a("C7Lr")(m,d,!1,function(t){a("oRp5")},"data-v-4b38d509",null).exports,g={components:{"pana-breadcrumb":l.a,"pana-creatgroup":i,"pana-deletegroup":c,"pana-editgroup":u},data:function(){return{tableData:[],pageNum:1,pageSize:10,showCreate:!1,showDelete:!1,showEdit:!1,deleteIds:[],contactInfo:null}},methods:{getcontactgroupList:function(){var t=this;this.checkError(this.$http({url:this.api.alarmManage.getcontactGroup,method:"get"}),function(e){t.tableData=e.data})},pageSelect:function(t){this.pageNum=t},sortChange:function(t){var e=null==t.order?0:"ascending"===t.order?1:-1;this.tableData=this.tableData.sort(function(a,l){return(a[t.prop]>l[t.prop]?1:-1)*e})},closeCreate:function(t){1==t&&this.getcontactgroupList(),this.showCreate=!1},selectids:function(t){var e=[];t.forEach(function(t){e.push(t.id)}),this.deleteIds=e},closeDelete:function(t){var e=this,a=[];this.showDelete=!1,!0===t&&(a=this.deleteIds,this.checkError(this.$http({url:this.api.alarmManage.getcontactGroup+this.common.formatGetUrl({ids:a}),method:"delete"}),function(t){e.$notify({title:e.lang.common.success,type:"success",message:"删除成功"}),e.getcontactgroupList()}))},editclick:function(t){this.showEdit=!0,this.contactInfo=t},closeEdit:function(t){1==t&&this.getcontactgroupList(),this.showEdit=!1}},computed:{filterData:function(){var t=this.search,e=[];return e=""===t?this.tableData:this.common.cloudFilter(this.tableData,t),e},pagedData:function(){return this.filterData.length<=this.pageSize?this.filterData:this.common.pagination(this.filterData,this.pageSize,this.pageNum)}},watch:{search:function(){this.pageNum=1}},mounted:function(){this.getcontactgroupList()}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{attrs:{type:"flex",direction:"vertical"}},[a("pana-breadcrumb"),t._v(" "),a("el-main",[a("el-row",{staticClass:"pana-btn-group",attrs:{type:"flex",justify:"space-between"}},[a("el-col",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showCreate=!0}}},[t._v(t._s(t.lang.common.create))]),t._v(" "),a("el-button",{attrs:{disabled:0==t.deleteIds.length},on:{click:function(e){t.showDelete=!0}}},[t._v(t._s(t.lang.common.delete))])],1)],1),t._v(" "),a("el-table",{ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)",data:t.pagedData},on:{"selection-change":t.selectids,"sort-change":t.sortChange}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:t.lang.alarmManage.contactGroup,sortable:"custom"}}),t._v(" "),a("el-table-column",{attrs:{label:t.lang.alarmManage.email},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.emails,function(e,l){return a("span",{key:l,staticStyle:{display:"block"}},[t._v(t._s(e.value))])})}}])}),t._v(" "),a("el-table-column",{attrs:{label:t.lang.common.operation},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.editclick(e.row)}}},[t._v(t._s(t.lang.common.edit))])]}}])})],1),t._v(" "),a("el-row",{staticClass:"row-bg pana-pagination-row",attrs:{type:"flex",justify:"end"}},[t.filterData.length>t.pageSize?a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","prev-text":t.lang.common.prevPage,"next-text":t.lang.common.nextPage,total:t.filterData.length,"current-page":t.pageNum},on:{"current-change":t.pageSelect}}):t._e()],1)],1),t._v(" "),a("pana-creatgroup",{attrs:{show:t.showCreate},on:{closeModal:t.closeCreate}}),t._v(" "),a("pana-deletegroup",{attrs:{show:t.showDelete},on:{closeModal:t.closeDelete}}),t._v(" "),a("pana-editgroup",{attrs:{show:t.showEdit,info:t.contactInfo},on:{closeModal:t.closeEdit}})],1)},staticRenderFns:[]};var h=a("C7Lr")(g,f,!1,function(t){a("pPKQ")},"data-v-1aacc303",null);e.default=h.exports},R8fh:function(t,e){},oRp5:function(t,e){},pPKQ:function(t,e){}});