webpackJsonp([65],{Glxv:function(e,t){},KMeh:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("1JPr"),l={name:"affinityGroupList",data:function(){return{loading:!0,dialogVisible:!1,tipDialogMsg:"",id:"",detailDialogVisible:!1,createDialogVisible:!1,policies:"affinity",createForm:{name:"",policies:[]},tableData:[],multipleSelection:[],search:"",pageNum:"1",pageSize:"10",deleteDialogVisible:!1,deleteItem:"",rules:{name:[{required:!0,message:"请输入亲和组名称",trigger:"blur"},{max:32,message:"请至多输入32位",trigger:"blur"},{validator:function(e,t,a){!1===/^[A-Za-z0-9_\-\u4E00-\u9FA5]+$/.test(t)?a(new Error("只能输入字母、数字、汉字、横线以及下划线")):a()},trigger:"blur"}]}}},mounted:function(){this.getList();var e=this;this.$ws.setCallback(function(t){if(-1!==e.wsEventQueue.indexOf(t.resource_id)){var a=t.event_type.split(".");"servergroup"!==a[0]||"create"!==a[1]&&"delete"!==a[1]||e.getList()}})},components:{cloudTipDialog:a("/n4h").a,panaBreadcrumb:i.a},methods:{sort:function(e){this.tableData.length>0&&("descending"===e.order?this.tableData=this.tableData.sort(function(t,a){return t[e.prop]<a[e.prop]?1:-1}):this.tableData=this.tableData.sort(function(t,a){return t[e.prop]>a[e.prop]?1:-1}))},createDialogShow:function(){this.$refs.createForm&&this.$refs.createForm.resetFields(),this.policies="affinity",this.createForm.policies=[],this.createDialogVisible=!0},router_to_detail:function(e){this.$router.push({name:"affinityGroupDetail",params:{id:e}})},deleteConfirm:function(){this.dialogVisible=!0,this.tipDialogMsg=this.lang.resource.confirm_delete},dialogConfirm:function(){this.dialogVisible=!1;var e=this,t=[];this.multipleSelection.forEach(function(a){t.push(a.id),e.wsEventQueue.push(a.id),e.wsEventQueueObj.push({name:a.name,id:a.id})});var a=this.common.formatGetUrl({id:t});this.checkError(this.$http({url:this.api.cloud.get_server_groups+a,method:"delete"}),function(t){e.$notify({title:e.lang.common.success,type:"success",message:e.lang.resource.affinityGroupDeleteing})})},showDetail:function(e){this.id=e,this.detailDialogVisible=!0},getList:function(){var e=this;this.checkError(this.$http({url:this.api.cloud.get_server_groups,method:"get"}),function(t){e.loading=!1,e.tableData=t.data})},create:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(!e)return!1;t.createDialogVisible=!1,t.createForm.policies.push(t.policies),t.checkError(t.$http({url:t.api.cloud.get_server_groups,method:"post",data:t.createForm}),function(e){a.wsEventQueue.push(e.data.id),a.$notify({title:a.lang.common.success,type:"success",message:a.createForm.name+a.lang.resource.affinityGroupCreateing})})})},pageSelect:function(e){this.pageNum=e},handleSelectionChange:function(e){this.multipleSelection=e}},computed:{filterData:function(){var e=this.search,t=[];return t=""===e?this.tableData:this.common.cloudFilter(this.tableData,e),t},pagedData:function(){return this.filterData.length<=this.pageSize?this.filterData:this.common.pagination(this.filterData,this.pageSize,this.pageNum)}},watch:{search:function(){this.pageNum=1}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mainDiv",attrs:{id:"affinity_group"}},[a("pana-breadcrumb",{attrs:{changePool:!0,callback:e.getList}}),e._v(" "),a("el-main",[a("el-row",[a("el-alert",{attrs:{title:e.lang.resource.affinityGroupInfo,type:"bg-blue",closable:!1}})],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:e.createDialogShow}},[e._v(e._s(e.lang.common.create))]),e._v(" "),a("el-button",{attrs:{disabled:e.multipleSelection.length<=0},on:{click:e.deleteConfirm}},[e._v(e._s(e.lang.common.delete))])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-row",{staticClass:"search-row",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:22}},[a("el-input",{attrs:{placeholder:e.lang.common.search,"suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"fa fa-refresh",attrs:{type:"text",circle:""},on:{click:e.getList}})],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)",data:e.pagedData},on:{"sort-change":e.sort,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"name",label:e.lang.imageManage.name}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.resource.affinityRule},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.lang.resource.affinityRuleObj[t.row.policies&&t.row.policies[0]])+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"200",label:e.lang.common.operation},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.router_to_detail(t.row.id)}}},[e._v(e._s(e.lang.common.check)+"\n                    ")])]}}])})],1),e._v(" "),a("el-row",{staticClass:"row-bg pana-pagination-row",attrs:{type:"flex",justify:"end"}},[e.filterData.length>e.pageSize?a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","prev-text":e.lang.common.prevPage,"next-text":e.lang.common.nextPage,total:e.filterData.length,"current-page":e.pageNum},on:{"current-change":e.pageSelect}}):e._e()],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.lang.resource.createGroup,visible:e.createDialogVisible,top:"8vh",width:"35%"},on:{"update:visible":function(t){e.createDialogVisible=t}}},[a("el-form",{ref:"createForm",attrs:{model:e.createForm,"label-width":"100px",rules:e.rules}},[a("el-form-item",{attrs:{label:e.lang.common.name,prop:"name"}},[a("el-input",{attrs:{placeholder:e.lang.common.namePlaceholder},model:{value:e.createForm.name,callback:function(t){e.$set(e.createForm,"name","string"==typeof t?t.trim():t)},expression:"createForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.resource.affinityRule}},[a("el-radio",{attrs:{label:"affinity"},model:{value:e.policies,callback:function(t){e.policies=t},expression:"policies"}},[e._v(e._s(e.lang.resource.affinityRuleObj.affinity))]),e._v(" "),a("el-radio",{attrs:{label:"anti-affinity"},model:{value:e.policies,callback:function(t){e.policies=t},expression:"policies"}},[e._v(e._s(e.lang.resource.affinityRuleObj["anti-affinity"]))])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.createDialogVisible=!1}}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.create("createForm")}}},[e._v(e._s(e.lang.common.confirm))])],1)],1),e._v(" "),a("cloud-tip-dialog",{attrs:{dialogVisible:e.dialogVisible},on:{cancel:function(t){e.dialogVisible=!1},confirm:e.dialogConfirm}},[e._v("\n        "+e._s(e.tipDialogMsg)+"\n    ")]),e._v(" "),a("el-dialog",{attrs:{title:e.lang.imageManage.detail,visible:e.detailDialogVisible,top:"8vh",width:"40%"},on:{"update:visible":function(t){e.detailDialogVisible=t}}},[a("image-detail",{key:e.id,attrs:{id:e.id}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.detailDialogVisible=!1}}},[e._v(e._s(e.lang.common.close))])],1)],1)],1)},staticRenderFns:[]};var n=a("C7Lr")(l,o,!1,function(e){a("Glxv"),a("akkZ")},"data-v-f511d240",null);t.default=n.exports},akkZ:function(e,t){}});