webpackJsonp([7],{"5uZj":function(e,t,n){n("at0p"),n("f1e3"),e.exports=n("ZuHZ").Array.from},"9f+U":function(e,t){},Cici:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("4YfN"),i=n.n(r),o=n("IHPB"),a=n.n(o),s=n("1JPr"),u=n("3cXf"),l=n.n(u),c=n("c9+V"),d=n.n(c),f=n("qqHy"),h=n.n(f),p={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mask__wrapper"},[n("div",{staticClass:"mask-viewer__mask"},[n("div",{staticClass:"mask-content"},[e._t("default")],2)]),e._v(" "),n("span",{staticClass:"mask-viewer__btn mask-viewer__close"},[n("i",{staticClass:"el-icon-circle-close",on:{click:function(t){return e.$emit("closeMask",!1)}}})])])},staticRenderFns:[]};var m={components:{maskList:n("C7Lr")({data:function(){return{}}},p,!1,function(e){n("E2hr")},null,null).exports},props:{item:{type:Object,required:!0,default:function(){}},guacamole_ip:{type:String,required:!0,default:""},componentInfo:{type:String,required:!0,default:"组件基础信息"},sizeWindow:{type:String,required:!0,default:"small"}},data:function(){return{displayRandom:"gua"+this.newData()+1e4*Math.random(),appendRandom:"abc"+this.newData(),loading:!1,componentInfoTit:this.componentInfo+"远程桌面加载中",timer:null,existTVWall:"",existTVWallMessage:this.componentInfo+"远程桌面加载失败",maskIndex:!1,canvasImg:"",keepStorage:"",timerKeep:null,timerKeepList:null,guacKeep:null}},created:function(){var e=this;this.$nextTick(function(){e.initGuacamole()})},methods:{getChild:function(e){var t=this;this.maskIndex=e;var n=document.getElementById(this.displayRandom);this.loading=!0,!1===this.maskIndex&&this.$nextTick(function(){clearTimeout(t.timerKeepList),t.timerKeepList=setTimeout(function(){n.appendChild(t.keepStorage),h()(".displayRandom").find("div").css({height:"380px",width:"100%"}),h()(".displayRandom").find("canvas").css({height:"380px",width:"100%"}).slideDown(1e3),t.loading=!1},1e3)})},newData:function(){return(new Date).getTime()},handleClickIndex:function(){var e=this;e.maskIndex=!0,e.loading=!0;var t=document.getElementById(e.appendRandom);e.$nextTick(function(){clearTimeout(e.timerKeep),e.timerKeep=setTimeout(function(){t.appendChild(e.keepStorage),h()(".appendRandom").find("div").css({height:"768px",width:"1024px"}),h()(".appendRandom").find("canvas").css({height:"768px",width:"1024px"}).slideDown(1e3),e.loading=!1},200)}),e.keepStorage},initGuacamole:function(){var e=this;e.loading=!0,e.keepStorage="",e.guacKeep=null;var t=document.getElementById(this.displayRandom),n=(document.getElementById(this.appendRandom),e.guacKeep=new d.a.Client(new d.a.HTTPTunnel("//"+e.guacamole_ip+"/tunnel")));n.onerror=function(t){e.existTVWall="",e.existTVWall=t.message,e.loading=!1};var r=l()(i()({},this.item,{password:window.atob(this.item.password)}));n.connect(r),n.onstatechange=function(r){r[0]==n.STATE_CONNECTED&&(clearTimeout(e.timer),e.timer=setTimeout(function(){e.loading=!1,e.keepStorage=n.getDisplay().getElement(),t.appendChild(n.getDisplay().getElement()),h()(".displayRandom").find("div").css({height:"380px",width:"100%"}),h()(".displayRandom").find("canvas").css({height:"380px",width:"100%"}).slideDown(1e3),h()(".appendRandom").find("div").css({height:"768px",width:"1024px"}),h()(".appendRandom").find("canvas").css({height:"768px",width:"1024px"}).slideDown(1e3)},1e3))},window.onunload=function(){n.disconnect(),clearTimeout(e.timer)}},changeFn:function(){var e=this,t=document.getElementById(this.displayRandom);this.loading=!0,!1===this.maskIndex&&this.$nextTick(function(){clearTimeout(e.timerKeepList),e.timerKeepList=setTimeout(function(){t.appendChild(e.keepStorage),h()(".displayRandom").find("div").css({height:"380px",width:"100%"}),h()(".displayRandom").find("canvas").css({height:"380px",width:"100%"}).slideDown(1e3),e.loading=!1},1e3)})},keyboardOrMouse:function(){var e=new d.a.Mouse(this.keepStorage);e.onmousedown=e.onmouseup=e.onmousemove=function(e){this.guacKeep.sendMouseState(e)};var t=new d.a.Keyboard(document);t.onkeydown=function(e){this.guacKeep.sendKeyEvent(1,e)},t.onkeyup=function(e){this.guacKeep.sendKeyEvent(0,e)}}}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[""===e.existTVWall?n("div",{staticClass:"display-content",on:{click:e.handleClickIndex}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:e.displayRandom,class:{displayRandom:"small"===e.sizeWindow,displayRandomBig:"big"===e.sizeWindow},attrs:{disabled:"disabled",id:e.displayRandom,"element-loading-text":e.componentInfoTit}},[e._t("default")],2),e._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:"small"===e.sizeWindow,expression:"sizeWindow === 'small'"}],staticClass:"style-info"},[e._v(e._s(e.componentInfo))])]):n("div",{staticClass:"toggle-content"},[n("p",{staticClass:"toggle-tvwall"},[e._v(e._s(e.existTVWallMessage))])]),e._v(" "),n("mask-list",{directives:[{name:"show",rawName:"v-show",value:e.maskIndex,expression:"maskIndex"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.componentInfoTit},on:{closeMask:e.getChild}},[n("div",{staticClass:"appendRandom",attrs:{id:e.appendRandom}})])],1)},staticRenderFns:[]};var v=n("C7Lr")(m,g,!1,function(e){n("dBxi")},"data-v-404c6a35",null).exports,y=function(e,t,n){var r=e.text,i=void 0===r?"协议":r;t?n():n(new Error(i+"不可为空"))},w=function(e,t,n){var r=e.text,i=void 0===r?"账户":r;t?n():n(new Error(i+"不可为空"))},S=function(e,t,n){var r=e.text,i=void 0===r?"密码":r;if(t){/^(?![a-zA-z]+$)(?!\d+$)(?![!@#$%^&*]+$)[a-zA-Z\d!@#$%^&*]+$/.test(t)?n():n(new Error(i+"输入不合法, 请重新输入"+i))}else n(new Error(i+"不可为空"))},b=function(e,t,n){var r=e.text,i=void 0===r?"端口":r;if(t){/^([0-9]|[1-9]\d|[1-9]\d{2}|[1-9]\d{3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/.test(t)?n():n(new Error(i+"输入不合法, 请输入正确的"+i))}else n(new Error(i+"不可为空"))},T={props:{title:{type:String,required:!0,default:"组件基础信息展示"},show:{type:Boolean,required:!0,default:!1},itemDialog:{type:Object,required:!0,default:function(){}},poolId:{type:Number,required:!0,default:0}},computed:{IsItemDialog:function(){return"{}"!==l()(this.itemDialog)&&null!==this.itemDialog.host_ip&&null!==this.itemDialog.password&&null!==this.itemDialog.port&&null!==this.itemDialog.protocol},getProtocol:function(){if(this.itemDialog)return this.itemDialog.protocol}},watch:{show:function(){this.visible=this.show},itemDialog:function(){this.form=i()({},this.form,this.itemDialog,{region:this.getProtocol,password:null!==this.itemDialog.password?window.atob(this.itemDialog.password):""})}},data:function(){return{visible:this.show,loading:!1,disabled:!1,form:{region:"",port:"",username:"",password:""},formLabelWidth:"120px",rules:{region:[{required:!0,validator:y,trigger:"change"}],port:[{required:!0,validator:b,trigger:"blur"}],username:[{required:!0,validator:w,trigger:"blur"}],password:[{required:!0,validator:S,trigger:"blur"}]},agreeList:[{label:"ssh",value:"ssh"},{label:"vnc",value:"vnc"},{label:"rdp",value:"rdp"}]}},mounted:function(){},methods:{handleClose:function(){this.loading=!1,this.resetForm("myForm")},resetForm:function(e){this.visible=!1,this.loading=!1,this.$refs[e].resetFields()},submitForm:function(){var e=this,t=i()({},this.form,{protocol:this.form.region,pool_id:this.poolId,port:Number(this.form.port)});delete t.region,this.$refs.myForm.validate(function(n){if(!n)return!1;e.loading=!0,e.disabled=!0;var r=e.IsItemDialog?"put":"post";e.checkError(e.$http({url:e.api.cloud.getTVWallData,method:r,data:i()({},t)}),function(t){if("success"===t.message){var n=e.IsItemDialog?"远程控制台配置设置更新":"远程控制台配置设置";e.$message({message:"恭喜你，"+n+"成功",type:"success"}),e.visible=!1,e.resetForm("myForm"),e.loading=!1,e.disabled=!1,e.$emit("successsignal",!0)}},function(e){})})}}},I={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"change-laoding",attrs:{"close-on-click-modal":!1,title:e.title,visible:e.visible,show:e.show,width:"35%","append-to-body":"","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t},close:function(t){return e.$emit("update:show",!1)}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命提交中"}},[n("el-form",{ref:"myForm",staticClass:"form-style",attrs:{model:e.form,rules:e.rules}},[n("el-form-item",{attrs:{label:"协议","label-width":e.formLabelWidth,prop:"region"}},[n("el-select",{attrs:{placeholder:"请选择协议",clearable:""},model:{value:e.form.region,callback:function(t){e.$set(e.form,"region",t)},expression:"form.region"}},e._l(e.agreeList,function(e,t){return n("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"端口","label-width":e.formLabelWidth,prop:"port"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"账户","label-width":e.formLabelWidth,prop:"username"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"密码","label-width":e.formLabelWidth,prop:"password"}},[n("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){return e.resetForm("myForm")}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:e.submitForm}},[e._v("确 定")])],1)])},staticRenderFns:[]};var C={components:{setDialog:n("C7Lr")(T,I,!1,function(e){n("9f+U")},"data-v-2dbd6eb6",null).exports},props:{guaList:{type:Array,required:!0,default:function(){return[]}},poolId:{type:Number,required:!0,default:0}},data:function(){return{componentTitle:"",show:!1,guaDialog:!1,itemDialog:{}}},methods:{setUpCompont:function(e){this.itemDialog={},this.itemDialog=i()({},e,{poolId:this.poolId}),this.componentTitle="组件"+e.server_name+"远程控制台配置",this.show=!0},toSuccess:function(e){this.$emit("success",e)}}},k={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-card",{staticClass:"guacamole-box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("我的组件")])]),e._v(" "),e._l(e.guaList,function(t,r){return n("div",{key:r,staticClass:"text item"},[n("span",{class:{active:t.host_ip&&t.password&&t.port&&t.protocol}},[e._v(e._s(t.server_name))]),e._v(" "),n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(n){return e.setUpCompont(t)}}},[e._v("设 置")]),e._v(" "),n("el-divider")],1)})],2),e._v(" "),n("set-dialog",{attrs:{title:e.componentTitle,show:e.show,itemDialog:e.itemDialog,poolId:e.poolId},on:{"update:show":function(t){e.show=t},successsignal:e.toSuccess}})],1)},staticRenderFns:[]};var E=n("C7Lr")(C,k,!1,function(e){n("d2xv")},null,null).exports,x={components:{panaBreadcrumb:s.a,indexDisplay:v,componentSetUp:E},data:function(){return{childData:{},maskIndex:!1,guacamole_ip:"",loading:!1,loadingList:!1,guaList:[],realTVguaList:[],pageInfo:{pageNum:1,pageSize:4,total:0}}},mounted:function(){this.getTVWallData()},methods:{getChild:function(e){this.maskIndex=e},showGuacamole:function(e){this.childData={},this.childData=e,this.maskIndex=!this.maskIndex},handleSizeChange:function(e){this.pageInfo.pageSize=e},handleCurrentChange:function(e){this.pageInfo.pageNum=e,this.getTVWallData()},refreshList:function(e){e&&this.getTVWallData()},getTVWallData:function(){var e=this;this.loading=!this.loading,this.loadingList=!this.loadingList;var t=this.pageInfo,n=t.pageSize,r=t.pageNum;this.checkError(this.$http({url:this.api.cloud.getTVWallData+"?pool_id="+this.$route.query.id,method:"get",data:{pageSize:n,pageNum:r}}),function(t){"success"===t.message&&(e.realTVguaList=[],e.guaList=[].concat(a()(t.data.guacd)),t.data.guacd.forEach(function(t){t.host_ip&&t.password&&t.port&&t.protocol&&e.realTVguaList.push(i()({},t))}),e.guacamole_ip=t.data.guacamole_ip,e.pageInfo.total=e.realTVguaList.length,e.loading=!e.loading,e.loadingList=!e.loadingList)},function(e){})}}},L={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"100%",height:"840px","overflow-y":"auto"}},[n("pana-breadcrumb",{attrs:{back:!0}}),e._v(" "),n("div",{staticClass:"content"},[e.realTVguaList.length>0?n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box",attrs:{"element-loading-text":"数据加载中"}},e._l(e.realTVguaList.slice((e.pageInfo.pageNum-1)*e.pageInfo.pageSize,e.pageInfo.pageNum*e.pageInfo.pageSize),function(t){return n("div",{key:t.server_id,staticClass:"box-item"},[n("index-display",{attrs:{sizeWindow:"small",item:t,guacamole_ip:e.guacamole_ip,componentInfo:t.server_name},on:{childHandle:e.showGuacamole}})],1)}),0):n("div",{staticClass:"box no-data"},[n("span",[e._v("暂无数据")])]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],staticClass:"content-right",attrs:{"element-loading-text":"组件数据加载中"}},[n("div",{staticClass:"card-list"},[n("componentSetUp",{attrs:{guaList:e.guaList,poolId:Number(e.$route.query.id)},on:{success:e.refreshList}})],1)])]),e._v(" "),n("div",{staticStyle:{margin:"30px 0px 0px 20px"}},[n("el-pagination",{attrs:{"current-page":e.pageInfo.pageNum,"page-size":e.pageInfo.pageSize,"prev-text":"上一页","next-text":"下一页",background:"",layout:"prev, pager, next",total:e.pageInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var A=n("C7Lr")(x,L,!1,function(e){n("YryU")},"data-v-72310342",null);t.default=A.exports},E2hr:function(e,t){},IHPB:function(e,t,n){"use strict";t.__esModule=!0;var r,i=n("kfHR"),o=(r=i)&&r.__esModule?r:{default:r};t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,o.default)(e)}},YryU:function(e,t){},"c9+V":function(e,t){var n;(n=n||{}).ArrayBufferReader=function(e){var t=this;e.onblob=function(e){for(var n=window.atob(e),r=new ArrayBuffer(n.length),i=new Uint8Array(r),o=0;o<n.length;o++)i[o]=n.charCodeAt(o);t.ondata&&t.ondata(r)},e.onend=function(){t.onend&&t.onend()},this.ondata=null,this.onend=null},(n=n||{}).ArrayBufferWriter=function(e){var t=this;function r(t){for(var n="",r=0;r<t.byteLength;r++)n+=String.fromCharCode(t[r]);e.sendBlob(window.btoa(n))}e.onack=function(e){t.onack&&t.onack(e)},this.blobLength=n.ArrayBufferWriter.DEFAULT_BLOB_LENGTH,this.sendData=function(e){var n=new Uint8Array(e);if(n.length<=t.blobLength)r(n);else for(var i=0;i<n.length;i+=t.blobLength)r(n.subarray(i,i+t.blobLength))},this.sendEnd=function(){e.sendEnd()},this.onack=null},n.ArrayBufferWriter.DEFAULT_BLOB_LENGTH=6048,(n=n||{}).AudioContextFactory={singleton:null,getAudioContext:function(){var e=window.AudioContext||window.webkitAudioContext;if(e)try{return n.AudioContextFactory.singleton||(n.AudioContextFactory.singleton=new e),n.AudioContextFactory.singleton}catch(e){}return null}},(n=n||{}).AudioPlayer=function(){this.sync=function(){}},n.AudioPlayer.isSupportedType=function(e){return n.RawAudioPlayer.isSupportedType(e)},n.AudioPlayer.getSupportedTypes=function(){return n.RawAudioPlayer.getSupportedTypes()},n.AudioPlayer.getInstance=function(e,t){return n.RawAudioPlayer.isSupportedType(t)?new n.RawAudioPlayer(e,t):null},n.RawAudioPlayer=function(e,t){var r=n.RawAudioFormat.parse(t),i=n.AudioContextFactory.getAudioContext(),o=i.currentTime,a=new n.ArrayBufferReader(e),s=1===r.bytesPerSample?window.Int8Array:window.Int16Array,u=1===r.bytesPerSample?128:32768,l=[],c=function(){var e=function(e){if(e.length<=1)return e[0];var t=0;e.forEach(function(e){t+=e.length});var n=0,r=new s(t);return e.forEach(function(e){r.set(e,n),n+=e.length}),r}(l);return e?e=(l=function(e){for(var t=Number.MAX_VALUE,n=e.length,i=Math.floor(e.length/r.channels),o=Math.floor(.02*r.rate),a=Math.max(r.channels*o,r.channels*(i-o));a<e.length;a+=r.channels){for(var u=0,l=0;l<r.channels;l++)u+=Math.abs(e[a+l]);u<=t&&(n=a+r.channels,t=u)}return n===e.length?[e]:[new s(e.buffer.slice(0,n*r.bytesPerSample)),new s(e.buffer.slice(n*r.bytesPerSample))]}(e)).shift():null};a.ondata=function(e){!function(e){l.push(new s(e))}(new s(e));var t=c();if(t){var n=i.currentTime;o<n&&(o=n);var a=i.createBufferSource();a.connect(i.destination),a.start||(a.start=a.noteOn),a.buffer=function(e){var t=e.length/r.channels,n=i.currentTime;o<n&&(o=n);for(var a=i.createBuffer(r.channels,t,r.rate),s=0;s<r.channels;s++)for(var l=a.getChannelData(s),c=s,d=0;d<t;d++)l[d]=e[c]/u,c+=r.channels;return a}(t),a.start(o),o+=t.length/r.channels/r.rate}},this.sync=function(){var e=i.currentTime;o=Math.min(o,e+.3)}},n.RawAudioPlayer.prototype=new n.AudioPlayer,n.RawAudioPlayer.isSupportedType=function(e){return!!n.AudioContextFactory.getAudioContext()&&null!==n.RawAudioFormat.parse(e)},n.RawAudioPlayer.getSupportedTypes=function(){return n.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]},(n=n||{}).AudioRecorder=function(){this.onclose=null,this.onerror=null},n.AudioRecorder.isSupportedType=function(e){return n.RawAudioRecorder.isSupportedType(e)},n.AudioRecorder.getSupportedTypes=function(){return n.RawAudioRecorder.getSupportedTypes()},n.AudioRecorder.getInstance=function(e,t){return n.RawAudioRecorder.isSupportedType(t)?new n.RawAudioRecorder(e,t):null},n.RawAudioRecorder=function(e,t){var r=this,i=n.RawAudioFormat.parse(t),o=n.AudioContextFactory.getAudioContext();navigator.mediaDevices||(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia||(navigator.mediaDevices.getUserMedia=(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).bind(navigator));var a=new n.ArrayBufferWriter(e),s=1===i.bytesPerSample?window.Int8Array:window.Int16Array,u=1===i.bytesPerSample?128:32768,l=0,c=0,d=null,f=null,h=null,p=function(e){if(0===e)return 1;var t=Math.PI*e;return Math.sin(t)/t},m=function(e,t){for(var n,r,i=(e.length-1)*t,o=Math.floor(i)-3+1,a=Math.floor(i)+3,s=0,u=o;u<=a;u++)s+=(e[u]||0)*(-(r=3)<(n=i-u)&&n<r?p(n)*p(n/r):0);return s},g=function(){navigator.mediaDevices.getUserMedia({audio:!0},function(e){(h=o.createScriptProcessor(2048,i.channels,i.channels)).connect(o.destination),h.onaudioprocess=function(e){a.sendData(function(e){var t=e.length;l+=t;var n=Math.round(l*i.rate/e.sampleRate)-c;c+=n;for(var r=new s(n*i.channels),o=0;o<i.channels;o++)for(var a=e.getChannelData(o),d=o,f=0;f<n;f++)r[d]=m(a,f/(n-1))*u,d+=i.channels;return r}(e.inputBuffer).buffer)},(f=o.createMediaStreamSource(e)).connect(h),d=e},function(){a.sendEnd(),r.onerror&&r.onerror()})};a.onack=function(e){e.code!==n.Status.Code.SUCCESS||d?(!function(){if(f&&f.disconnect(),h&&h.disconnect(),d)for(var e=d.getTracks(),t=0;t<e.length;t++)e[t].stop();h=null,f=null,d=null,a.sendEnd()}(),a.onack=null,e.code===n.Status.Code.RESOURCE_CLOSED?r.onclose&&r.onclose():r.onerror&&r.onerror()):g()}},n.RawAudioRecorder.prototype=new n.AudioRecorder,n.RawAudioRecorder.isSupportedType=function(e){return!!n.AudioContextFactory.getAudioContext()&&null!==n.RawAudioFormat.parse(e)},n.RawAudioRecorder.getSupportedTypes=function(){return n.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]},(n=n||{}).BlobReader=function(e,t){var n,r=this,i=0;n=window.BlobBuilder?new BlobBuilder:window.WebKitBlobBuilder?new WebKitBlobBuilder:window.MozBlobBuilder?new MozBlobBuilder:new function(){var e=[];this.append=function(n){e.push(new Blob([n],{type:t}))},this.getBlob=function(){return new Blob(e,{type:t})}},e.onblob=function(t){for(var o=window.atob(t),a=new ArrayBuffer(o.length),s=new Uint8Array(a),u=0;u<o.length;u++)s[u]=o.charCodeAt(u);n.append(a),i+=a.byteLength,r.onprogress&&r.onprogress(a.byteLength),e.sendAck("OK",0)},e.onend=function(){r.onend&&r.onend()},this.getLength=function(){return i},this.getBlob=function(){return n.getBlob()},this.onprogress=null,this.onend=null},(n=n||{}).BlobWriter=function(e){var t=this,r=new n.ArrayBufferWriter(e);r.onack=function(e){t.onack&&t.onack(e)};this.sendBlob=function(e){var n=0,i=new FileReader,o=function(){if(n>=e.size)t.oncomplete&&t.oncomplete(e);else{var o=function(e,t,n){var r=(e.slice||e.webkitSlice||e.mozSlice).bind(e),i=n-t;if(i!==n){var o=r(t,i);if(o.size===i)return o}return r(t,n)}(e,n,n+r.blobLength);n+=r.blobLength,i.readAsArrayBuffer(o)}};i.onload=function(){r.sendData(i.result),r.onack=function(i){t.onack&&t.onack(i),i.isError()||(t.onprogress&&t.onprogress(e,n-r.blobLength),o())}},i.onerror=function(){t.onerror&&t.onerror(e,n,i.error)},o()},this.sendEnd=function(){r.sendEnd()},this.onack=null,this.onerror=null,this.onprogress=null,this.oncomplete=null},(n=n||{}).Client=function(e){var t=this,r=2,i=3,o=0,a=0,s=null,u={0:"butt",1:"round",2:"square"},l={0:"bevel",1:"miter",2:"round"},c=new n.Display,d={},f={},h={},p=[],m=[],g=[],v=new n.IntegerPool,y=[];function w(e){e!=o&&(o=e,t.onstatechange&&t.onstatechange(o))}function S(){return o==i||o==r}this.exportState=function(e){var t={currentState:o,currentTimestamp:a,layers:{}},n={};for(var r in d)n[r]=d[r];c.flush(function(){for(var r in n){var i=parseInt(r),o=n[r],a=o.toCanvas(),s={width:o.width,height:o.height};o.width&&o.height&&(s.url=a.toDataURL("image/png")),i>0&&(s.x=o.x,s.y=o.y,s.z=o.z,s.alpha=o.alpha,s.matrix=o.matrix,s.parent=T(o.parent)),t.layers[r]=s}e(t)})},this.importState=function(e,t){var r,i;for(r in o=e.currentState,a=e.currentTimestamp,d)(i=parseInt(r))>0&&c.dispose(d[r]);for(r in d={},e.layers){i=parseInt(r);var s=e.layers[r],u=b(i);if(c.resize(u,s.width,s.height),s.url&&(c.setChannelMask(u,n.Layer.SRC),c.draw(u,0,0,s.url)),i>0&&s.parent>=0){var l=b(s.parent);c.move(u,l,s.x,s.y,s.z),c.shade(u,s.alpha);var f=s.matrix;c.distort(u,f[0],f[1],f[2],f[3],f[4],f[5])}}c.flush(t)},this.getDisplay=function(){return c},this.sendSize=function(t,n){S()&&e.sendMessage("size",t,n)},this.sendKeyEvent=function(t,n){S()&&e.sendMessage("key",n,t)},this.sendMouseState=function(t){if(S()){c.moveCursor(Math.floor(t.x),Math.floor(t.y));var n=0;t.left&&(n|=1),t.middle&&(n|=2),t.right&&(n|=4),t.up&&(n|=8),t.down&&(n|=16),e.sendMessage("mouse",Math.floor(t.x),Math.floor(t.y),n)}},this.createOutputStream=function(){var e=v.next();return y[e]=new n.OutputStream(t,e)},this.createAudioStream=function(n){var r=t.createOutputStream();return e.sendMessage("audio",r.index,n),r},this.createFileStream=function(n,r){var i=t.createOutputStream();return e.sendMessage("file",i.index,n,r),i},this.createPipeStream=function(n,r){var i=t.createOutputStream();return e.sendMessage("pipe",i.index,n,r),i},this.createClipboardStream=function(n){var r=t.createOutputStream();return e.sendMessage("clipboard",r.index,n),r},this.createArgumentValueStream=function(n,r){var i=t.createOutputStream();return e.sendMessage("argv",i.index,n,r),i},this.createObjectOutputStream=function(n,r,i){var o=t.createOutputStream();return e.sendMessage("put",n,o.index,r,i),o},this.requestObjectInputStream=function(t,n){S()&&e.sendMessage("get",t,n)},this.sendAck=function(t,n,r){S()&&e.sendMessage("ack",t,n,r)},this.sendBlob=function(t,n){S()&&e.sendMessage("blob",t,n)},this.endStream=function(t){S()&&(e.sendMessage("end",t),y[t]&&(v.free(t),delete y[t]))},this.onstatechange=null,this.onname=null,this.onerror=null,this.onaudio=null,this.onvideo=null,this.onargv=null,this.onclipboard=null,this.onfile=null,this.onfilesystem=null,this.onpipe=null,this.onsync=null;var b=function(e){var t=d[e];return t||(t=0===e?c.getDefaultLayer():e>0?c.createLayer():c.createBuffer(),d[e]=t),t},T=function(e){if(!e)return null;for(var t in d)if(e===d[t])return parseInt(t);return null};var I={"miter-limit":function(e,t){c.setMiterLimit(e,parseFloat(t))}},C={ack:function(e){var t=parseInt(e[0]),r=e[1],i=parseInt(e[2]),o=y[t];o&&(o.onack&&o.onack(new n.Status(i,r)),i>=256&&y[t]===o&&(v.free(t),delete y[t]))},arc:function(e){var t=b(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]),i=parseInt(e[3]),o=parseFloat(e[4]),a=parseFloat(e[5]),s=parseInt(e[6]);c.arc(t,n,r,i,o,a,0!=s)},argv:function(e){var r=parseInt(e[0]),i=e[1],o=e[2];if(t.onargv){var a=m[r]=new n.InputStream(t,r);t.onargv(a,i,o)}else t.sendAck(r,"Receiving argument values unsupported",256)},audio:function(e){var r=parseInt(e[0]),i=e[1],o=m[r]=new n.InputStream(t,r),a=null;t.onaudio&&(a=t.onaudio(o,i)),a||(a=n.AudioPlayer.getInstance(o,i)),a?(f[r]=a,t.sendAck(r,"OK",0)):t.sendAck(r,"BAD TYPE",783)},blob:function(e){var t=parseInt(e[0]),n=e[1],r=m[t];r&&r.onblob&&r.onblob(n)},body:function(e){var r=parseInt(e[0]),i=g[r],o=parseInt(e[1]),a=e[2],s=e[3];if(i&&i.onbody){var u=m[o]=new n.InputStream(t,o);i.onbody(u,a,s)}else t.sendAck(o,"Receipt of body unsupported",256)},cfill:function(e){var t=parseInt(e[0]),n=b(parseInt(e[1])),r=parseInt(e[2]),i=parseInt(e[3]),o=parseInt(e[4]),a=parseInt(e[5]);c.setChannelMask(n,t),c.fillColor(n,r,i,o,a)},clip:function(e){var t=b(parseInt(e[0]));c.clip(t)},clipboard:function(e){var r=parseInt(e[0]),i=e[1];if(t.onclipboard){var o=m[r]=new n.InputStream(t,r);t.onclipboard(o,i)}else t.sendAck(r,"Clipboard unsupported",256)},close:function(e){var t=b(parseInt(e[0]));c.close(t)},copy:function(e){var t=b(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]),i=parseInt(e[3]),o=parseInt(e[4]),a=parseInt(e[5]),s=b(parseInt(e[6])),u=parseInt(e[7]),l=parseInt(e[8]);c.setChannelMask(s,a),c.copy(t,n,r,i,o,s,u,l)},cstroke:function(e){var t=parseInt(e[0]),n=b(parseInt(e[1])),r=u[parseInt(e[2])],i=l[parseInt(e[3])],o=parseInt(e[4]),a=parseInt(e[5]),s=parseInt(e[6]),d=parseInt(e[7]),f=parseInt(e[8]);c.setChannelMask(n,t),c.strokeColor(n,r,i,o,a,s,d,f)},cursor:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),r=b(parseInt(e[2])),i=parseInt(e[3]),o=parseInt(e[4]),a=parseInt(e[5]),s=parseInt(e[6]);c.setCursor(t,n,r,i,o,a,s)},curve:function(e){var t=b(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]),i=parseInt(e[3]),o=parseInt(e[4]),a=parseInt(e[5]),s=parseInt(e[6]);c.curveTo(t,n,r,i,o,a,s)},disconnect:function(e){t.disconnect()},dispose:function(e){var t=parseInt(e[0]);if(t>0){var n=b(t);c.dispose(n),delete d[t]}else t<0&&delete d[t]},distort:function(e){var t=parseInt(e[0]),n=parseFloat(e[1]),r=parseFloat(e[2]),i=parseFloat(e[3]),o=parseFloat(e[4]),a=parseFloat(e[5]),s=parseFloat(e[6]);if(t>=0){var u=b(t);c.distort(u,n,r,i,o,a,s)}},error:function(e){var r=e[0],i=parseInt(e[1]);t.onerror&&t.onerror(new n.Status(i,r)),t.disconnect()},end:function(e){var t=parseInt(e[0]),n=m[t];n&&(n.onend&&n.onend(),delete m[t])},file:function(e){var r=parseInt(e[0]),i=e[1],o=e[2];if(t.onfile){var a=m[r]=new n.InputStream(t,r);t.onfile(a,i,o)}else t.sendAck(r,"File transfer unsupported",256)},filesystem:function(e){var r=parseInt(e[0]),i=e[1];if(t.onfilesystem){var o=g[r]=new n.Object(t,r);t.onfilesystem(o,i)}},identity:function(e){var t=b(parseInt(e[0]));c.setTransform(t,1,0,0,1,0,0)},img:function(e){var r=parseInt(e[0]),i=parseInt(e[1]),o=b(parseInt(e[2])),a=e[3],s=parseInt(e[4]),u=parseInt(e[5]),l=m[r]=new n.InputStream(t,r),d=new n.DataURIReader(l,a);d.onend=function(){c.setChannelMask(o,i),c.draw(o,s,u,d.getURI())}},jpeg:function(e){var t=parseInt(e[0]),n=b(parseInt(e[1])),r=parseInt(e[2]),i=parseInt(e[3]),o=e[4];c.setChannelMask(n,t),c.draw(n,r,i,"data:image/jpeg;base64,"+o)},lfill:function(e){var t=parseInt(e[0]),n=b(parseInt(e[1])),r=b(parseInt(e[2]));c.setChannelMask(n,t),c.fillLayer(n,r)},line:function(e){var t=b(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]);c.lineTo(t,n,r)},lstroke:function(e){var t=parseInt(e[0]),n=b(parseInt(e[1])),r=b(parseInt(e[2]));c.setChannelMask(n,t),c.strokeLayer(n,r)},mouse:function(e){var t=parseInt(e[0]),n=parseInt(e[1]);c.showCursor(!0),c.moveCursor(t,n)},move:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),r=parseInt(e[2]),i=parseInt(e[3]),o=parseInt(e[4]);if(t>0&&n>=0){var a=b(t),s=b(n);c.move(a,s,r,i,o)}},name:function(e){t.onname&&t.onname(e[0])},nest:function(t){(function(t){var r=p[t];return null==r&&((r=p[t]=new n.Parser).oninstruction=e.oninstruction),r})(parseInt(t[0])).receive(t[1])},pipe:function(e){var r=parseInt(e[0]),i=e[1],o=e[2];if(t.onpipe){var a=m[r]=new n.InputStream(t,r);t.onpipe(a,i,o)}else t.sendAck(r,"Named pipes unsupported",256)},png:function(e){var t=parseInt(e[0]),n=b(parseInt(e[1])),r=parseInt(e[2]),i=parseInt(e[3]),o=e[4];c.setChannelMask(n,t),c.draw(n,r,i,"data:image/png;base64,"+o)},pop:function(e){var t=b(parseInt(e[0]));c.pop(t)},push:function(e){var t=b(parseInt(e[0]));c.push(t)},rect:function(e){var t=b(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]),i=parseInt(e[3]),o=parseInt(e[4]);c.rect(t,n,r,i,o)},reset:function(e){var t=b(parseInt(e[0]));c.reset(t)},set:function(e){var t=b(parseInt(e[0])),n=e[1],r=e[2],i=I[n];i&&i(t,r)},shade:function(e){var t=parseInt(e[0]),n=parseInt(e[1]);if(t>=0){var r=b(t);c.shade(r,n)}},size:function(e){var t=parseInt(e[0]),n=b(t),r=parseInt(e[1]),i=parseInt(e[2]);c.resize(n,r,i)},start:function(e){var t=b(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]);c.moveTo(t,n,r)},sync:function(n){var s=parseInt(n[0]);c.flush(function(){for(var t in f){var n=f[t];n&&n.sync()}s!==a&&(e.sendMessage("sync",s),a=s)}),o===r&&w(i),t.onsync&&t.onsync(s)},transfer:function(e){var t=b(parseInt(e[0])),r=parseInt(e[1]),i=parseInt(e[2]),o=parseInt(e[3]),a=parseInt(e[4]),s=parseInt(e[5]),u=b(parseInt(e[6])),l=parseInt(e[7]),d=parseInt(e[8]);3===s?c.put(t,r,i,o,a,u,l,d):5!==s&&c.transfer(t,r,i,o,a,u,l,d,n.Client.DefaultTransferFunction[s])},transform:function(e){var t=b(parseInt(e[0])),n=parseFloat(e[1]),r=parseFloat(e[2]),i=parseFloat(e[3]),o=parseFloat(e[4]),a=parseFloat(e[5]),s=parseFloat(e[6]);c.transform(t,n,r,i,o,a,s)},undefine:function(e){var t=parseInt(e[0]),n=g[t];n&&n.onundefine&&n.onundefine()},video:function(e){var r=parseInt(e[0]),i=b(parseInt(e[1])),o=e[2],a=m[r]=new n.InputStream(t,r),s=null;t.onvideo&&(s=t.onvideo(a,i,o)),s||(s=n.VideoPlayer.getInstance(a,i,o)),s?(h[r]=s,t.sendAck(r,"OK",0)):t.sendAck(r,"BAD TYPE",783)}};e.oninstruction=function(e,t){var n=C[e];n&&n(t)},this.disconnect=function(){5!=o&&4!=o&&(w(4),s&&window.clearInterval(s),e.sendMessage("disconnect"),e.disconnect(),w(5))},this.connect=function(t){w(1);try{e.connect(t)}catch(e){throw w(0),e}s=window.setInterval(function(){e.sendMessage("nop")},5e3),w(r)}},n.Client.DefaultTransferFunction={0:function(e,t){t.red=t.green=t.blue=0},15:function(e,t){t.red=t.green=t.blue=255},3:function(e,t){t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha},5:function(e,t){},12:function(e,t){t.red=255&~e.red,t.green=255&~e.green,t.blue=255&~e.blue,t.alpha=e.alpha},10:function(e,t){t.red=255&~t.red,t.green=255&~t.green,t.blue=255&~t.blue},1:function(e,t){t.red=e.red&t.red,t.green=e.green&t.green,t.blue=e.blue&t.blue},14:function(e,t){t.red=255&~(e.red&t.red),t.green=255&~(e.green&t.green),t.blue=255&~(e.blue&t.blue)},7:function(e,t){t.red=e.red|t.red,t.green=e.green|t.green,t.blue=e.blue|t.blue},8:function(e,t){t.red=255&~(e.red|t.red),t.green=255&~(e.green|t.green),t.blue=255&~(e.blue|t.blue)},6:function(e,t){t.red=e.red^t.red,t.green=e.green^t.green,t.blue=e.blue^t.blue},9:function(e,t){t.red=255&~(e.red^t.red),t.green=255&~(e.green^t.green),t.blue=255&~(e.blue^t.blue)},4:function(e,t){t.red=~e.red&t.red&255,t.green=~e.green&t.green&255,t.blue=~e.blue&t.blue&255},13:function(e,t){t.red=255&(~e.red|t.red),t.green=255&(~e.green|t.green),t.blue=255&(~e.blue|t.blue)},2:function(e,t){t.red=e.red&~t.red&255,t.green=e.green&~t.green&255,t.blue=e.blue&~t.blue&255},11:function(e,t){t.red=255&(e.red|~t.red),t.green=255&(e.green|~t.green),t.blue=255&(e.blue|~t.blue)}},(n=n||{}).DataURIReader=function(e,t){var n=this,r="data:"+t+";base64,";e.onblob=function(e){r+=e},e.onend=function(){n.onend&&n.onend()},this.getURI=function(){return r},this.onend=null},(n=n||{}).Display=function(){var e=this,t=0,r=0,i=1,o=document.createElement("div");o.style.position="relative",o.style.width=t+"px",o.style.height=r+"px",o.style.transformOrigin=o.style.webkitTransformOrigin=o.style.MozTransformOrigin=o.style.OTransformOrigin=o.style.msTransformOrigin="0 0";var a=new n.Display.VisibleLayer(t,r),s=new n.Display.VisibleLayer(0,0);s.setChannelMask(n.Layer.SRC),o.appendChild(a.getElement()),o.appendChild(s.getElement());var u=document.createElement("div");u.style.position="relative",u.style.width=t*i+"px",u.style.height=r*i+"px",u.appendChild(o),this.cursorHotspotX=0,this.cursorHotspotY=0,this.cursorX=0,this.cursorY=0,this.onresize=null,this.oncursor=null;var l=[],c=[];function d(){for(var e=0;e<c.length;){var t=c[e];if(!t.isReady())break;t.flush(),e++}c.splice(0,e)}function f(e,t){var n=new function(e,t){var n=this;this.blocked=t,this.unblock=function(){n.blocked&&(n.blocked=!1,d())},this.execute=function(){e&&e()}}(e,t);return l.push(n),n}this.getElement=function(){return u},this.getWidth=function(){return t},this.getHeight=function(){return r},this.getDefaultLayer=function(){return a},this.getCursorLayer=function(){return s},this.createLayer=function(){var e=new n.Display.VisibleLayer(t,r);return e.move(a,0,0,0),e},this.createBuffer=function(){var e=new n.Layer(0,0);return e.autosize=1,e},this.flush=function(e){c.push(new function(e,t){this.isReady=function(){for(var e=0;e<t.length;e++)if(t[e].blocked)return!1;return!0},this.flush=function(){for(var n=0;n<t.length;n++)t[n].execute();e&&e()}}(e,l)),l=[],d()},this.setCursor=function(t,n,r,i,o,a,u){f(function(){e.cursorHotspotX=t,e.cursorHotspotY=n,s.resize(a,u),s.copy(r,i,o,a,u,0,0),e.moveCursor(e.cursorX,e.cursorY),e.oncursor&&e.oncursor(s.toCanvas(),t,n)})},this.showCursor=function(e){var t=s.getElement(),n=t.parentNode;!1===e?n&&n.removeChild(t):n!==o&&o.appendChild(t)},this.moveCursor=function(t,n){s.translate(t-e.cursorHotspotX,n-e.cursorHotspotY),e.cursorX=t,e.cursorY=n},this.resize=function(n,s,l){f(function(){n.resize(s,l),n===a&&(t=s,r=l,o.style.width=t+"px",o.style.height=r+"px",u.style.width=t*i+"px",u.style.height=r*i+"px",e.onresize&&e.onresize(s,l))})},this.drawImage=function(e,t,n,r){f(function(){e.drawImage(t,n,r)})},this.drawBlob=function(e,t,n,r){var i=URL.createObjectURL(r),o=f(function(){a.width&&a.height&&e.drawImage(t,n,a),URL.revokeObjectURL(i)},!0),a=new Image;a.onload=o.unblock,a.onerror=o.unblock,a.src=i},this.draw=function(e,t,n,r){var i=f(function(){o.width&&o.height&&e.drawImage(t,n,o)},!0),o=new Image;o.onload=i.unblock,o.onerror=i.unblock,o.src=r},this.play=function(e,t,n,r){var i=document.createElement("video");i.type=t,i.src=r,i.addEventListener("play",function(){!function t(){e.drawImage(0,0,i),i.ended||window.setTimeout(t,20)}()},!1),f(i.play)},this.transfer=function(e,t,n,r,i,o,a,s,u){f(function(){o.transfer(e,t,n,r,i,a,s,u)})},this.put=function(e,t,n,r,i,o,a,s){f(function(){o.put(e,t,n,r,i,a,s)})},this.copy=function(e,t,n,r,i,o,a,s){f(function(){o.copy(e,t,n,r,i,a,s)})},this.moveTo=function(e,t,n){f(function(){e.moveTo(t,n)})},this.lineTo=function(e,t,n){f(function(){e.lineTo(t,n)})},this.arc=function(e,t,n,r,i,o,a){f(function(){e.arc(t,n,r,i,o,a)})},this.curveTo=function(e,t,n,r,i,o,a){f(function(){e.curveTo(t,n,r,i,o,a)})},this.close=function(e){f(function(){e.close()})},this.rect=function(e,t,n,r,i){f(function(){e.rect(t,n,r,i)})},this.clip=function(e){f(function(){e.clip()})},this.strokeColor=function(e,t,n,r,i,o,a,s){f(function(){e.strokeColor(t,n,r,i,o,a,s)})},this.fillColor=function(e,t,n,r,i){f(function(){e.fillColor(t,n,r,i)})},this.strokeLayer=function(e,t,n,r,i){f(function(){e.strokeLayer(t,n,r,i)})},this.fillLayer=function(e,t){f(function(){e.fillLayer(t)})},this.push=function(e){f(function(){e.push()})},this.pop=function(e){f(function(){e.pop()})},this.reset=function(e){f(function(){e.reset()})},this.setTransform=function(e,t,n,r,i,o,a){f(function(){e.setTransform(t,n,r,i,o,a)})},this.transform=function(e,t,n,r,i,o,a){f(function(){e.transform(t,n,r,i,o,a)})},this.setChannelMask=function(e,t){f(function(){e.setChannelMask(t)})},this.setMiterLimit=function(e,t){f(function(){e.setMiterLimit(t)})},this.dispose=function(e){f(function(){e.dispose()})},this.distort=function(e,t,n,r,i,o,a){f(function(){e.distort(t,n,r,i,o,a)})},this.move=function(e,t,n,r,i){f(function(){e.move(t,n,r,i)})},this.shade=function(e,t){f(function(){e.shade(t)})},this.scale=function(e){o.style.transform=o.style.WebkitTransform=o.style.MozTransform=o.style.OTransform=o.style.msTransform="scale("+e+","+e+")",i=e,u.style.width=t*i+"px",u.style.height=r*i+"px"},this.getScale=function(){return i},this.flatten=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height;var t=e.getContext("2d");return function e(n,r,i){if(n.width>0&&n.height>0){var o=t.globalAlpha;t.globalAlpha*=n.alpha/255,t.drawImage(n.getCanvas(),r,i);for(var a=function(e){var t=[];for(var n in e.children)t.push(e.children[n]);return t.sort(function(e,t){var n=e.z-t.z;if(0!==n)return n;var r=e.getElement(),i=t.getElement().compareDocumentPosition(r);return i&Node.DOCUMENT_POSITION_PRECEDING?-1:i&Node.DOCUMENT_POSITION_FOLLOWING?1:0}),t}(n),s=0;s<a.length;s++){var u=a[s];e(u,r+u.x,i+u.y)}t.globalAlpha=o}}(a,0,0),e}},n.Display.VisibleLayer=function(e,t){n.Layer.apply(this,[e,t]);var r=this;this.__unique_id=n.Display.VisibleLayer.__next_id++,this.alpha=255,this.x=0,this.y=0,this.z=0,this.matrix=[1,0,0,1,0,0],this.parent=null,this.children={};var i=r.getCanvas();i.style.position="absolute",i.style.left="0px",i.style.top="0px";var o=document.createElement("div");o.appendChild(i),o.style.width=e+"px",o.style.height=t+"px",o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.overflow="hidden";var a=this.resize;this.resize=function(e,t){o.style.width=e+"px",o.style.height=t+"px",a(e,t)},this.getElement=function(){return o};var s="translate(0px, 0px)",u="matrix(1, 0, 0, 1, 0, 0)";this.translate=function(e,t){r.x=e,r.y=t,s="translate("+e+"px,"+t+"px)",o.style.transform=o.style.WebkitTransform=o.style.MozTransform=o.style.OTransform=o.style.msTransform=s+" "+u},this.move=function(e,t,n,i){r.parent!==e&&(r.parent&&delete r.parent.children[r.__unique_id],r.parent=e,e.children[r.__unique_id]=r,e.getElement().appendChild(o));r.translate(t,n),r.z=i,o.style.zIndex=i},this.shade=function(e){r.alpha=e,o.style.opacity=e/255},this.dispose=function(){r.parent&&(delete r.parent.children[r.__unique_id],r.parent=null),o.parentNode&&o.parentNode.removeChild(o)},this.distort=function(e,t,n,i,a,l){r.matrix=[e,t,n,i,a,l],u="matrix("+e+","+t+","+n+","+i+","+a+","+l+")",o.style.transform=o.style.WebkitTransform=o.style.MozTransform=o.style.OTransform=o.style.msTransform=s+" "+u}},n.Display.VisibleLayer.__next_id=0,(n=n||{}).InputSink=function(){var e=this,t=document.createElement("textarea");t.style.position="fixed",t.style.outline="none",t.style.border="none",t.style.margin="0",t.style.padding="0",t.style.height="0",t.style.width="0",t.style.left="0",t.style.bottom="0",t.style.resize="none",t.style.background="transparent",t.style.color="transparent",t.addEventListener("keypress",function(e){t.value=""},!1),t.addEventListener("compositionend",function(e){e.data&&(t.value="")},!1),t.addEventListener("input",function(e){e.data&&!e.isComposing&&(t.value="")},!1),t.addEventListener("focus",function(){window.setTimeout(function(){t.click(),t.select()},0)},!0),this.focus=function(){window.setTimeout(function(){t.focus()},0)},this.getElement=function(){return t},document.addEventListener("keydown",function(t){var n=document.activeElement;if(n&&n!==document.body){var r=n.getBoundingClientRect();if(r.left+r.width>0&&r.top+r.height>0)return}e.focus()},!0)},(n=n||{}).InputStream=function(e,t){var n=this;this.index=t,this.onblob=null,this.onend=null,this.sendAck=function(t,r){e.sendAck(n.index,t,r)}},(n=n||{}).IntegerPool=function(){var e=this,t=[];this.next_int=0,this.next=function(){return t.length>0?t.shift():e.next_int++},this.free=function(e){t.push(e)}},(n=n||{}).JSONReader=function(e){var t=this,r=new n.StringReader(e),i="";this.getLength=function(){return i.length},this.getJSON=function(){return JSON.parse(i)},r.ontext=function(e){i+=e,t.onprogress&&t.onprogress(e.length)},r.onend=function(){t.onend&&t.onend()},this.onprogress=null,this.onend=null},(n=n||{}).Keyboard=function(e){var t=this,r="_GUAC_KEYBOARD_HANDLED_BY_"+n.Keyboard._nextID++;this.onkeydown=null,this.onkeyup=null;var i={keyupUnreliable:!1,altIsTypableOnly:!1,capsLockKeyupUnreliable:!1};navigator&&navigator.platform&&(navigator.platform.match(/ipad|iphone|ipod/i)?i.keyupUnreliable=!0:navigator.platform.match(/^mac/i)&&(i.altIsTypableOnly=!0,i.capsLockKeyupUnreliable=!0));var o=function(){var e=this;this.timestamp=(new Date).getTime(),this.defaultPrevented=!1,this.keysym=null,this.reliable=!1,this.getAge=function(){return(new Date).getTime()-e.timestamp}},a=function(e,n,r,a){o.apply(this),this.keyCode=e,this.keyIdentifier=n,this.key=r,this.location=a,this.keysym=S(r,a)||T(e,a),this.keyupReliable=!i.keyupUnreliable,this.keysym&&!w(this.keysym)&&(this.reliable=!0),!this.keysym&&I(e,n)&&(this.keysym=S(n,a,t.modifiers.shift)),t.modifiers.meta&&65511!==this.keysym&&65512!==this.keysym?this.keyupReliable=!1:65509===this.keysym&&i.capsLockKeyupUnreliable&&(this.keyupReliable=!1);var s=!t.modifiers.ctrl&&!i.altIsTypableOnly;(!t.modifiers.alt&&t.modifiers.ctrl||s&&t.modifiers.alt||t.modifiers.meta||t.modifiers.hyper)&&(this.reliable=!0),m[e]=this.keysym};a.prototype=new o;var s=function(e){o.apply(this),this.charCode=e,this.keysym=b(e),this.reliable=!0};s.prototype=new o;var u=function(e,n,r,i){o.apply(this),this.keyCode=e,this.keyIdentifier=n,this.key=r,this.location=i,this.keysym=T(e,i)||S(r,i),t.pressed[this.keysym]||(this.keysym=m[e]||this.keysym),this.reliable=!0};u.prototype=new o;var l=[],c={8:[65288],9:[65289],12:[65291,65291,65291,65461],13:[65293],16:[65505,65505,65506],17:[65507,65507,65508],18:[65513,65513,65027],19:[65299],20:[65509],27:[65307],32:[32],33:[65365,65365,65365,65465],34:[65366,65366,65366,65459],35:[65367,65367,65367,65457],36:[65360,65360,65360,65463],37:[65361,65361,65361,65460],38:[65362,65362,65362,65464],39:[65363,65363,65363,65462],40:[65364,65364,65364,65458],45:[65379,65379,65379,65456],46:[65535,65535,65535,65454],91:[65515],92:[65383],93:null,96:[65456],97:[65457],98:[65458],99:[65459],100:[65460],101:[65461],102:[65462],103:[65463],104:[65464],105:[65465],106:[65450],107:[65451],109:[65453],110:[65454],111:[65455],112:[65470],113:[65471],114:[65472],115:[65473],116:[65474],117:[65475],118:[65476],119:[65477],120:[65478],121:[65479],122:[65480],123:[65481],144:[65407],145:[65300],225:[65027]},d={Again:[65382],AllCandidates:[65341],Alphanumeric:[65328],Alt:[65513,65513,65027],Attn:[64782],AltGraph:[65027],ArrowDown:[65364],ArrowLeft:[65361],ArrowRight:[65363],ArrowUp:[65362],Backspace:[65288],CapsLock:[65509],Cancel:[65385],Clear:[65291],Convert:[65313],Copy:[64789],Crsel:[64796],CrSel:[64796],CodeInput:[65335],Compose:[65312],Control:[65507,65507,65508],ContextMenu:[65383],Delete:[65535],Down:[65364],End:[65367],Enter:[65293],EraseEof:[64774],Escape:[65307],Execute:[65378],Exsel:[64797],ExSel:[64797],F1:[65470],F2:[65471],F3:[65472],F4:[65473],F5:[65474],F6:[65475],F7:[65476],F8:[65477],F9:[65478],F10:[65479],F11:[65480],F12:[65481],F13:[65482],F14:[65483],F15:[65484],F16:[65485],F17:[65486],F18:[65487],F19:[65488],F20:[65489],F21:[65490],F22:[65491],F23:[65492],F24:[65493],Find:[65384],GroupFirst:[65036],GroupLast:[65038],GroupNext:[65032],GroupPrevious:[65034],FullWidth:null,HalfWidth:null,HangulMode:[65329],Hankaku:[65321],HanjaMode:[65332],Help:[65386],Hiragana:[65317],HiraganaKatakana:[65319],Home:[65360],Hyper:[65517,65517,65518],Insert:[65379],JapaneseHiragana:[65317],JapaneseKatakana:[65318],JapaneseRomaji:[65316],JunjaMode:[65336],KanaMode:[65325],KanjiMode:[65313],Katakana:[65318],Left:[65361],Meta:[65511,65511,65512],ModeChange:[65406],NumLock:[65407],PageDown:[65366],PageUp:[65365],Pause:[65299],Play:[64790],PreviousCandidate:[65342],PrintScreen:[65377],Redo:[65382],Right:[65363],RomanCharacters:null,Scroll:[65300],Select:[65376],Separator:[65452],Shift:[65505,65505,65506],SingleCandidate:[65340],Super:[65515,65515,65516],Tab:[65289],UIKeyInputDownArrow:[65364],UIKeyInputEscape:[65307],UIKeyInputLeftArrow:[65361],UIKeyInputRightArrow:[65363],UIKeyInputUpArrow:[65362],Up:[65362],Undo:[65381],Win:[65515],Zenkaku:[65320],ZenkakuHankaku:[65322]},f={65027:!0,65505:!0,65506:!0,65507:!0,65508:!0,65509:!0,65511:!0,65512:!0,65513:!0,65514:!0,65515:!0,65516:!0};this.modifiers=new n.Keyboard.ModifierState,this.pressed={};var h={},p={},m={},g=null,v=null,y=function(e,t){return e?e[t]||e[0]:null},w=function(e){return e>=0&&e<=255||16777216==(4294901760&e)};function S(e,t,n){if(!e)return null;var r,i=e.indexOf("U+");if(i>=0){var o=e.substring(i+2);r=String.fromCharCode(parseInt(o,16))}else{if(1!==e.length||3===t)return y(d[e],t);r=e}return!0===n?r=r.toUpperCase():!1===n&&(r=r.toLowerCase()),b(r.charCodeAt(0))}function b(e){return function(e){return e<=31||e>=127&&e<=159}(e)?65280|e:e>=0&&e<=255?e:e>=256&&e<=1114111?16777216|e:null}function T(e,t){return y(c[e],t)}var I=function(e,t){if(!t)return!1;var n=t.indexOf("U+");return-1===n||(e!==parseInt(t.substring(n+2),16)||(e>=65&&e<=90||e>=48&&e<=57))};this.press=function(e){if(null!==e){if(!t.pressed[e]&&(t.pressed[e]=!0,t.onkeydown)){var n=t.onkeydown(e);return p[e]=n,window.clearTimeout(g),window.clearInterval(v),f[e]||(g=window.setTimeout(function(){v=window.setInterval(function(){t.onkeyup(e),t.onkeydown(e)},50)},500)),n}return p[e]||!1}},this.release=function(e){t.pressed[e]&&(delete t.pressed[e],delete h[e],window.clearTimeout(g),window.clearInterval(v),null!==e&&t.onkeyup&&t.onkeyup(e))},this.type=function(e){for(var n=0;n<e.length;n++){var r=b(e.codePointAt?e.codePointAt(n):e.charCodeAt(n));t.press(r),t.release(r)}},this.reset=function(){for(var e in t.pressed)t.release(parseInt(e));l=[]};var C=function(e,n,r,i){var o;if(-1===r.indexOf(i.keysym))if(e&&!1===n)for(o=0;o<r.length;o++)t.release(r[o]);else if(!e&&n){for(o=0;o<r.length;o++)if(t.pressed[r[o]])return;var a=r[0];i.keysym&&(h[a]=!0),t.press(a)}},k=function(e,r){var i=n.Keyboard.ModifierState.fromKeyboardEvent(e);C(t.modifiers.alt,i.alt,[65513,65514,65027],r),C(t.modifiers.shift,i.shift,[65505,65506],r),C(t.modifiers.ctrl,i.ctrl,[65507,65508],r),C(t.modifiers.meta,i.meta,[65511,65512],r),C(t.modifiers.hyper,i.hyper,[65515,65516],r),t.modifiers=i},E=function(){for(var e in t.pressed)if(!h[e])return!1;return!0};function x(){var e,n=L();if(!n)return!1;do{e=n,n=L()}while(null!==n);return E()&&t.reset(),e.defaultPrevented}var L=function(){var e=l[0];if(!e)return null;if(!(e instanceof a))return e instanceof u&&!i.keyupUnreliable?(n=e.keysym)?(t.release(n),delete m[e.keyCode],e.defaultPrevented=!0,l.shift()):(t.reset(),e):l.shift();var n=null,r=[];if(e.reliable?(n=e.keysym,r=l.splice(0,1)):l[1]instanceof s?(n=l[1].keysym,r=l.splice(0,2)):l[1]&&(n=e.keysym,r=l.splice(0,1)),r.length>0){if(n){!function(e){t.modifiers.ctrl&&t.modifiers.alt&&(e>=65&&e<=90||e>=97&&e<=122||(e<=255||16777216==(4278190080&e))&&(t.release(65507),t.release(65508),t.release(65513),t.release(65514)))}(n);var o=!t.press(n);m[e.keyCode]=n,e.keyupReliable||t.release(n);for(var c=0;c<r.length;c++)r[c].defaultPrevented=o}return e}return null},A=function(e){return"location"in e?e.location:"keyLocation"in e?e.keyLocation:0},R=function(e){return!e[r]&&(e[r]=!0,!0)};this.listenTo=function(e){e.addEventListener("keydown",function(e){if(t.onkeydown&&R(e)){var n;window.event?n=window.event.keyCode:e.which&&(n=e.which);var r=new a(n,e.keyIdentifier,e.key,A(e));k(e,r),229!==n&&(l.push(r),x()&&e.preventDefault())}},!0),e.addEventListener("keypress",function(e){if((t.onkeydown||t.onkeyup)&&R(e)){var n;window.event?n=window.event.keyCode:e.which&&(n=e.which);var r=new s(n);k(e,r),l.push(r),x()&&e.preventDefault()}},!0),e.addEventListener("keyup",function(e){if(t.onkeyup&&R(e)){var n;e.preventDefault(),window.event?n=window.event.keyCode:e.which&&(n=e.which);var r=new u(n,e.keyIdentifier,e.key,A(e));k(e,r),l.push(r),x()}},!0);var n=function(n){(t.onkeydown||t.onkeyup)&&R(n)&&n.data&&!n.isComposing&&(e.removeEventListener("compositionend",r,!1),t.type(n.data))},r=function(r){(t.onkeydown||t.onkeyup)&&R(r)&&r.data&&(e.removeEventListener("input",n,!1),t.type(r.data))};e.addEventListener("input",n,!1),e.addEventListener("compositionend",r,!1)},e&&t.listenTo(e)},n.Keyboard._nextID=0,n.Keyboard.ModifierState=function(){this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.hyper=!1},n.Keyboard.ModifierState.fromKeyboardEvent=function(e){var t=new n.Keyboard.ModifierState;return t.shift=e.shiftKey,t.ctrl=e.ctrlKey,t.alt=e.altKey,t.meta=e.metaKey,e.getModifierState&&(t.hyper=e.getModifierState("OS")||e.getModifierState("Super")||e.getModifierState("Hyper")||e.getModifierState("Win")),t},(n=n||{}).Layer=function(e,t){var r=this,i=document.createElement("canvas"),o=i.getContext("2d");o.save();var a=!0,s=!0,u=0,l={1:"destination-in",2:"destination-out",4:"source-in",6:"source-atop",8:"source-out",9:"destination-atop",10:"xor",11:"destination-over",12:"copy",14:"source-over",15:"lighter"},c=function(e,t){e=e||0,t=t||0;var n=64*Math.ceil(e/64),s=64*Math.ceil(t/64);if(i.width!==n||i.height!==s){var l=null;if(!a&&0!==i.width&&0!==i.height)(l=document.createElement("canvas")).width=Math.min(r.width,e),l.height=Math.min(r.height,t),l.getContext("2d").drawImage(i,0,0,l.width,l.height,0,0,l.width,l.height);var c=o.globalCompositeOperation;i.width=n,i.height=s,l&&o.drawImage(l,0,0,l.width,l.height,0,0,l.width,l.height),o.globalCompositeOperation=c,u=0,o.save()}else r.reset();r.width=e,r.height=t};function d(e,t,n,i){var o,a,s=n+e,u=i+t;o=s>r.width?s:r.width,a=u>r.height?u:r.height,r.resize(o,a)}this.autosize=!1,this.width=e,this.height=t,this.getCanvas=function(){return i},this.toCanvas=function(){var e=document.createElement("canvas");return e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r.getCanvas(),0,0),e},this.resize=function(e,t){e===r.width&&t===r.height||c(e,t)},this.drawImage=function(e,t,n){r.autosize&&d(e,t,n.width,n.height),o.drawImage(n,e,t),a=!1},this.transfer=function(e,t,i,s,u,l,c,f){var h=e.getCanvas();if(!(t>=h.width||i>=h.height)&&(t+s>h.width&&(s=h.width-t),i+u>h.height&&(u=h.height-i),0!==s&&0!==u)){r.autosize&&d(l,c,s,u);for(var p=e.getCanvas().getContext("2d").getImageData(t,i,s,u),m=o.getImageData(l,c,s,u),g=0;g<s*u*4;g+=4){var v=new n.Layer.Pixel(p.data[g],p.data[g+1],p.data[g+2],p.data[g+3]),y=new n.Layer.Pixel(m.data[g],m.data[g+1],m.data[g+2],m.data[g+3]);f(v,y),m.data[g]=y.red,m.data[g+1]=y.green,m.data[g+2]=y.blue,m.data[g+3]=y.alpha}o.putImageData(m,l,c),a=!1}},this.put=function(e,t,n,i,s,u,l){var c=e.getCanvas();if(!(t>=c.width||n>=c.height)&&(t+i>c.width&&(i=c.width-t),n+s>c.height&&(s=c.height-n),0!==i&&0!==s)){r.autosize&&d(u,l,i,s);var f=e.getCanvas().getContext("2d").getImageData(t,n,i,s);o.putImageData(f,u,l),a=!1}},this.copy=function(e,t,n,i,s,u,l){var c=e.getCanvas();t>=c.width||n>=c.height||(t+i>c.width&&(i=c.width-t),n+s>c.height&&(s=c.height-n),0!==i&&0!==s&&(r.autosize&&d(u,l,i,s),o.drawImage(c,t,n,i,s,u,l,i,s),a=!1))},this.moveTo=function(e,t){s&&(o.beginPath(),s=!1),r.autosize&&d(e,t,0,0),o.moveTo(e,t)},this.lineTo=function(e,t){s&&(o.beginPath(),s=!1),r.autosize&&d(e,t,0,0),o.lineTo(e,t)},this.arc=function(e,t,n,i,a,u){s&&(o.beginPath(),s=!1),r.autosize&&d(e,t,0,0),o.arc(e,t,n,i,a,u)},this.curveTo=function(e,t,n,i,a,u){s&&(o.beginPath(),s=!1),r.autosize&&d(a,u,0,0),o.bezierCurveTo(e,t,n,i,a,u)},this.close=function(){o.closePath(),s=!0},this.rect=function(e,t,n,i){s&&(o.beginPath(),s=!1),r.autosize&&d(e,t,n,i),o.rect(e,t,n,i)},this.clip=function(){o.clip(),s=!0},this.strokeColor=function(e,t,n,r,i,u,l){o.lineCap=e,o.lineJoin=t,o.lineWidth=n,o.strokeStyle="rgba("+r+","+i+","+u+","+l/255+")",o.stroke(),a=!1,s=!0},this.fillColor=function(e,t,n,r){o.fillStyle="rgba("+e+","+t+","+n+","+r/255+")",o.fill(),a=!1,s=!0},this.strokeLayer=function(e,t,n,r){o.lineCap=e,o.lineJoin=t,o.lineWidth=n,o.strokeStyle=o.createPattern(r.getCanvas(),"repeat"),o.stroke(),a=!1,s=!0},this.fillLayer=function(e){o.fillStyle=o.createPattern(e.getCanvas(),"repeat"),o.fill(),a=!1,s=!0},this.push=function(){o.save(),u++},this.pop=function(){u>0&&(o.restore(),u--)},this.reset=function(){for(;u>0;)o.restore(),u--;o.restore(),o.save(),o.beginPath(),s=!1},this.setTransform=function(e,t,n,r,i,a){o.setTransform(e,t,n,r,i,a)},this.transform=function(e,t,n,r,i,a){o.transform(e,t,n,r,i,a)},this.setChannelMask=function(e){o.globalCompositeOperation=l[e]},this.setMiterLimit=function(e){o.miterLimit=e},c(e,t),i.style.zIndex=-1},n.Layer.ROUT=2,n.Layer.ATOP=6,n.Layer.XOR=10,n.Layer.ROVER=11,n.Layer.OVER=14,n.Layer.PLUS=15,n.Layer.RIN=1,n.Layer.IN=4,n.Layer.OUT=8,n.Layer.RATOP=9,n.Layer.SRC=12,n.Layer.Pixel=function(e,t,n,r){this.red=e,this.green=t,this.blue=n,this.alpha=r},(n=n||{}).Mouse=function(e){var t=this;this.touchMouseThreshold=3,this.scrollThreshold=53,this.PIXELS_PER_LINE=18,this.PIXELS_PER_PAGE=16*this.PIXELS_PER_LINE,this.currentState=new n.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null,this.onmouseout=null;var r=0,i=0;function o(e){e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function a(){r=t.touchMouseThreshold}function s(e){var n=e.deltaY||-e.wheelDeltaY||-e.wheelDelta;if(n?1===e.deltaMode?n=e.deltaY*t.PIXELS_PER_LINE:2===e.deltaMode&&(n=e.deltaY*t.PIXELS_PER_PAGE):n=e.detail*t.PIXELS_PER_LINE,(i+=n)<=-t.scrollThreshold){do{t.onmousedown&&(t.currentState.up=!0,t.onmousedown(t.currentState)),t.onmouseup&&(t.currentState.up=!1,t.onmouseup(t.currentState)),i+=t.scrollThreshold}while(i<=-t.scrollThreshold);i=0}if(i>=t.scrollThreshold){do{t.onmousedown&&(t.currentState.down=!0,t.onmousedown(t.currentState)),t.onmouseup&&(t.currentState.down=!1,t.onmouseup(t.currentState)),i-=t.scrollThreshold}while(i>=t.scrollThreshold);i=0}o(e)}e.addEventListener("contextmenu",function(e){o(e)},!1),e.addEventListener("mousemove",function(n){o(n),r?r--:(t.currentState.fromClientPosition(e,n.clientX,n.clientY),t.onmousemove&&t.onmousemove(t.currentState))},!1),e.addEventListener("mousedown",function(e){if(o(e),!r){switch(e.button){case 0:t.currentState.left=!0;break;case 1:t.currentState.middle=!0;break;case 2:t.currentState.right=!0}t.onmousedown&&t.onmousedown(t.currentState)}},!1),e.addEventListener("mouseup",function(e){if(o(e),!r){switch(e.button){case 0:t.currentState.left=!1;break;case 1:t.currentState.middle=!1;break;case 2:t.currentState.right=!1}t.onmouseup&&t.onmouseup(t.currentState)}},!1),e.addEventListener("mouseout",function(n){n||(n=window.event);for(var r=n.relatedTarget||n.toElement;r;){if(r===e)return;r=r.parentNode}o(n),(t.currentState.left||t.currentState.middle||t.currentState.right)&&(t.currentState.left=!1,t.currentState.middle=!1,t.currentState.right=!1,t.onmouseup&&t.onmouseup(t.currentState)),t.onmouseout&&t.onmouseout()},!1),e.addEventListener("selectstart",function(e){o(e)},!1),e.addEventListener("touchmove",a,!1),e.addEventListener("touchstart",a,!1),e.addEventListener("touchend",a,!1),e.addEventListener("DOMMouseScroll",s,!1),e.addEventListener("mousewheel",s,!1),e.addEventListener("wheel",s,!1);var u=function(){var e=document.createElement("div");if(!("cursor"in e.style))return!1;try{e.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==) 0 0, auto"}catch(e){return!1}return/\burl\([^()]*\)\s+0\s+0\b/.test(e.style.cursor||"")}();this.setCursor=function(t,n,r){if(u){var i=t.toDataURL("image/png");return e.style.cursor="url("+i+") "+n+" "+r+", auto",!0}return!1}},n.Mouse.State=function(e,t,n,r,i,o,a){var s=this;this.x=e,this.y=t,this.left=n,this.middle=r,this.right=i,this.up=o,this.down=a,this.fromClientPosition=function(e,t,n){s.x=t-e.offsetLeft,s.y=n-e.offsetTop;for(var r=e.offsetParent;r&&r!==document.body;)s.x-=r.offsetLeft-r.scrollLeft,s.y-=r.offsetTop-r.scrollTop,r=r.offsetParent;if(r){var i=document.body.scrollLeft||document.documentElement.scrollLeft,o=document.body.scrollTop||document.documentElement.scrollTop;s.x-=r.offsetLeft-i,s.y-=r.offsetTop-o}}},n.Mouse.Touchpad=function(e){var t=this;this.scrollThreshold=20*(window.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=10*(window.devicePixelRatio||1),this.currentState=new n.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null;var r=0,i=0,o=0,a=0,s=0,u={1:"left",2:"right",3:"middle"},l=!1,c=null;e.addEventListener("touchend",function(e){if(e.preventDefault(),l&&0===e.touches.length){var n=(new Date).getTime(),i=u[r];t.currentState[i]&&(t.currentState[i]=!1,t.onmouseup&&t.onmouseup(t.currentState),c&&(window.clearTimeout(c),c=null)),n-a<=t.clickTimingThreshold&&s<t.clickMoveThreshold&&(t.currentState[i]=!0,t.onmousedown&&t.onmousedown(t.currentState),c=window.setTimeout(function(){t.currentState[i]=!1,t.onmouseup&&t.onmouseup(t.currentState),l=!1},t.clickTimingThreshold)),c||(l=!1)}},!1),e.addEventListener("touchstart",function(e){if(e.preventDefault(),r=Math.min(e.touches.length,3),c&&(window.clearTimeout(c),c=null),!l){l=!0;var t=e.touches[0];i=t.clientX,o=t.clientY,a=(new Date).getTime(),s=0}},!1),e.addEventListener("touchmove",function(n){n.preventDefault();var u=n.touches[0],l=u.clientX-i,c=u.clientY-o;if(s+=Math.abs(l)+Math.abs(c),1===r){var d=1+s/((new Date).getTime()-a);t.currentState.x+=l*d,t.currentState.y+=c*d,t.currentState.x<0?t.currentState.x=0:t.currentState.x>=e.offsetWidth&&(t.currentState.x=e.offsetWidth-1),t.currentState.y<0?t.currentState.y=0:t.currentState.y>=e.offsetHeight&&(t.currentState.y=e.offsetHeight-1),t.onmousemove&&t.onmousemove(t.currentState),i=u.clientX,o=u.clientY}else if(2===r){var f;if(Math.abs(c)>=t.scrollThreshold)f=c>0?"down":"up",t.currentState[f]=!0,t.onmousedown&&t.onmousedown(t.currentState),t.currentState[f]=!1,t.onmouseup&&t.onmouseup(t.currentState),i=u.clientX,o=u.clientY}},!1)},n.Mouse.Touchscreen=function(e){var t=this,r=!1,i=null,o=null,a=null,s=null;function u(e){t.currentState[e]||(t.currentState[e]=!0,t.onmousedown&&t.onmousedown(t.currentState))}function l(e){t.currentState[e]&&(t.currentState[e]=!1,t.onmouseup&&t.onmouseup(t.currentState))}function c(n,r){t.currentState.fromClientPosition(e,n,r),t.onmousemove&&t.onmousemove(t.currentState)}function d(e){var n=e.touches[0]||e.changedTouches[0],r=n.clientX-i,a=n.clientY-o;return Math.sqrt(r*r+a*a)>=t.clickMoveThreshold}function f(){window.clearTimeout(a),window.clearTimeout(s),r=!1}this.scrollThreshold=20*(window.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=16*(window.devicePixelRatio||1),this.longPressThreshold=500,this.currentState=new n.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null,e.addEventListener("touchend",function(e){if(r)if(0===e.touches.length&&1===e.changedTouches.length){if(window.clearTimeout(s),l("left"),!d(e)&&(e.preventDefault(),!t.currentState.left)){var n=e.changedTouches[0];c(n.clientX,n.clientY),u("left"),a=window.setTimeout(function(){l("left"),f()},t.clickTimingThreshold)}}else f()},!1),e.addEventListener("touchstart",function(e){1===e.touches.length?(e.preventDefault(),function(e){var t=e.touches[0];r=!0,i=t.clientX,o=t.clientY}(e),window.clearTimeout(a),s=window.setTimeout(function(){var t,n=e.touches[0];c(n.clientX,n.clientY),u(t="right"),l(t),f()},t.longPressThreshold)):f()},!1),e.addEventListener("touchmove",function(e){if(r)if(d(e)&&window.clearTimeout(s),1===e.touches.length){if(t.currentState.left){e.preventDefault();var n=e.touches[0];c(n.clientX,n.clientY)}}else f()},!1)},(n=(n=n||{})||{}).Object=function(e,t){var n=this,r={};this.index=t,this.onbody=function(e,t,n){var i=function(e){var t=r[e];if(!t)return null;var n=t.shift();return 0===t.length&&delete r[e],n}(n);i&&i(e,t)},this.onundefine=null,this.requestInputStream=function(t,i){i&&function(e,t){var n=r[e];n||(n=[],r[e]=n),n.push(t)}(t,i),e.requestObjectInputStream(n.index,t)},this.createOutputStream=function(t,r){return e.createObjectOutputStream(n.index,t,r)}},n.Object.ROOT_STREAM="/",n.Object.STREAM_INDEX_MIMETYPE="application/vnd.glyptodon.guacamole.stream-index+json",(n=n||{}).OnScreenKeyboard=function(e){var t=this,r={},i={},o=[],a=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},s=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(/([^ ]+)[ ]*/g,function(e,n){return n===t?"":e})},u=0,l=function(e,t,n,r){this.width=t,this.height=n,this.scale=function(i){e.style.width=t*i+"px",e.style.height=n*i+"px",r&&(e.style.lineHeight=n*i+"px",e.style.fontSize=i+"px")}},c=function(e){for(var t=0;t<e.length;t++){if(!(e[t]in r))return!1}return!0},d=function(e){var n=t.keys[e];if(!n)return null;for(var r=n.length-1;r>=0;r--){var i=n[r];if(c(i.requires))return i}return null},f=function(e,n){if(!i[e]){a(n,"guac-keyboard-pressed");var o=d(e);if(o.modifier){var u="guac-keyboard-modifier-"+g(o.modifier),l=r[o.modifier];l?(s(p,u),delete r[o.modifier],t.onkeyup&&t.onkeyup(l)):(a(p,u),r[o.modifier]=o.keysym,t.onkeydown&&t.onkeydown(o.keysym))}else t.onkeydown&&t.onkeydown(o.keysym);i[e]=!0}},h=function(e,n){if(i[e]){s(n,"guac-keyboard-pressed");var r=d(e);!r.modifier&&t.onkeyup&&t.onkeyup(r.keysym),i[e]=!1}},p=document.createElement("div");p.className="guac-keyboard",p.onselectstart=p.onmousemove=p.onmouseup=p.onmousedown=function(e){return u&&u--,e.stopPropagation(),!1},this.touchMouseThreshold=3,this.onkeydown=null,this.onkeyup=null,this.layout=new n.OnScreenKeyboard.Layout(e),this.getElement=function(){return p},this.resize=function(e){for(var n=Math.floor(10*e/t.layout.width)/10,r=0;r<o.length;r++){o[r].scale(n)}};var m=function(e,t){if(t instanceof Array){for(var r=[],i=0;i<t.length;i++)r.push(new n.OnScreenKeyboard.Key(t[i],e));return r}return"number"==typeof t?[new n.OnScreenKeyboard.Key({name:e,keysym:t})]:"string"==typeof t?[new n.OnScreenKeyboard.Key({name:e,title:t})]:[new n.OnScreenKeyboard.Key(t,e)]};this.keys=function(t){var n={};for(var r in e.keys)n[r]=m(r,t[r]);return n}(e.keys);var g=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[^A-Za-z0-9]+/g,"-").toLowerCase()};!function e(n,r,i){var s,c=document.createElement("div");if(i&&a(c,"guac-keyboard-"+g(i)),r instanceof Array)for(a(c,"guac-keyboard-group"),s=0;s<r.length;s++)e(c,r[s]);else if(r instanceof Object){a(c,"guac-keyboard-group");var d=Object.keys(r).sort();for(s=0;s<d.length;s++)i=d[s],e(c,r[i],i)}else if("number"==typeof r)a(c,"guac-keyboard-gap"),o.push(new l(c,r,r));else if("string"==typeof r){var p=r;1===p.length&&(p="0x"+p.charCodeAt(0).toString(16)),a(c,"guac-keyboard-key-container");var m=document.createElement("div");m.className="guac-keyboard-key guac-keyboard-key-"+g(p);var v=t.keys[r];if(v)for(s=0;s<v.length;s++){var y=v[s],w=document.createElement("div");w.className="guac-keyboard-cap",w.textContent=y.title;for(var S=0;S<y.requires.length;S++){var b=y.requires[S];a(w,"guac-keyboard-requires-"+g(b)),a(m,"guac-keyboard-uses-"+g(b))}m.appendChild(w)}c.appendChild(m),o.push(new l(c,t.layout.keyWidths[r]||1,1,!0));var T=function(e){e.preventDefault(),0===u&&h(r,m)};m.addEventListener("touchstart",function(e){e.preventDefault(),u=t.touchMouseThreshold,f(r,m)},!0),m.addEventListener("touchend",function(e){e.preventDefault(),u=t.touchMouseThreshold,h(r,m)},!0),m.addEventListener("mousedown",function(e){e.preventDefault(),0===u&&f(r,m)},!0),m.addEventListener("mouseup",T,!0),m.addEventListener("mouseout",T,!0)}n.appendChild(c)}(p,e.layout)},n.OnScreenKeyboard.Layout=function(e){this.language=e.language,this.type=e.type,this.keys=e.keys,this.layout=e.layout,this.width=e.width,this.keyWidths=e.keyWidths||{}},n.OnScreenKeyboard.Key=function(e,t){this.name=t||e.name,this.title=e.title||this.name,this.keysym=e.keysym||function(e){if(!e||1!==e.length)return null;var t=e.charCodeAt(0);return t>=0&&t<=255?t:t>=256&&t<=1114111?16777216|t:null}(this.title),this.modifier=e.modifier,this.requires=e.requires||[]},(n=n||{}).OutputStream=function(e,t){var n=this;this.index=t,this.onack=null,this.sendBlob=function(t){e.sendBlob(n.index,t)},this.sendEnd=function(){e.endStream(n.index)}},(n=n||{}).Parser=function(){var e=this,t="",n=[],r=-1,i=0;this.receive=function(o){for(i>4096&&r>=i&&(t=t.substring(i),r-=i,i=0),t+=o;r<t.length;){if(r>=i){var a=t.substring(i,r),s=t.substring(r,r+1);if(n.push(a),";"==s){var u=n.shift();null!=e.oninstruction&&e.oninstruction(u,n),n.length=0}else if(","!=s)throw new Error("Illegal terminator.");i=r+1}var l=t.indexOf(".",i);if(-1==l){i=t.length;break}var c=parseInt(t.substring(r+1,l));if(isNaN(c))throw new Error("Non-numeric character in element length.");r=(i=l+1)+c}},this.oninstruction=null},(n=n||{}).RawAudioFormat=function(e){this.bytesPerSample=e.bytesPerSample,this.channels=e.channels,this.rate=e.rate},n.RawAudioFormat.parse=function(e){var t,r=null,i=1;if("audio/L8;"===e.substring(0,9))e=e.substring(9),t=1;else{if("audio/L16;"!==e.substring(0,10))return null;e=e.substring(10),t=2}for(var o=e.split(","),a=0;a<o.length;a++){var s=o[a],u=s.indexOf("=");if(-1===u)return null;var l=s.substring(0,u),c=s.substring(u+1);switch(l){case"channels":i=parseInt(c);break;case"rate":r=parseInt(c);break;default:return null}}return null===r?null:new n.RawAudioFormat({bytesPerSample:t,channels:i,rate:r})},(n=n||{}).SessionRecording=function(e){var t=this,r=[],i=[],o=0,a=0,s=new n.SessionRecording._PlaybackTunnel,u=new n.Client(s),l=-1,c=null,d=null,f=null;u.connect(),u.getDisplay().showCursor(!1),e.oninstruction=function(e,s){var u=new n.SessionRecording._Frame.Instruction(e,s.slice());if(i.push(u),o+=u.getSize(),"sync"===e){var l=parseInt(s[0]),c=new n.SessionRecording._Frame(l,i);r.push(c),(1===r.length||o>=16384&&l-a>=5e3)&&(c.keyframe=!0,a=l,o=0),i=[],t.onprogress&&t.onprogress(t.getDuration())}};var h=function(e){return 0===r.length?0:e-r[0].timestamp},p=function(e){for(var t=r[e],n=0;n<t.instructions.length;n++){var i=t.instructions[n];s.receiveInstruction(i.opcode,i.args)}t.keyframe&&!t.clientState&&u.exportState(function(e){t.clientState=e})},m=function e(n,i,o){g(),f=window.setTimeout(function(){var a;for(a=n;a>=0;a--){var s=r[a];if(a===l)break;if(s.clientState){u.importState(s.clientState);break}}a++;for(var c=(new Date).getTime();a<=n;a++){if((new Date).getTime()-c>=5)break;p(a)}l=a-1,t.onseek&&t.onseek(t.getPosition()),l!==n?e(n,i,Math.max(o-((new Date).getTime()-c),0)):i()},o||0)},g=function(){window.clearTimeout(f)};this.onprogress=null,this.onplay=null,this.onpause=null,this.onseek=null,this.connect=function(t){e.connect(t)},this.disconnect=function(){e.disconnect()},this.getDisplay=function(){return u.getDisplay()},this.isPlaying=function(){return!!c},this.getPosition=function(){return-1===l?0:h(r[l].timestamp)},this.getDuration=function(){return 0===r.length?0:h(r[r.length-1].timestamp)},this.play=function(){if(!t.isPlaying()&&l+1<r.length){t.onplay&&t.onplay();var e=r[l+1];c=e.timestamp,d=(new Date).getTime(),function e(){if(l+1<r.length){var n=r[l+1].timestamp-c+d,i=Math.max(n-(new Date).getTime(),0);m(l+1,function(){e()},i)}else t.pause()}()}},this.seek=function(e,n){if(0!==r.length){var i=t.isPlaying();t.pause(),m(function e(t,n,i){if(t===n)return t;var o=Math.floor((t+n)/2),a=h(r[o].timestamp);return i<a&&o>t?e(t,o-1,i):i>a&&o<n?e(o+1,n,i):o}(0,r.length-1,e),function(){i&&t.play(),n&&n()})}},this.pause=function(){g(),t.isPlaying()&&(t.onpause&&t.onpause(),c=null,d=null)}},n.SessionRecording._Frame=function(e,t){this.keyframe=!1,this.timestamp=e,this.instructions=t,this.clientState=null},n.SessionRecording._Frame.Instruction=function(e,t){var n=this;this.opcode=e,this.args=t,this.getSize=function(){for(var e=n.opcode.length,t=0;t<n.args.length;t++)e+=n.args[t].length;return e}},n.SessionRecording._PlaybackTunnel=function(){var e=this;this.connect=function(e){},this.sendMessage=function(e){},this.disconnect=function(){},this.receiveInstruction=function(t,n){e.oninstruction&&e.oninstruction(t,n)}},(n=n||{}).Status=function(e,t){var n=this;this.code=e,this.message=t,this.isError=function(){return n.code<0||n.code>255}},n.Status.Code={SUCCESS:0,UNSUPPORTED:256,SERVER_ERROR:512,SERVER_BUSY:513,UPSTREAM_TIMEOUT:514,UPSTREAM_ERROR:515,RESOURCE_NOT_FOUND:516,RESOURCE_CONFLICT:517,RESOURCE_CLOSED:518,UPSTREAM_NOT_FOUND:519,UPSTREAM_UNAVAILABLE:520,SESSION_CONFLICT:521,SESSION_TIMEOUT:522,SESSION_CLOSED:523,CLIENT_BAD_REQUEST:768,CLIENT_UNAUTHORIZED:769,CLIENT_FORBIDDEN:771,CLIENT_TIMEOUT:776,CLIENT_OVERRUN:781,CLIENT_BAD_TYPE:783,CLIENT_TOO_MANY:797},n.Status.Code.fromHTTPCode=function(e){switch(e){case 400:return n.Status.Code.CLIENT_BAD_REQUEST;case 403:return n.Status.Code.CLIENT_FORBIDDEN;case 404:return n.Status.Code.RESOURCE_NOT_FOUND;case 429:return n.Status.Code.CLIENT_TOO_MANY;case 503:return n.Status.Code.SERVER_BUSY}return n.Status.Code.SERVER_ERROR},n.Status.Code.fromWebSocketCode=function(e){switch(e){case 1e3:return n.Status.Code.SUCCESS;case 1006:case 1015:return n.Status.Code.UPSTREAM_NOT_FOUND;case 1001:case 1012:case 1013:case 1014:return n.Status.Code.UPSTREAM_UNAVAILABLE}return n.Status.Code.SERVER_ERROR},(n=n||{}).StringReader=function(e){var t=this,r=new n.ArrayBufferReader(e),i=0,o=0;r.ondata=function(e){var n=function(e){for(var t="",n=new Uint8Array(e),r=0;r<n.length;r++){var a=n[r];0===i?127==(127|a)?t+=String.fromCharCode(a):223==(31|a)?(o=31&a,i=1):239==(15|a)?(o=15&a,i=2):247==(7|a)?(o=7&a,i=3):t+="�":191==(63|a)?(o=o<<6|63&a,0==--i&&(t+=String.fromCharCode(o))):(i=0,t+="�")}return t}(e);t.ontext&&t.ontext(n)},r.onend=function(){t.onend&&t.onend()},this.ontext=null,this.onend=null},(n=n||{}).StringWriter=function(e){var t=this,r=new n.ArrayBufferWriter(e),i=new Uint8Array(8192),o=0;function a(e){var t,n;if(e<=127)t=0,n=1;else if(e<=2047)t=192,n=2;else if(e<=65535)t=224,n=3;else{if(!(e<=2097151))return void a(65533);t=240,n=4}!function(e){if(o+e>=i.length){var t=new Uint8Array(2*(o+e));t.set(i),i=t}o+=e}(n);for(var r=o-1,s=1;s<n;s++)i[r--]=128|63&e,e>>=6;i[r]=t|e}r.onack=function(e){t.onack&&t.onack(e)},this.sendText=function(e){e.length&&r.sendData(function(e){for(var t=0;t<e.length;t++)a(e.charCodeAt(t));if(o>0){var n=i.subarray(0,o);return o=0,n}}(e))},this.sendEnd=function(){r.sendEnd()},this.onack=null},(n=n||{}).Tunnel=function(){this.connect=function(e){},this.disconnect=function(){},this.sendMessage=function(e){},this.setState=function(e){e!==this.state&&(this.state=e,this.onstatechange&&this.onstatechange(e))},this.isConnected=function(){return this.state===n.Tunnel.State.OPEN||this.state===n.Tunnel.State.UNSTABLE},this.state=n.Tunnel.State.CONNECTING,this.receiveTimeout=15e3,this.unstableThreshold=1500,this.uuid=null,this.onerror=null,this.onstatechange=null,this.oninstruction=null},n.Tunnel.INTERNAL_DATA_OPCODE="",n.Tunnel.State={CONNECTING:0,OPEN:1,CLOSED:2,UNSTABLE:3},n.HTTPTunnel=function(e,t,r){var i=this,o=e+"?connect",a=e+"?read:",s=e+"?write:",u=1,l=0,c=u,d=!1,f="",h=!!t,p=null,m=null,g=null,v=r||{};function y(e,t){for(var n in t)e.setRequestHeader(n,t[n])}function w(){window.clearTimeout(p),window.clearTimeout(m),i.state===n.Tunnel.State.UNSTABLE&&i.setState(n.Tunnel.State.OPEN),p=window.setTimeout(function(){S(new n.Status(n.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},i.receiveTimeout),m=window.setTimeout(function(){i.setState(n.Tunnel.State.UNSTABLE)},i.unstableThreshold)}function S(e){window.clearTimeout(p),window.clearTimeout(m),window.clearInterval(g),i.state!==n.Tunnel.State.CLOSED&&(e.code!==n.Status.Code.SUCCESS&&i.onerror&&(i.state!==n.Tunnel.State.CONNECTING&&e.code===n.Status.Code.RESOURCE_NOT_FOUND||i.onerror(e)),d=!1,i.setState(n.Tunnel.State.CLOSED))}function b(e){var t=parseInt(e.getResponseHeader("Guacamole-Status-Code"));if(t){var r=e.getResponseHeader("Guacamole-Error-Message");S(new n.Status(t,r))}else e.status?S(new n.Status(n.Status.Code.fromHTTPCode(e.status),e.statusText)):S(new n.Status(n.Status.Code.UPSTREAM_NOT_FOUND))}this.sendMessage=function(){if(i.isConnected()&&0!==arguments.length){for(var e=n(arguments[0]),t=1;t<arguments.length;t++)e+=","+n(arguments[t]);f+=e+=";",d||function e(){if(!i.isConnected())return;if(f.length>0){d=!0;var t=new XMLHttpRequest;t.open("POST",s+i.uuid),t.withCredentials=h,y(t,v),t.setRequestHeader("Content-type","application/octet-stream"),t.onreadystatechange=function(){4===t.readyState&&(w(),200!==t.status?b(t):e())},t.send(f),f=""}else d=!1}()}function n(e){var t=new String(e);return t.length+"."+t}};var T=0;function I(){var e=new XMLHttpRequest;return e.open("GET",a+i.uuid+":"+T++),e.withCredentials=h,y(e,v),e.send(null),e}this.connect=function(e){w(),i.setState(n.Tunnel.State.CONNECTING);var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&(200===t.status?(w(),i.uuid=t.responseText,i.setState(n.Tunnel.State.OPEN),g=setInterval(function(){i.sendMessage("nop")},500),function e(t){var n=null,r=null,o=0,a=-1,s=0,d=new Array;function f(){if(i.isConnected()){if(!(t.readyState<2)){var o;try{o=t.status}catch(e){o=200}if(r||200!==o||(r=I()),3===t.readyState||4===t.readyState){if(w(),c===u&&(3!==t.readyState||n?4===t.readyState&&n&&clearInterval(n):n=setInterval(f,30)),0===t.status)return void i.disconnect();if(200!==t.status)return void b(t);var l;try{l=t.responseText}catch(e){return}for(;a<l.length;){if(a>=s){var h=l.substring(s,a),p=l.substring(a,a+1);if(d.push(h),";"===p){var m=d.shift();i.oninstruction&&i.oninstruction(m,d),d.length=0}s=a+1}var g=l.indexOf(".",s);if(-1===g){s=l.length;break}var v=parseInt(l.substring(a+1,g));if(0===v){n&&clearInterval(n),t.onreadystatechange=null,t.abort(),r&&e(r);break}a=(s=g+1)+v}}}}else null!==n&&clearInterval(n)}t.onreadystatechange=c===u?function(){3===t.readyState&&++o>=2&&(c=l,t.onreadystatechange=f),f()}:f,f()}(I())):b(t))},t.open("POST",o,!0),t.withCredentials=h,y(t,v),t.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),t.send(e)},this.disconnect=function(){S(new n.Status(n.Status.Code.SUCCESS,"Manually closed."))}},n.HTTPTunnel.prototype=new n.Tunnel,n.WebSocketTunnel=function(e){var t=this,r=null,i=null,o=null,a=null;if("ws:"!==e.substring(0,3)&&"wss:"!==e.substring(0,4)){var s={"http:":"ws:","https:":"wss:"}[window.location.protocol];if("/"===e.substring(0,1))e=s+"//"+window.location.host+e;else{var u=window.location.pathname.lastIndexOf("/"),l=window.location.pathname.substring(0,u+1);e=s+"//"+window.location.host+l+e}}function c(){window.clearTimeout(i),window.clearTimeout(o),t.state===n.Tunnel.State.UNSTABLE&&t.setState(n.Tunnel.State.OPEN),i=window.setTimeout(function(){d(new n.Status(n.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},t.receiveTimeout),o=window.setTimeout(function(){t.setState(n.Tunnel.State.UNSTABLE)},t.unstableThreshold)}function d(e){window.clearTimeout(i),window.clearTimeout(o),window.clearInterval(a),t.state!==n.Tunnel.State.CLOSED&&(e.code!==n.Status.Code.SUCCESS&&t.onerror&&t.onerror(e),t.setState(n.Tunnel.State.CLOSED),r.close())}this.sendMessage=function(e){if(t.isConnected()&&0!==arguments.length){for(var n=o(arguments[0]),i=1;i<arguments.length;i++)n+=","+o(arguments[i]);n+=";",r.send(n)}function o(e){var t=new String(e);return t.length+"."+t}},this.connect=function(i){c(),t.setState(n.Tunnel.State.CONNECTING),(r=new WebSocket(e+"?"+i,"guacamole")).onopen=function(e){c(),a=setInterval(function(){t.sendMessage(n.Tunnel.INTERNAL_DATA_OPCODE,"ping",(new Date).getTime())},500)},r.onclose=function(e){e.reason?d(new n.Status(parseInt(e.reason),e.reason)):e.code?d(new n.Status(n.Status.Code.fromWebSocketCode(e.code))):d(new n.Status(n.Status.Code.UPSTREAM_NOT_FOUND))},r.onmessage=function(e){c();var r,i=e.data,o=0,a=[];do{var s=i.indexOf(".",o);if(-1!==s)r=(o=s+1)+parseInt(i.substring(r+1,s));else d(new n.Status(n.Status.Code.SERVER_ERROR,"Incomplete instruction."));var u=i.substring(o,r),l=i.substring(r,r+1);if(a.push(u),";"===l){var f=a.shift();null===t.uuid&&(f===n.Tunnel.INTERNAL_DATA_OPCODE&&(t.uuid=a[0]),t.setState(n.Tunnel.State.OPEN)),f!==n.Tunnel.INTERNAL_DATA_OPCODE&&t.oninstruction&&t.oninstruction(f,a),a.length=0}o=r+1}while(o<i.length)}},this.disconnect=function(){d(new n.Status(n.Status.Code.SUCCESS,"Manually closed."))}},n.WebSocketTunnel.prototype=new n.Tunnel,n.ChainedTunnel=function(e){for(var t,r=this,i=[],o=null,a=0;a<arguments.length;a++)i.push(arguments[a]);this.connect=function(e){t=e;var a=o||i.shift();a?function e(a){r.disconnect=a.disconnect,r.sendMessage=a.sendMessage;var s=function(t){if(t&&t.code===n.Status.Code.UPSTREAM_TIMEOUT)return i=[],null;var r=i.shift();return r&&(a.onerror=null,a.oninstruction=null,a.onstatechange=null,e(r)),r};function u(){a.onstatechange=r.onstatechange,a.oninstruction=r.oninstruction,a.onerror=r.onerror,r.uuid=a.uuid,o=a}a.onstatechange=function(e){switch(e){case n.Tunnel.State.OPEN:u(),r.onstatechange&&r.onstatechange(e);break;case n.Tunnel.State.CLOSED:!s()&&r.onstatechange&&r.onstatechange(e)}},a.oninstruction=function(e,t){u(),r.oninstruction&&r.oninstruction(e,t)},a.onerror=function(e){!s(e)&&r.onerror&&r.onerror(e)},a.connect(t)}(a):r.onerror&&r.onerror(n.Status.Code.SERVER_ERROR,"No tunnels to try.")}},n.ChainedTunnel.prototype=new n.Tunnel,n.StaticHTTPTunnel=function(e,t,r){var i=this,o=null,a=r||{};this.sendMessage=function(e){},this.connect=function(r){i.disconnect(),i.setState(n.Tunnel.State.CONNECTING),(o=new XMLHttpRequest).open("GET",e),o.withCredentials=!!t,function(e,t){for(var n in t)e.setRequestHeader(n,t[n])}(o,a),o.responseType="text",o.send(null);var s=0,u=new n.Parser;u.oninstruction=function(e,t){i.oninstruction&&i.oninstruction(e,t)},o.onreadystatechange=function(){if(3===o.readyState||4===o.readyState){i.setState(n.Tunnel.State.OPEN);var e=o.responseText,t=e.length;s<t&&(u.receive(e.substring(s)),s=t)}4===o.readyState&&i.disconnect()},o.onerror=function(){i.onerror&&i.onerror(new n.Status(n.Status.Code.fromHTTPCode(o.status),o.statusText)),i.disconnect()}},this.disconnect=function(){o&&(o.abort(),o=null),i.setState(n.Tunnel.State.CLOSED)}},n.StaticHTTPTunnel.prototype=new n.Tunnel,(n=n||{}).API_VERSION="1.1.0",(n=n||{}).VideoPlayer=function(){this.sync=function(){}},n.VideoPlayer.isSupportedType=function(e){return!1},n.VideoPlayer.getSupportedTypes=function(){return[]},n.VideoPlayer.getInstance=function(e,t,n){return null},e.exports=n},d2xv:function(e,t){},dBxi:function(e,t){},f1e3:function(e,t,n){"use strict";var r=n("VfK5"),i=n("Wtcz"),o=n("WXuS"),a=n("f9MG"),s=n("9Ntz"),u=n("n/58"),l=n("yBLB"),c=n("PsHI");i(i.S+i.F*!n("6sPN")(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,i,d,f=o(e),h="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m,v=0,y=c(f);if(g&&(m=r(m,p>2?arguments[2]:void 0,2)),void 0==y||h==Array&&s(y))for(n=new h(t=u(f.length));t>v;v++)l(n,v,g?m(f[v],v):f[v]);else for(d=y.call(f),n=new h;!(i=d.next()).done;v++)l(n,v,g?a(d,m,[i.value,v],!0):i.value);return n.length=v,n}})},kfHR:function(e,t,n){e.exports={default:n("5uZj"),__esModule:!0}},yBLB:function(e,t,n){"use strict";var r=n("hHwa"),i=n("gwUl");e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}}});