webpackJsonp([72],{"40nx":function(e,t){},"4Cbe":function(e,t){},hquN:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("3cXf"),l=a.n(s),n=a("1JPr"),o=a("ZLEe"),c=a.n(o),r=a("aA9S"),i=a.n(r),p={name:"pana-create-spec",props:{show:Boolean},methods:{closeModal:function(e){i()(this.$data,this.$options.data.call(this)),e=e||!1,this.$emit("closeModal",e)},initForm:function(){null!=this.$refs.form&&this.$refs.form.clearValidate()},createSpec:function(){this.disable=!0;var e=this,t={};this.$refs.form.validate(function(a){a?(c()(e.form).forEach(function(a){t[a]=e.form[a]}),t.ram=e.common.switchCapacity(e.form.ram,"gb","mb"),t.ram_max=2*t.ram,t.vcpus_max=2*e.form.vcpus,t=e.common.dropEmptyParameter(t),e.checkError(e.$http({url:e.api.management.post_flavors,method:"post",data:t}),function(){e.$notify({title:e.lang.common.success,type:"success",message:e.lang.spec.createSpecSuccess}),e.closeModal(!0)},function(){e.disable=!1})):e.disable=!1})},validateCpu:function(e,t,a){1===parseInt(t)||t%2==0?a():a(new Error(e.message))}},data:function(){return{labelWidth:"120px",form:{name:null,ram:1,vcpus:1,is_public:!0},rules:{name:[{required:!0,message:this.lang.spec.nameRequiredRule,trigger:"blur"},{min:1,max:32,message:this.lang.spec.nameLengthRule,trigger:"blur"}],vcpus:[{required:!0,message:this.lang.spec.cpuRequiredRule,trigger:"change"},{validator:this.common.validateNumberRange,min:1,max:240,message:this.common.formatMsg(this.lang.spec.cpuRangeRule,{cores:240}),trigger:"change"},{validator:this.validateCpu,message:this.lang.spec.cpuFormatRule,trigger:"change"},{validator:this.common.validateIntegerType,message:this.lang.spec.numberFormatRule,trigger:"change"}],ram:[{required:!0,message:this.lang.spec.ramRequiredRule,trigger:"change"},{validator:this.common.validateNumberRange,min:1,max:4e3,message:this.lang.spec.ramRangeRule,trigger:"change"},{validator:this.common.validateIntegerType,message:this.lang.spec.ramNumberRule,trigger:"change"}]},disable:!1}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.spec.createSpec,width:"45%",visible:e.show,modal:!0},on:{open:e.initForm,close:e.closeModal}},[a("el-form",{ref:"form",attrs:{"label-position":"right",model:e.form,rules:e.rules}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.common.name,"label-width":e.labelWidth,prop:"name"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.loadBalance.namePlaceholder},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.common.cpu,"label-width":e.labelWidth,prop:"vcpus"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.spec.integerPlaceholder},model:{value:e.form.vcpus,callback:function(t){e.$set(e.form,"vcpus",t)},expression:"form.vcpus"}})],1),e._v(" "),a("span",{staticClass:"unit"},[e._v(e._s(e.lang.spec.cores))])],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.common.memory,"label-width":e.labelWidth,prop:"ram"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{placeholder:e.lang.spec.integerPlaceholder},model:{value:e.form.ram,callback:function(t){e.$set(e.form,"ram",t)},expression:"form.ram"}})],1),e._v(" "),a("span",{staticClass:"unit"},[e._v(e._s(e.lang.common.gb))])],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.lang.spec.isShared,"label-width":e.labelWidth,prop:"is_public"}},[a("el-col",{attrs:{span:16}},[a("el-checkbox",{model:{value:e.form.is_public,callback:function(t){e.$set(e.form,"is_public",t)},expression:"form.is_public"}})],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.createSpec}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]};var u=a("C7Lr")(p,m,!1,function(e){a("4Cbe")},"data-v-50094b6e",null).exports,g={name:"pana-delete-spec",props:{show:Boolean},methods:{closeModal:function(e){e=e||!1,this.$emit("closeModal",e)},deleteSpec:function(){this.closeModal(!0)}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.lang.common.info,visible:e.show,width:"30%",modal:!0},on:{close:e.closeModal}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:10}},[e._v(e._s(e.lang.spec.deleteSpecInfo))])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v(e._s(e.lang.common.cancel))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteSpec}},[e._v(e._s(e.lang.common.confirm))])],1)],1)},staticRenderFns:[]},h=a("C7Lr")(g,d,!1,null,null,null).exports,f={name:"pana-spec-manage",components:{"pana-breadcrumb":n.a,"pana-create-spec":u,"pana-delete-spec":h},data:function(){return{pageSize:10,specSearch:"",specOrigin:[],specSelectionIds:[],specPage:1,showCreateSpec:!1,showDeleteSpec:!1,loading:!1}},computed:{specFilter:function(){var e=this;return this.specOrigin.filter(function(t){return""===e.specSearch||-1!==l()(t).search(e.specSearch)})},specTable:function(){return this.specFilter.length>this.pageSize?this.specFilter.slice((this.specPage-1)*this.pageSize,this.specPage*this.pageSize):this.specFilter}},methods:{switchSpecPage:function(e){this.specPage=e},sortChange:function(e){var t=null==e.order?0:"ascending"===e.order?1:-1;this.specOrigin=this.specOrigin.sort(function(a,s){switch(e.prop){case"ram":case"vcpus":return(a[e.prop]-s[e.prop])*t;default:return a[e.prop]=null==a[e.prop]?"":a[e.prop],s[e.prop]=null==s[e.prop]?"":s[e.prop],(a[e.prop]>s[e.prop]?1:-1)*t}})},closeCreateSpec:function(e){!0===e&&this.getSpecList(),this.showCreateSpec=!1},closeDeleteSpec:function(e){var t=this;this.showDeleteSpec=!1,!0===e&&this.checkError(this.$http({url:this.api.management.delete_flavors+this.common.formatGetUrl({fid:this.specSelectionIds}),method:"delete"}),function(){t.$notify({title:t.lang.common.success,type:"success",message:t.lang.spec.deleteSpecSuccess}),t.getSpecList()})},getSpecList:function(){var e=this;this.loading=!0,this.checkError(this.$http({url:this.api.management.get_flavors,method:"get"}),function(t){e.loading=!1,e.specOrigin=t.data},function(){e.loading=!1})},selectSpecIds:function(e){var t=[];e.forEach(function(e){t.push(e.id)}),this.specSelectionIds=t}},mounted:function(){this.getSpecList()},watch:{specSearch:function(){this.specPage=1}}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{type:"flex",direction:"vertical"}},[a("pana-breadcrumb"),e._v(" "),a("el-main",[a("el-row",{staticClass:"pana-btn-group",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showCreateSpec=!0}}},[e._v("\n                    "+e._s(e.lang.common.create)+"\n                ")]),e._v(" "),a("el-button",{attrs:{disabled:0===e.specSelectionIds.length},on:{click:function(t){e.showDeleteSpec=!0}}},[e._v("\n                    "+e._s(e.lang.common.delete)+"\n                ")])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-row",{staticClass:"search-row",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:22}},[a("el-input",{attrs:{placeholder:e.lang.common.search,"suffix-icon":"el-icon-search"},model:{value:e.specSearch,callback:function(t){e.specSearch=t},expression:"specSearch"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"fa fa-refresh",attrs:{type:"text",circle:""},on:{click:e.getSpecList}})],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"cloud-table",staticStyle:{width:"100%"},attrs:{"element-loading-text":e.lang.common.loading,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255, 255, 255)",data:e.specTable,"tooltip-effect":"dark"},on:{"selection-change":e.selectSpecIds,"sort-change":e.sortChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.common.name,sortable:"custom",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.common.cpu,sortable:"custom",prop:"vcpus"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.spec.memoryGb,sortable:"custom",prop:"ram"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                   "+e._s(e.common.switchCapacity(t.row.ram,"mb","gb"))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.spec.isShared,sortable:"custom",prop:"is_public"},scopedSlots:e._u([{key:"default",fn:function(t){return[!0===t.row.is_public?a("span",[e._v(e._s(e.lang.common.yes))]):a("span",[e._v(e._s(e.lang.common.no))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.lang.common.operation},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{attrs:{to:"/systemManage/specManage/detail/"+t.row.id}},[e._v("\n                        "+e._s(e.lang.common.check)+"\n                    ")])]}}])})],1),e._v(" "),a("el-row",{staticClass:"pana-pagination-row",attrs:{type:"flex",justify:"end"}},[e.specFilter.length>e.pageSize?a("el-pagination",{attrs:{background:"",layout:"slot, prev, pager, next","prev-text":e.lang.common.prevPage,"next-text":e.lang.common.nextPage,total:e.specFilter.length,"page-size":e.pageSize},on:{"current-change":e.switchSpecPage}},[e._t("default",[a("span",{staticClass:"pagination-slot"},[e._v("\n                        "+e._s(e.common.formatMsg(e.lang.common.paginationMsg,{current:this.specPage,total:this.specFilter.length}))+"\n                    ")])])],2):e._e()],1),e._v(" "),a("pana-create-spec",{attrs:{show:e.showCreateSpec},on:{closeModal:e.closeCreateSpec}}),e._v(" "),a("pana-delete-spec",{attrs:{show:e.showDeleteSpec},on:{closeModal:e.closeDeleteSpec}})],1)],1)},staticRenderFns:[]};var v=a("C7Lr")(f,b,!1,function(e){a("40nx")},"data-v-5b5f045a",null);t.default=v.exports}});